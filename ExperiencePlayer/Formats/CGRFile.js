var Uint16HalfFloatToFloat,byteArrayReader=function(t){this.buffer=t,this.h1t=0,this.tts=function(t){return this.buffer[t]},this.length=function(){return buffer.length},this.getCurrentPosition=function(){return this.h1t},this.setPosition=function(t){this.h1t=t},this.read=function(){return this.buffer[this.h1t++]},this.readDouble=function(t,i){return new DataView(buffer.buffer).getFloat64(t,!0)},this.sts=function(t){return t?(this.read()<<24|this.read()<<16|this.read()<<8|this.read())>>>0:(this.read()|this.read()<<8|this.read()<<16|this.read()<<24)>>>0},this.nts=function(t){return t?this.read()<<24|this.read()<<16|this.read()<<8|this.read():this.read()|this.read()<<8|this.read()<<16|this.read()<<24},this.clone=function(){return new byteArrayReader(this.buffer)},this.hts=function(t,i){return views=[],views.push({lvi:new DataView(this.buffer.buffer,t,i),buffer:this.buffer,offset:t}),views}};{var mantissatable=new Array(2048),exponenttable=new Array(64),offsettable=new Array(64);function convertMantissa(t){for(var i=t<<13,s=0;!(8388608&i);)s-=8388608,i<<=1;return(i&=-8388609)|(s+=947912704)}mantissatable[0]=0;for(var i=1;i<1024;i++)mantissatable[i]=convertMantissa(i);for(i=1024;i<2048;i++)mantissatable[i]=939524096+(i-1024<<13);exponenttable[0]=0;for(i=1;i<31;i++)exponenttable[i]=i<<23;exponenttable[31]=1199570944,exponenttable[32]=2147483648;for(i=33;i<63;i++)exponenttable[i]=i-32+2147483648<<23;exponenttable[63]=3347054592,offsettable[0]=0,offsettable[32]=0;for(i=1;i<64;i++)32!==i&&(offsettable[i]=1024);var uint32Array=new Uint32Array(1),float32Array=new Float32Array(uint32Array.buffer);Uint16HalfFloatToFloat=function(t){return uint32Array[0]=mantissatable[offsettable[t>>10]+(1023&t)]+exponenttable[t>>10],float32Array[0]}}var one_over_65535=1/65535,Uint16PositionsToFloats=function(t,i,s,r,n){for(var h=s.length/3,e=[Math.max(n.x-r.x,1e-6)*one_over_65535,Math.max(n.y-r.y,1e-6)*one_over_65535,Math.max(n.z-r.z,1e-6)*one_over_65535],a=[Math.floor(r.x/e[0]),Math.floor(r.y/e[1]),Math.floor(r.z/e[2])],f=t;f<h+t;f++){var o=s[3*f],u=s[3*f+1],c=s[3*f+2];i[3*f]=(a[0]+o)*e[0],i[3*f+1]=(a[1]+u)*e[1],i[3*f+2]=(a[2]+c)*e[2]}},setOctohedralToFloatArray=function(t,i,s,r){var n=2*i-1,h=2*s-1,e=1-Math.abs(n)-Math.abs(h);if(e<=0){var a=(1-Math.abs(h))*(n>=0?1:-1),f=(1-Math.abs(n))*(h>=0?1:-1);n=a,h=f}var o=Math.sqrt(n*n+h*h+e*e);t[3*r]=n/o,t[3*r+1]=h/o,t[3*r+2]=e/o},Oct24NormalsToFloats=function(t,i,s){for(var r=s.length/3,n=t;n<r+t;n++){var h=s[3*n],e=s[3*n+1],a=s[3*n+2],f=(16*h+Math.floor(e/16))/4095;setOctohedralToFloatArray(i,f,(e%16*256+a)/4095,n)}},Oct16NormalsToFloats=function(t,i,s){for(var r=s.length/2,n=t;n<r+t;n++){var h=s[2*n]/255,e=s[2*n+1]/255;setOctohedralToFloatArray(i,h,e,n)}};define("DS/Formats/CGRFile",["DS/Mesh/Mesh","DS/Mesh/ThreeJS_Base"],(function(t,s){"use strict";var r=!1,n=!1,h=!1,e=!1,a=!1,f=!1,o=!1,u=!1,c=!1,v=!1,l=!1,w=new Float32Array(100),b=new Int16Array(100),d=new Uint16Array(100),A=new Uint8Array(100),m=255,M=80,y=81,O=82,p=83,k=84,S=85,g=86,j=87,I=88,N=89,x=119,T=156,R=157,E=160,F=1,_=2,P=1,U=2,D=4,C=8,G=16,L=0,V=!1,B=0,z=0,H=(new Map([["segoeuiz.ttf",{fontName:"Segoe UI",italic:!0,bold:!0}],["segoeui.ttf",{fontName:"Segoe UI",italic:!1,bold:!1}],["segoeuib.ttf",{fontName:"Segoe UI ",italic:!1,bold:!0}],["segoeuii.ttf",{fontName:"Segoe UI ",italic:!0,bold:!1}],["seguisb.ttf",{fontName:"Segoe UI Semibold",italic:!1,bold:!1}],["DSISO1.otf",{fontName:"DS ISO 1",italic:!1,bold:!1}],["DSISO1I.otf",{fontName:"DS ISO 1",italic:!0,bold:!1}],["DSISO1BI.otf",{fontName:"DS ISO 1",italic:!0,bold:!0}],["DSISO1B.otf",{fontName:"DS ISO 1",italic:!1,bold:!0}],["DroidSerif-Bold.ttf",{fontName:"Droid Serif",italic:!1,bold:!0}],["DroidSerif.ttf",{fontName:"Droid Serif",italic:!1,bold:!1}],["DroidSerif-Italic.ttf",{fontName:"Droid Serif",italic:!0,bold:!1}],["3ds Bold Italic.ttf",{fontName:"3ds",italic:!0,bold:!0}],["3ds Bold.ttf",{fontName:"3ds",italic:!1,bold:!0}],["3ds Italic.ttf",{fontName:"3ds",italic:!0,bold:!1}],["3ds Regular.ttf",{fontName:"3ds",italic:!1,bold:!1}]]),0),Y=1,X=2,J=3,W=4,q=5,K=6,Z=7,Q=8,$={NEAREST:0,LINEAR:1,NEAREST_MIPMAP_NEAREST:2,NEAREST_MIPMAP_LINEAR:3,LINEAR_MIPMAP_NEAREST:4,LINEAR_MIPMAP_LINEAR:5},tt=1,it=2,st=3,rt={ets:4294967295,ats:4294967294,fts:0,ots:1,uts:2,cts:4,vts:8,lts:16,wts:32,bts:64,dts:128,Ats:256,mts:512,Mts:915,yts:933,Ots:969},nt=[1,1,2,3,4,5,6,7,8],ht=1,et=0,at=1,ft=3,ot=4,ut=5,ct=6,vt=7,lt=function(t,i){this.name=i,this.conversion=!1,this.version=0,this.kts=0,this.Sts=0,this.gts=0,this.jts=0,this.Nts=[];var r=!0;this.xts=!1;var n=[];this.Tts=!1,this.textures=new xn,this.materials=new xn,this.Rts=new xn,this.reps=[],this.reps[H]=new xn,this.reps[X]=new xn,this.reps[K]=new xn,this.reps[J]=new xn,this.reps[Z]=new xn,this.reps[W]=new xn,this.reps[q]=new xn,this.reps[Y]=new xn,this.reps[Q]=new xn,this.axisSystems=new xn,this.curvedPipes=new xn,this.canonicals=new xn,this.sgRep=[],this.nbRep=0,this.decorations=new multiTabDecorations,this.refPlanes=new xn,this.$xe=new xn,this.Ets=[],this.Fts=[],this._ts=!1,this.Pts=new xn,this.buffer=t,this.Uts=0,this.Dts=null,this.Cts=0,this.Gts=0,this.Lts=0;var h=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215,33554431,67108863,134217727,268435455,536870911,1073741823,2147483647],e=0,a=[0,0,2,2,3,3,3,3,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9];this.Vts=function(){return!1},this.Bts=function(t){return[t[0],t[1],0,t[2],t[3],0,t[4],t[5],1]},this.zts=function(t,i,s,r,n){var h=0|(r?1:0)<<1|(i?1:0);return n&&(h=8),this.xts&&(h=0),{renderType:h,indice:this.reps[h].add(t)}},this.Hts=function(t){this.reps=t},this.Yts=function(){return this.reps},this.Xts=function(){this.reps=[],this.reps[H]=new xn,this.reps[X]=new xn,this.reps[K]=new xn,this.reps[J]=new xn,this.reps[Z]=new xn,this.reps[Q]=new xn,this.reps[W]=new xn,this.reps[q]=new xn,this.reps[Y]=new xn},this.Xrn=function(t,i){return this.reps[i].get(t)},this.Jts=function(){return this.buffer.Jts()},this.UAt=function(t){for(var i=new String,s=0;s<t;s++){i+=String.fromCharCode(this.buffer.read())}return i},this.Wts=function(t){for(var i=new String,s=(t=this.qts(),0);s<t;s++){i+=String.fromCharCode(this.buffer.read())}return i},this.Kts=function(t){for(var i=new String,s=0;s<t-1;s++){var r=this.Zts();i+=String.fromCharCode(r)}return this.Zts(),i},this.Qts=function(t){return!(this.buffer.buffer&&t>this.buffer.buffer.length)&&(this.buffer.setPosition(t),!0)},this.getCurrentPosition=function(){return this.buffer.getCurrentPosition()},this.skip=function(t){this.buffer.setPosition(this.buffer.getCurrentPosition()+t)},this.$ts=function(){return this.tis()},this.iis=function(t){switch(t){case 97:return new mi;case 98:return new xr;case 99:return new wi;case 100:return new ii;case 101:return new oi;case 102:return new Fr;case 103:return new br;case 104:return new yi;case 112:return new Pr;case 113:return new si;case 114:return new ui;case 115:return new Ai;case 116:return new ci;case 120:return new fi;case 137:return new _r;case 145:case 146:return new br;case 147:return new Jr;case 148:return new br;case 149:return new ei;case 150:return new br;case 152:return new Wr;case 153:return new Mi;case 154:return new qr;case 158:return new vi;case 159:return new li;case 161:return new Oi;case 163:return new Xr;case 170:return new di;case 171:return new bi;case 172:return new pi;case 173:return new ki;case 174:return new gi;case 175:return new ji;case 176:return new Si;case 179:return new Zr;case 181:return new br;case 182:return new $r;case 183:return new Qr;case 184:return new Kr;case 185:return new Tr;case 186:return new Rr;case 188:return new br;case 189:return new Er;case 192:return new nn;case 193:return new hn;case 194:return new en;case 195:return new an;case 196:return new fn;case 197:return new on;case 198:return new un;case 199:return new cn;case 255:return new wr;default:return this.error="file is corrupted.  unknown className..."+t,null}},this.sis=function(){return new wt(this.ris(),this.ris())},this.nis=function(){var t=[],i=0;if(this.version>=210021610){var r=this.qts(),n=this.tis(),h=[];this.his(h,n);var e=0;for(i=0,e=0;i<16;i++)switch((r&3<<2*i)>>2*i){case 0:t[i]=h[e++];break;case 1:case-1:t[i]=0;break;case-2:case 2:t[i]=1;break;case 3:case-3:t[i]=-1}}else for(i=0;i<16;++i)t.push(this.readFloat());var a=new s.Matrix4;return a.set(t[0],t[4],t[8],t[12],t[1],t[5],t[9],t[13],t[2],t[6],t[10],t[14],t[3],t[7],t[11],t[15]),a},this.eis=function(){var t=[],i=0;for(i=0;i<16;++i)t.push(this.readFloat());var r=new s.Matrix4;return r.set(t[0],t[4],t[8],t[12],t[1],t[5],t[9],t[13],t[2],t[6],t[10],t[14],t[3],t[7],t[11],t[15]),r},this.readFloatArray=function(t,i,s){this.buffer.readFloatArray(t,i,s,this.conversion)},this.fis=function(t,i){this.buffer.fis(t,i,this.conversion)},this.ois=function(t,i,s){this.buffer.ois(t,i,s,!0)},this.uis=function(t,i){this.buffer.uis(t,i,this.conversion)},this.readDouble=function(){return this.buffer.readDouble(this.conversion)},this.his=function(t,i){for(var s=0;s<i;++s)t.push(this.readDouble())},this.cis=function(){return this.Uts},this.lis=function(t){if(this.Uts=t,this.Sts){if(t<500)return void(e=a[this.Uts]);e=0;var i=t;do{++e}while(i>>=1)}},this.wis=function(t){this.Dts=t},this.ase=function(){return this.Dts},this.bis=function(t){var i;if(t<=this.Gts)i=this.Cts&h[t],this.Cts>>=t,this.Gts-=t;else if(t<=32){i=0;var s=t;i|=this.Cts&h[this.Gts],s-=this.Gts,this.Cts=this.ris(),i|=(this.Cts&h[s])<<this.Gts,this.Cts>>=s,this.Gts=32-s}else{var r=0;s=t;do{for(;this.Gts&&s;)i|=(1&this.Cts)<<r++,bitContainer>>=1,this.Gts--,s--;s&&(this.Cts=this.ris(),this.Gts=32)}while(s)}return i},this.dis=function(){var t=0;return this.Gts?(t=1&this.Cts,this.Cts>>=1,this.Gts--,t):(this.Cts=this.ris(),t=1&this.Cts,this.Cts>>=1,this.Gts=31,t)},this.Ais=function(){return this.kts?this.dis():this.tis()},this.mis=function(t,i,s){var r=3*t;if(this.Ais())this.readFloatArray(r,3*i,s);else{var n=Math.ceil(i/4),h=this.buffer.Mis(n,A),e=this.qts();e>w.length&&(w=new Float32Array(e)),this.fis(e,w);for(var a=0,f=0,o=0,u=0,c=0,v=0,l=0,b=0;b<i;b++){0==f&&(l=3&h[a]),1==f&&(l=(12&h[a])>>2),2==f&&(l=(48&h[a])>>4),3==f&&(l=(192&h[a])>>6,f=-1,a++),f++;0==l?(s[r++]=w[o],s[r++]=w[o+1],s[r++]=w[o+2],u=w[o],c=w[o+1],v=w[o+2],o+=3):2==l?(s[r++]=u,s[r++]=c,s[r++]=w[o],v=w[o],o++):3==l?(s[r++]=u,s[r++]=w[o],s[r++]=w[o+1],c=w[o],v=w[o+1],o+=2):(s[r++]=u,s[r++]=c,s[r++]=v)}}},this.yis=function(t,i){var s=0;if(this.Ais())this.ois(0,3*t,i);else{var r=Math.ceil(t/2),n=this.buffer.Mis(r,A),h=this.qts();h>d.length&&(d=new Uint16Array(h)),this.uis(h,d);for(var e=0,a=0,f=0,o=0,u=0,c=0,v=0,l=0;l<t;l++){0==a&&(v=3&n[e]),1==a&&(v=(12&n[e])>>2),2==a&&(v=(48&n[e])>>4),3==a&&(v=(192&n[e])>>6,a=-1,e++),a++;0==v?(i[s++]=d[f],i[s++]=d[f+1],i[s++]=d[f+2],o=d[f],u=d[f+1],c=d[f+2],f+=3):2==v?(i[s++]=o,i[s++]=u,i[s++]=d[f],c=d[f],f++):3==v?(i[s++]=o,i[s++]=d[f],i[s++]=d[f+1],u=d[f],c=d[f+1],f+=2):(i[s++]=o,i[s++]=u,i[s++]=c)}}},this.Ois=function(t,i,s){if(this.Ais())for(var r=0;r<t;++r)i[s++]=this.readFloat();else{var n=Math.ceil(t/12),h=new Uint8Array(n);this.pis(n,h);var e=this.kis(),a=new Float32Array(e);for(r=0;r<e;++r)a[r]=this.readFloat();var f=0,o=0,u=0,c=0,v=0,l=0;for(r=0;r<t/3;r++){0==o&&(flagvalue=3&h[f]),1==o&&(flagvalue=(12&h[f])>>2),2==o&&(flagvalue=(48&h[f])>>4),3==o&&(flagvalue=(192&h[f])>>6,o=-1,f++),o++;var w=3*r;0==flagvalue?(i[3*s+w]=a[u],i[3*s+w+1]=a[u+1],i[3*s+w+2]=a[u+2],c=a[u],v=a[u+1],l=a[u+2],u+=3):2==flagvalue?(i[3*s+w]=c,i[3*s+w+1]=v,i[3*s+w+2]=a[u],l=a[u],u++):3==flagvalue?(i[3*s+w]=c,i[3*s+w+1]=a[u],i[3*s+w+2]=a[u+1],v=a[u],l=a[u+1],u+=2):(i[3*s+w]=c,i[3*s+w+1]=v,i[3*s+w+2]=l)}}},this.Sis=function(t,i,s){if(this.Ais())for(var r=0;r<3*t;++r)i[3*s+r]=this.readFloat();else{var n=Math.ceil(t/4),h=new Uint8Array(n);this.pis(n,h);var e=this.qts(),a=new Float32Array(e);for(r=0;r<e;++r)a[r]=this.readFloat();var f=0,o=0,u=0,c=0,v=0,l=0,w=0;for(r=0;r<t;r++){0==o&&(w=3&h[f]),1==o&&(w=(12&h[f])>>2),2==o&&(w=(48&h[f])>>4),3==o&&(w=(192&h[f])>>6,o=-1,f++),o++;var b=3*r;0==w?(i[3*s+b]=a[u],i[3*s+b+1]=a[u+1],i[3*s+b+2]=a[u+2],c=a[u],v=a[u+1],l=a[u+2],u+=3):2==w?(i[3*s+b]=c,i[3*s+b+1]=v,i[3*s+b+2]=a[u],l=a[u],u++):3==w?(i[3*s+b]=c,i[3*s+b+1]=a[u],i[3*s+b+2]=a[u+1],v=a[u],l=a[u+1],u+=2):(i[3*s+b]=c,i[3*s+b+1]=v,i[3*s+b+2]=l)}}},this.gis=function(t,i,s){if(0!=t){var r=1/32767;if(this.version>1101220){var n=this.qts();n>b.length&&(b=new Int16Array(n)),this.buffer.jis(n,b,this.conversion),(d=Math.ceil(t/2))>A.length&&(A=new Uint8Array(d));for(var h=this.buffer.Mis(d,A),e=-1,a=0,f=0,o=0,u=3*t,c=3*s,v=0;v<u;v++){switch(v%2?(240&h[e])>>4:15&h[++e]){case 0:f=i[c+1]=b[a++]*r,o=i[c+2]=b[a++]*r,i[c]=Math.sqrt(1-(f*f+o*o));break;case 1:f=i[c+1]=b[a++]*r,o=i[c+2]=b[a++]*r,i[c]=-Math.sqrt(1-(f*f+o*o));break;case 2:f=i[c]=b[a++]*r,o=i[c+2]=b[a++]*r,i[c+1]=Math.sqrt(1-(f*f+o*o));break;case 3:f=i[c]=b[a++]*r,o=i[c+2]=b[a++]*r,i[c+1]=-Math.sqrt(1-(f*f+o*o));break;case 4:f=i[c]=b[a++]*r,o=i[c+1]=b[a++]*r,i[c+2]=Math.sqrt(1-(f*f+o*o));break;case 5:f=i[c]=b[a++]*r,o=i[c+1]=b[a++]*r,i[c+2]=-Math.sqrt(1-(f*f+o*o));break;case 6:i[c]=1,i[c+1]=0,i[c+2]=0;break;case 7:i[c]=-1,i[c+1]=0,i[c+2]=0;break;case 8:i[c]=0,i[c+1]=1,i[c+2]=0;break;case 9:i[c]=0,i[c+1]=-1,i[c+2]=0;break;case 10:i[c]=0,i[c+1]=0,i[c+2]=1;break;case 11:i[c]=0,i[c+1]=0,i[c+2]=-1}c+=3}}else{var l=[],w=(r=1/32767,t/3);this.Iis(2*w,l);var d=Math.ceil(w/8);h=new Uint8Array(d);h=this.buffer.Mis(d,A);var m,M,y=0,O=(e=-1,0);for(a=0,v=0;O<t;O+=3,a+=2,v++){var p;if(i[O]=l[a]*r,i[O+1]=l[a+1]*r,0==(y=v%8)&&e++,(M=1-(i[O]*i[O]+i[O+1]*i[O+1]))<=0)m=0;else for(f=M<=.03?.05:.25+M*(.25+1/(1+M));;){if((p=f-(m=.5*(f+M/f)))<r&&p>-r){f=m;break}f=m}i[O+2]=h[e]&1<<y?-m:m}}}},this.Nis=function(t,i,s){var r=3*t;if(0!=i){if(this.version>1101220){var n=this.qts();n>b.length&&(b=new Int16Array(n)),this.buffer.jis(n,b,this.conversion);var h=Math.ceil(i/2);h>A.length&&(A=new Uint8Array(h));for(var e=this.buffer.Mis(h,A),a=-1,f=0,o=0,u=0,c=3*i,v=0;v<c/3;v++){switch(v%2?(240&e[a])>>4:15&e[++a]){case 0:o=b[f++]*(1/32767),u=b[f++]*(1/32767),s[r++]=Math.sqrt(1-(o*o+u*u)),s[r++]=o,s[r++]=u;break;case 1:o=b[f++]*(1/32767),u=b[f++]*(1/32767),s[r++]=-Math.sqrt(1-(o*o+u*u)),s[r++]=o,s[r++]=u;break;case 2:o=b[f++]*(1/32767),u=b[f++]*(1/32767),s[r++]=o,s[r++]=Math.sqrt(1-(o*o+u*u)),s[r++]=u;break;case 3:o=b[f++]*(1/32767),u=b[f++]*(1/32767),s[r++]=o,s[r++]=-Math.sqrt(1-(o*o+u*u)),s[r++]=u;break;case 4:o=b[f++]*(1/32767),u=b[f++]*(1/32767),s[r++]=o,s[r++]=u,s[r++]=Math.sqrt(1-(o*o+u*u));break;case 5:o=b[f++]*(1/32767),u=b[f++]*(1/32767),s[r++]=o,s[r++]=u,s[r++]=-Math.sqrt(1-(o*o+u*u));break;case 6:s[r++]=1,s[r++]=0,s[r++]=0;break;case 7:s[r++]=-1,s[r++]=0,s[r++]=0;break;case 8:s[r++]=0,s[r++]=1,s[r++]=0;break;case 9:s[r++]=0,s[r++]=-1,s[r++]=0;break;case 10:s[r++]=0,s[r++]=0,s[r++]=1;break;case 11:s[r++]=0,s[r++]=0,s[r++]=-1}3}}}},this.xis=function(t,i){if(0!=t&&this.version>1101220){var s=this.Tis();this.pis(s,i)}},this.Ris=function(t,i,s,r){var n=s*i;if(3!=s){var h=0,e=0,a=new Float32Array(n);if(this.readFloatArray(0,n,a),1==s)for(h=0;h<n;h++)r[3*t+e++]=a[h],r[3*t+e++]=0,r[3*t+e++]=0;else if(2==s)for(h=0;h<n;h+=2)r[3*t+e++]=a[h],r[3*t+e++]=a[h+1],r[3*t+e++]=0}else this.readFloatArray(3*t,n,r)},this.Eis=function(t,i,s){if(this.Sts)for(var r=0;r<t;++r)i[r+s]=this.bis(e);else if(this.version>=1100600&&this.Uts<256)this.buffer.pis(s,t,i);else if(this.Uts<65536)this.buffer.ois(s,t,i,!1);else if(this.Uts<16777216)this.buffer.Fis(s,t,i);else for(r=0;r<t;++r)i[r+s]=this.qts()},this._is=function(){return this.Sts?this.bis(e):this.version>=1100600&&this.Uts<256?this.tis():this.Uts<65536?this.tis()<<8&65280|255&this.tis():this.Uts<16777216?this.tis()<<16&16711680|this.tis()<<8&65280|255&this.tis():this.qts()},this.Pis=function(){return this._ts},this.Uis=function(t){this._ts=t},this.Dis=function(){if(this.Fts.length){var t=this.Fts[this.Fts.length-1];if(t)return t}return null},this.Cis=function(t){this.Fts.push(t)},this.Gis=function(){this.Fts.pop()},this.X9e=function(){if(this.Nts.length)return this.Nts[this.Nts.length-1].inherited},this.Lis=function(t,i){var s,r=0;if(this.Nts.length){var n=this.Nts[this.Nts.length-1];if(r=n.Vis,s=n.inherited,4&r){t.setColor(s.getColor());var h=s.Bis();t.zis(h[0],h[1],h[2])}if(4096&r){h=s.Bis();t.His(h[3])}16&r&&t.Yis(s.Xis()),64&r&&t.Jis(s.Wis());var e=s.isHidden();e&&t.qis(e)}return this.Nts.push({Vis:r|i,inherited:t}),t},this.Kis=function(){return this.Nts.pop()},this.Zis=function(){if(n.length>0){var t=n.pop();return t.inherit&&(this.Tts=!1),t}return{file:"",id:-1}},this.Qis=function(t,i,s,r){var h=rt.ets,e=null;n.length>0&&(h=(f=n[n.length-1]).layer,e=f.rep);if(s!==h)if(s<h&&0!==i){var a=!0;1==this.Tts&&(a=!1),this.Tts=!0,n.push({file:t.file,id:t.id,inherit:a,layer:s,rep:r})}else{if(n.length>0)(f=n[n.length-1])&&n.push({file:f.file,id:f.id,inherit:!1,layer:f.layer,rep:f.rep})}else if(s==rt.ats||e===r)if(2==i||1==i&&!this.Tts){a=!0;1==this.Tts&&(a=!1),this.Tts=!0,n.push({file:t.file,id:t.id,inherit:a,layer:s,rep:r})}else if(this.Tts||0!=i){if(n.length>0)(f=n[n.length-1])&&n.push({file:f.file,id:f.id,inherit:!1,layer:f.layer,rep:f.rep})}else n.push({file:"",id:-1,inherit:!1,layer:s,rep:r});else if(0!==i){a=!0;1==this.Tts&&(a=!1),this.Tts=!0,n.push({file:t.file,id:t.id,inherit:a,layer:s,rep:r})}else{var f;if(n.length>0)(f=n[n.length-1])&&n.push({file:f.file,id:f.id,inherit:!1,layer:f.layer,rep:f.rep})}},this.check=function(){n.length,this.Nts.length,this.Ets.length},this.$is=function(t){var i,r=this.Ets[this.Ets.length-1];return null==r?i=t:(i=new s.Matrix4).multiplyMatrices(r,t),this.Ets.push(i),i},this.tss=function(){return this.Ets.pop()},this.iss=function(){return r},this.sss=function(t){r=t},this.rss=function(t){t.sss(this.iss()),t.conversion=this.conversion,t.version=this.version,t.Nts=this.Nts,t.textures=this.textures,t.materials=this.materials,t.decorations=this.decorations,t.sgRep=this.sgRep,t.nbRep=this.nbRep},this.nss=function(){return 0!=this.Ets.length?this.Ets[this.Ets.length-1]:null},this.hss=function(){var t=n[n.length-1];return t?{file:t.file,id:t.id}:null}};lt.prototype.readFloat=function(){return this.buffer.readFloat(this.conversion)},lt.prototype.tis=function(){return this.buffer.read()},lt.prototype.pis=function(t,i){for(var s=0;s<t;s++)i[s]=this.buffer.read()},lt.prototype.Iis=function(t,i){this.buffer.Iis(0,t,i,this.conversion)},lt.prototype.Zts=function(){return this.conversion?this.buffer.read()<<8|this.buffer.read():this.buffer.read()|this.buffer.read()<<8},lt.prototype.ess=function(){var t=this.buffer.read(),i=this.buffer.read();if(this.conversion){var s=(127&t)<<8|i;return s-=(128&t)<<8}s=(127&i)<<8|t;return s-=(128&i)<<8},lt.prototype.Tis=function(){return this.buffer.Tis(this.conversion)},lt.prototype.ass=function(){return this.buffer.ris(this.conversion)},lt.prototype.ris=function(){return this.buffer.nts(this.conversion)},lt.prototype.fss=function(t,i){for(var s=0;s<t;s++)i[s]=this.ris()},lt.prototype.kis=function(){if(this.gts)return this.qts();if(this.version>=1101410){var t=this.tis();return 255==t?this.buffer.nts(this.conversion):t}return this.buffer.nts(this.conversion)},lt.prototype.qts=function(){if(this.version>=1100600){var t=this.buffer.read();return t<255?t:this.buffer.nts(this.conversion)}return this.buffer.nts(this.conversion)};var wt=function(t,i){this.set=268435384&t,this.rgba=i||0};wt.prototype={constructor:wt,setConnectivity:function(i){var s;switch(i){case t.ConnectivityTypeEnum.POINTS:this.set=4278194171&this.set,s=0;break;case t.ConnectivityTypeEnum.LINES:case t.ConnectivityTypeEnum.LINE_STRIP:case t.ConnectivityTypeEnum.LINE_LOOP:this.set=268435451&this.set,s=1;break;case t.ConnectivityTypeEnum.TRIANGLES:case t.ConnectivityTypeEnum.TRIANGLE_STRIP:case t.ConnectivityTypeEnum.TRIANGLE_FAN:case t.ConnectivityTypeEnum.TRIANGLE_FAN:s=2,this.set=251662335&this.set;break;default:s=2}this.set&=-4,this.set|=3&s},isEqual:function(t){return this.set==t.set&&this.rgba==t.rgba},oss:function(){var t=this.V_i();this.set=0,this.rgba=0,this.setConnectivity(2),this.rSi(t),this.setBasic(),this.set&=-4194305,this.set|=1<<22},setColor:function(t){this.set&=~(15<<24),this.set|=(15&t)<<24},setSymbol:function(t){this.set&=268435455,this.set|=(15&t)<<28},zis:function(t,i,s){this.rgba&=255,this.rgba|=(16777215&(t<<16|i<<8|s))<<8},His:function(t){this.rgba&=-256,this.rgba|=255&t},Jis:function(t){this.set&=-3932161,this.set|=(15&t)<<18},rSi:function(t){this.set&=-3841,this.set|=(15&t)<<8},setBasic:function(){this.set&=-5,this.set|=4},uss:function(){this.set&=-8388609,this.set|=1<<23},FJe:function(t){this.set&=-49,this.set|=(3&t)<<4},qis:function(t){this.set&=-9,this.set|=(1&t)<<3},Yis:function(t){this.set&=-258049,this.set|=(63&t)<<12},getColor:function(){return this.set>>24&15},vss:function(){return this.set>>28&15},Bis:function(){var t=[];return t[0]=this.rgba>>24&255,t[1]=this.rgba>>16&255,t[2]=this.rgba>>8&255,t[3]=255&this.rgba,t},getDisplayedColor:function(){if(15==this.getColor())return this.Bis();var t=[];switch(this.getColor()){case 14:case 13:t[0]=0,t[1]=0,t[2]=0,t[3]=255;break;case 12:t[0]=62,t[1]=102,t[2]=85,t[3]=255;break;case 11:case 10:t[0]=255,t[1]=128,t[2]=0,t[3]=255;break;case 9:t[0]=0,t[1]=0,t[2]=0,t[3]=255;break;case 8:t[0]=255,t[1]=255,t[2]=255,t[3]=255;break;case 7:t[0]=255,t[1]=0,t[2]=0,t[3]=255;break;case 6:t[0]=0,t[1]=255,t[2]=0,t[3]=255;break;case 5:t[0]=0,t[1]=0,t[2]=255,t[3]=255;break;case 4:t[0]=255,t[1]=255,t[2]=0,t[3]=255;break;case 3:t[0]=255,t[1]=0,t[2]=255,t[3]=255;break;case 2:t[0]=0,t[1]=255,t[2]=255,t[3]=255;break;case 1:t[0]=0,t[1]=255,t[2]=0,t[3]=255;break;case 0:t[0]=255,t[1]=0,t[2]=0,t[3]=255;break;default:t[0]=0,t[1]=0,t[2]=0,t[3]=255}return t},Wis:function(){return this.set>>18&15},Xis:function(){var t=this.set>>12&63;return t=t>nt.length?1:nt[t]},getType:function(){return this.set>>4&3},V_i:function(){return this.set>>8&15},vss:function(){return this.set>>28&15},lss:function(){return 0==this.getType()},bss:function(){return 3==this.getType()?1:0},isHidden:function(){return this.set>>3&1},isTransparent:function(){return this.set>>7&1},clone:function(){return new wt(this.set,this.rgba)}};var bt=function(t){t.ris(!1),t.ris(!1);t.ris(!1);t.ris(!1);if((4294967295&t.ris(!1))<<32,dn){t.ris(!1);(4294967295&t.ris(!1))<<32;t.ris(!1);(4294967295&t.ris(!1))<<32;t.ris(!1),t.ris(!1),t.ris(!1),t.ris(!1),t.ris(!1);var i=new Uint8Array(8);t.pis(8,i),t.ris(!1),t.ris(!1)}},dt=function(t){this.offset=t.ris(!1),this.length=t.ris(!1);t.ris(!1);this.dss=t.ris(!1);t.ris(!1)},At=function(t,i){t.ris(!1);this.id=t.ris(!1);t.Zts(!1),new bt(t);var s=t.ris(!1);this.Ass=[];var r=[];if(s>0)for(var n=0;n<s;++n)this.Ass.push(new dt(t));if(i>0){t.ris(!1),t.ris(!1);for(n=0;n<i;++n)r.push(new vn(t))}this.mss=function(){for(var t=0;t<r.length;++t){r[t].Mss;if(0==r[t].Mss)return r[t]}},this.yss=function(t,i){for(var s=0;s<r.length;++s)if(r[s].Mss==t&&r[s].name==i)return r[s]},this.Oss=function(t,i){return this.yss(t.getId(),i)}},mt=0,Mt=1,yt=-1159921408,Ot=-86375937,pt=122298,kt=-16655622,St=-86376192,gt=121594,jt=-86376177,It=251779834,Nt=6,xt=7,Tt=8,Rt=9,Et=1,Ft=2,_t=3,Pt=4,Ut=function(t,i,s){this.pss=t,this.kss=i,this.Sss=s,this.gss=function(t,i){var s,r,n,h,e=1,a=1;t.conversion;h=t.qts();var f=tt;if(h==yt||h==pt||h==Ot||h==kt?s=t.qts():h==St||h==gt||h==jt||h==It||(s=h),h!=St&&h!=gt&&h!=jt&&h!=It){r=t.qts(),S=t.qts(),n=t.qts();t.qts();if(e=t.readFloat(),a=t.readFloat(),0==n)return null;j=new Uint8Array(S),t.pis(S,j)}else{switch(t.qts()){case Et:return s=t.qts(),r=t.qts(),S=t.qts(),n=t.qts(),t.qts(),e=t.readFloat(),a=t.readFloat(),-1;case Ft:if(s=t.qts(),r=t.qts(),S=t.qts(),n=t.qts(),t.qts(),e=t.readFloat(),a=t.readFloat(),4!=n)return null;n=0,j=new Uint8Array(s*r);for(var o=[0,1,2,3,new Map([[7,2],[8,3],[11,4],[12,5],[14,6],[15,7]]),new Map([[19,8],[20,9],[7,10],[8,11],[27,64],[18,128]]),new Map([[24,1664],[23,192],[8,12],[3,13],[52,14],[53,15],[42,16],[43,17],[7,1]]),new Map([[39,18],[12,19],[8,20],[23,21],[3,22],[4,23],[40,24],[43,25],[19,26],[36,27],[24,28],[55,256]]),new Map([[53,0],[2,29],[3,30],[26,31],[27,32],[18,33],[19,34],[20,35],[21,36],[22,37],[23,38],[40,39],[41,40],[42,41],[43,42],[44,43],[45,44],[4,45],[5,46],[10,47],[11,48],[82,49],[83,50],[84,51],[85,52],[36,53],[37,54],[88,55],[89,56],[90,57],[91,58],[74,59],[75,60],[50,61],[51,62],[52,63],[54,320],[55,384],[100,448],[101,512],[104,576],[103,640]]),new Map([[204,704],[205,768],[210,832],[211,896],[212,960],[213,1024],[214,1088],[215,1152],[216,1216],[217,1280],[218,1344],[219,1408],[152,1472],[153,1536],[154,1600],[155,1728]]),new Map([[15,64],[55,0],[23,16],[24,17],[8,18]]),new Map([[8,1792],[12,1856],[13,1920]]),new Map([[18,1984],[19,2048],[20,2112],[21,2176],[22,2240],[23,2304],[28,2368],[29,2432],[30,2496],[31,2560]])],u=[0,1,new Map([[3,2],[2,3]]),new Map([[3,4],[2,1]]),new Map([[3,5],[2,6]]),new Map([[3,7]]),new Map([[5,8],[4,9]]),new Map([[4,10],[5,11],[7,12]]),new Map([[4,13],[7,14]]),new Map([[24,15]]),new Map([[15,64],[23,16],[24,17],[8,18],[55,0]]),new Map([[8,1792],[12,1856],[13,1920],[103,19],[104,20],[108,21],[55,22],[40,23],[23,24],[24,25]]),new Map([[18,1984],[19,2048],[20,2112],[21,2176],[22,2240],[23,2304],[28,2368],[29,2432],[30,2496],[31,2560],[202,26],[203,27],[204,28],[205,29],[104,30],[105,31],[106,32],[107,33],[210,34],[211,35],[212,36],[213,37],[214,38],[215,39],[108,40],[109,41],[218,42],[219,43],[84,44],[85,45],[86,46],[87,47],[100,48],[101,49],[82,50],[83,51],[36,52],[55,53],[56,54],[39,55],[40,56],[88,57],[89,58],[43,59],[44,60],[90,61],[102,62],[103,63],[200,128],[201,192],[91,256],[51,320],[52,384],[53,448]]),new Map([[108,512],[109,576],[74,640],[75,704],[76,768],[77,832],[114,896],[115,960],[116,1024],[117,1088],[118,1152],[119,1216],[82,1280],[83,1344],[84,1408],[85,1472],[90,1536],[91,1600],[100,1664],[101,1728]])],c=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191],v=[4096,6144,7168,7680,7936,8064,8128,8160,8176,8184,8188,8190,8191],l=function(t,i,s){var r,n=0,h=0,e=Math.floor(s/8),a=s%8;if(i.length<e)return null;r=i[e],i.length>e+1&&(n=i[e+1]),i.length>e+2&&(h=i[e+2]);var f=t?o:u,l=t?4:2,w=0,b=0;if(a>3){b=((r&c[8-a])<<5+a)+(d=n<<a-3)+(h>>11-a)}else{var d=n;a<3&&(d=n>>3-a),b=((r&c[8-a])<<5+a)+d}for(;l<14;){var A=(b&v[l-1])>>13-l;if(null!=(w=f[l].get(A)))break;l++}return l<14?{jss:w,Iss:l}:null},w=0;w<r;w++){var b=!0,d=t.qts();if(!(d>0))return null;var A=new Uint8Array(d);t.pis(d,A);for(var m=0,M=0,y=0;m<s;){var O=l(b,A,M);if(!O)return null;if(y+=O.jss,M+=O.Iss,!(O.jss>63)){for(var p=b?255:0,k=0;k<y;k++)j[w*s+m+k]=p;b=!b,m+=y,y=0}}}break;case _t:var S;if(s=t.qts(),r=t.qts(),S=t.qts(),n=t.qts(),t.qts(),e=t.readFloat(),a=t.readFloat(),!(h!=jt&&h!=It||n!=Nt&&n!=xt&&n!=Tt&&n!=Rt))t.qts();j=new Uint8Array(S),t.pis(S,j);break;case Pt:f=st,s=t.qts(),r=t.qts();var g=t.qts();n=t.qts(),t.qts(),e=t.readFloat(),a=t.readFloat();var j=new Uint8Array(g);if(!g)return null;t.pis(g,j)}}return{img:j,width:s,height:r,format:n,url:i,Nss:e,Tss:a,imgType:f}}},Dt=function(t,i,s){Ut.call(this,t,i,s)};(Dt.prototype=Object.create(Ut.prototype)).constructor=Ut;var Ct=function(){this.createTexture=function(t,i){var s={rqt:[],width:0,height:0,format:null,mipmapCount:1,url:i,imgType:it};if(0==t.qts()){t.qts();if(s.mipmapCount=t.kis(),s.width=t.kis(),s.height=t.kis(),s.format=t.qts(),0==s.mipmapCount)return!1;for(var r=s.width,n=s.height,h=1;h<=s.mipmapCount;h++){var e=(new Ut).gss(t,i);if(3==s.format)return e;s.rqt.push({data:e.img,width:e.width,height:e.height}),(n/=2)<1&&(n=1),(r/=2)<1&&(r=1)}}return s}},Gt=function(){this.gss=function(t,i){var s=(new Ut).gss(t,i);if(null===s)return null;var r=t.Wts().split("\\");i=r[r.length-1];return s.url=i,s}},Lt=function(){this.gss=function(t,i){var s={rqt:[],width:0,height:0,format:null,mipmapCount:1,url:i,imgType:it};if(0==t.qts()){var r=t.qts();s.mipmapCount=t.kis(),s.width=t.kis(),s.height=t.kis(),s.format=t.qts(),s.Rss=r,0==s.mipmapCount&&0;for(var n=s.width,h=s.height,e=1;e<=s.mipmapCount;e++){var a=(new Ut).gss(t,i);if(3==s.format)return a;s.rqt.push({data:a.img,width:a.width,height:a.height}),(h/=2)<1&&(h=1),(n/=2)<1&&(n=1)}}else 0;return s}},Vt=function(){this.gss=function(i){var s=new t.Material,r=(i.qts(),i.readFloat()),n=i.readFloat(),h=i.readFloat();s.colorAmbient[0]=r,s.colorAmbient[1]=n,s.colorAmbient[2]=h;var e=i.readFloat(),a=i.readFloat(),f=i.readFloat();s.colorDiffuse[0]=e,s.colorDiffuse[1]=a,s.colorDiffuse[2]=f;var o=i.readFloat(),u=i.readFloat(),c=i.readFloat();if(s.colorSpecular[0]=o,s.colorSpecular[1]=u,s.colorSpecular[2]=c,s.shininess=i.readFloat(),s.shininess*=255,s.ambientCoef=i.readFloat(),s.diffuseCoef=i.readFloat(),s.specularCoef=i.readFloat(),s.transparent=i.readFloat(),s.reflectivityCoef=i.readFloat(),i.version>=210042310)i.Ais();var v=i.version<2100190&&i.version>=21e5||i.version<1102110;if(i.tis())if(v){if(i.tis()){var l;if(l=i.qts(),i.textures.Ess(l)){var w=i.textures.getIndex(l);s.textureId=w}else{var b=(new Gt).gss(i),d=i.textures.add(b);i.textures.Fss(l,d),s.textureId=d}}else{b=(new Gt).gss(i),d=i.textures.add(b);s.textureId=d}}else{var A,m=i.ase();if(m&&(A=m._ss()),A){d=A.Pss(i);s.textureId=d}}switch(s.textureImageNumberComposante=i.qts(),s.DAi=i.qts(),s.magFilter=i.qts(),s.minFilter=i.qts(),i.qts()){case 0:s.mappingFunction="USER_MAPPING";break;case 3:s.mappingFunction="SPHERICAL_ENV_MAP"}if((s.textureWrapS=i.qts(),s.textureWrapT=i.qts(),s.addedComposantInTexEnv=i.qts(),i.skip(76),!v)&&i.tis()){s.textureId=-1;var M=7==i.qts(),y=new Yt;y.gss(i),y&&(s.shaderMaterial={name:y.name,param:y.parameters,PDSFX:M})}return s}},Bt=function(){this.skip=function(t){this.gss(t,!0)},this.Uss=function(t){var i=1,s=0,r=0;if(t.version>=210041930&&(r=t.qts(),t.textures.Ess(r)&&(s=t.textures.getIndex(r),i=0)),i){var n=(new Ut).gss(t);null!=n&&(s=t.textures.add(n)),n&&t.version>=210041930&&t.textures.Fss(r,s)}return s},this.gss=function(t,i){var s=-1,r={};i||(r=(new Vt).gss(t));var n=t.Wts();r.physicalMaterial=JSON.parse(n);var h=t.kis(),e=t.kis(),a=r.physicalMaterial.Version,f=0;if(r.physicalMaterial&&r.physicalMaterial.PhysicalMaterial&&r.physicalMaterial.PhysicalMaterial.MappingOperator&&r.physicalMaterial.PhysicalMaterial.MappingOperator.UvTransformation){var o=r.physicalMaterial.PhysicalMaterial.MappingOperator.UvTransformation;r.physicalMaterial.PhysicalMaterial.MappingOperator.UvTransformation=[o[0],o[1],o[2],o[4],o[5],o[6],o[8],o[9],o[10]]}a&&a>=3&&(f=t.kis());var u=t.Ais(),c=!1;a&&a>=.2&&(c=t.Ais());for(var v=0;v<h;v++){var l=!1;s=-1;var w=t.Wts();if(a>0&&(l=t.Ais()),(s=l?this.Uss(t):Ht(t))>=0)r.physicalMaterial.PhysicalMaterial.FloatParameter[w].Texture=s}for(v=h;v<e+h;v++){l=!1;s=-1;w=t.Wts();if(a>0&&(l=t.Ais()),(s=l?this.Uss(t):Ht(t))>=0)r.physicalMaterial.PhysicalMaterial.Float3Parameter[w].Texture=s}s=-1;var b=null;for(r.physicalMaterial.PhysicalMaterial&&r.physicalMaterial.PhysicalMaterial.MapParameter&&(b=r.physicalMaterial.PhysicalMaterial.MapParameter.normalMap),u&&(s=Ht(t))>=0&&(b?b.Texture=s:r.physicalMaterial.PhysicalMaterial.NormalMap.Texture=s),c&&Ht(t),v=0;v<f;v++){l=!1;s=-1;w=t.Wts();var d=r.physicalMaterial.PhysicalMaterial.MapParameter[w];a>0&&(l=t.Ais()),(s=l?this.Uss(t):Ht(t))>=0&&d&&(d.Texture=s)}return r}},zt=function(){this.gss=function(t){var i,s={};if(i=t.qts(),t.materials.Dss(i,t.name))p=t.materials.Gss(i,t.name),s=t.materials[p];else{var r=t.Wts(),n=JSON.parse(r);if(n.images&&n.textures){var h,e=t.ase();e&&(h=e._ss());var a=[];if(h)for(var f=0;f<n.images.length;f++){var o=h.VJe(t,n.images[f].byteOffset,n.images[f].byteOffset+n.images[f].byteLength);a.push(o)}var u=[];if(n.images&&n.images.length)for(f=0;f<n.images.length;f++)u.push(!1);var c=[];for(f=0;f<n.textures.length;f++){var v=!1,l=n.textures[f];u[l.image]&&(v=!0),u[l.image]=!0;var w={Lss:v,rqt:(o=a[l.image]).rqt,format:o.format,height:o.height,width:o.width,img:o.img,imgType:o.imgType,wrap:[1,1],filter:[1,1]};if(l.uWrap&&"REPEAT"!=l.uWrap&&(w.wrap[0]=0),l.vWrap&&"REPEAT"!=l.vWrap&&(w.wrap[1]=0),l.magFilter&&(w.filter[1]=$[l.magFilter]),l.minFilter&&(w.filter[0]=$[l.minFilter]),l.uvTransform){var b=l.uvTransform;1==b[0]&&0==b[1]&&0==b[2]&&1==b[3]&&0==b[4]&&0==b[5]||(w.uvTransform=l.uvTransform)}var d=t.textures.add(w);c.push(d)}}var A=n.materials[0],m=s;if("Visu.Basic"==A.type){if(s.colorDiffuse=A.DiffuseColor,s.diffuseCoef=A.DiffuseCoeff,s.colorAmbient=A.AmbientColor,s.ambientCoef=A.AmbientCoeff,s.colorSpecular=A.SpecularColor,s.specularCoef=A.SpecularCoeff,s.reflectivityCoef=A.ReflectionCoeff,s.textureId=A.Texture?c[A.Texture.texture]:void 0,null!=s.textureId){var M=t.textures.get(s.textureId);s.minFilter=M.filter[0],s.magFilter=M.filter[1],s.textureWrapS=M.wrap[0],s.textureWrapT=M.wrap[1]}s.shininess=255*A.ShininessCoeff,s.transparency=A.TransparencyCoeff,s.alphaTest=.5*A.IsAlphaTestEnabled}else if("Visu.SpecularGlossiness"==A.type||"Visu.SpecularGlossiness@17x"==A.type||"Visu.SpecularGlossiness@21x"==A.type||"Visu.EVisuPBR"==A.type||"Visu.DSPBR@21x"==A.type||"Visu.DSPBR@22x"==A.type){for(var y in A){var O=A[y];void 0!==O.texture&&(O.texture=c[O.texture])}s.physicalMaterial={},(s=s.physicalMaterial).PhysicalMaterial=A,s.PhysicalMaterial.isVisDescription=!0}var p=t.materials.add(m);t.materials.Vss(i,p,t.name)}return m}},Ht=function(t){var i,s=-1,r=t.ase();r&&(i=r._ss());return i&&(s=i.Pss(t)),s},Yt=function(){this.parameters={},this.name="",this.gss=function(t){this.Bss(t);var i,s=t.ase();if(s&&(i=s._ss()),i)var r=i.zss(t);if(null===r)return null;r&&(this.name=r.name)},this.Bss=function(t){for(var i=t.qts(),s=[],r=0;r<i;++r)s[r]=t.Wts();var n=t.qts();for(r=0;r<n;++r){switch(t.qts()){case 0:t.qts();break;case 1:t.qts();var h=t.readFloat(),e=s[r];this.parameters[e]=h;break;case 2:t.qts();var a=[];t.readFloatArray(0,4,a);e=s[r];this.parameters[e]=a;break;case 4:t.qts();var f,o=t.ase();o&&(f=o._ss());var u="";if(f){var c=f.Pss(t);wn[c]&&wn[c].url&&(u=wn[c].url)}e=s[r];this.parameters[e]={imgId:c,url:u};break;case 5:t.qts(),a=[];t.readFloatArray(0,4,a);e=s[r];this.parameters[e]=a;break;case 6:t.qts(),a=[];t.readFloatArray(0,4,a);e=s[r];this.parameters[e]=a}}}},Xt=function(){this.name="",this.gss=function(t){var i=t.Wts(),s=i.lastIndexOf("\\");-1!==s&&(i=i.substring(s+1,i.length)),-1!==(s=i.lastIndexOf("."))&&(i=i.substring(0,s));var r=t.qts();t.skip(r),this.name=i}},Jt=function(){this.gss=function(t){for(var i=[],s=0;s<2;s++){if(t.tis()){var r=0;if(t.tis())if(r=t.qts(),t.materials.Dss(r,t.name))i[s]=t.materials.Gss(r,t.name);else{var n=(1===(e=t.qts())?new Jt:new Vt).gss(t);if(1===e)h=n;else var h=t.materials.add(n);t.materials.Vss(r,h,t.name),i[s]=h}else{var e;n=(1===(e=t.qts())?new Jt:new Vt).gss(t);h=1===e?n:t.materials.add(n),i[s]=h}}}return i[0]}},Wt=function(){this.posBuffer=[],this.Hss=[],this.Yss=[],this.Xss=[],this.Jss=[],this.Wss=[],this.Uts=0};Wt.prototype.cis=function(){return this.Uts},Wt.prototype.gss=function(t){var i;this.Uts=t.qts(),i=t.qts(),this.qss=t.tis(),this.Kss=t.tis(),this.Zss=t.tis();var s=0;if(this.qss&&(s=t.tis(),t.Ris(0,this.Uts,s,this.Yss)),this.Uts&&t.mis(0,this.Uts,this.posBuffer,0),i&&t.Nis(0,i,this.Hss,0),this.Kss&&this.Uts)if(u)t.Ris(0,this.Uts,2,this.Yss);else{var r=new Float32Array(2*this.Uts);t.readFloatArray(0,2*this.Uts,r)}if((this.Zss&&(t.readFloatArray(0,3*this.Uts,this.Wss),t.readFloatArray(0,3*this.Uts,this.Jss)),t.version>=210041920)&&t.tis()){var n=t.qts();if(n>0)for(var h=0;h<n;++h){var e=t.tis();t.Wts();t.skip(4*e*this.Uts)}}},Wt.prototype.Qss=function(){this.posBuffer=new Array(3*this.Uts),this.$ss&&(this.Hss=new Array(3*this.$ss)),this.qss&&(this.Yss=new Array(3*this.Uts)),this.Kss&&(this.Xss=new Array(2*this.Uts)),this.Zss&&(this.Wss=new Array(3*this.Uts),this.Jss=new Array(3*this.Uts))};var qt=function(){Wt.call(this),this.$ss=0,this.trs=0,this.qss=!1,this.Kss=!1,this.Zss=!1};(qt.prototype=new Wt).constructor=qt,qt.prototype.irs=function(t){this.Uts=t.qts(),this.$ss=t.qts();var i=t.tis();if(this.qss=1&i,this.Kss=2&i,this.Zss=4&i,this.srs=16&i,this.qss&&(this.trs=t.tis()),this.srs){this.rrs=t.qts(),this.nrs=[];for(var s=0;s<this.rrs;++s){var r=t.tis(),n=t.Wts();this.nrs.push({dimension:r,identifier:n})}}this.Qss()},qt.prototype.hrs=function(t,i,s,r,n){var h=V?z:0;if(r)switch(V?B:0){case 0:t.mis(i,r,this.posBuffer);break;case D:var e=new Array(3*r);t.yis(r,e),Uint16PositionsToFloats(i,this.posBuffer,e,ri,ni);break;default:throw"Uknown position quantization"}if(this.$ss)switch(h){case 0:t.Nis(s,n,this.Hss);break;case C:var a=new Array(2*n);t.xis(n,a),Oct16NormalsToFloats(s,this.Hss,a);break;case G:a=new Array(3*n);t.xis(n,a),Oct24NormalsToFloats(s,this.Hss,a);break;default:throw"Uknown normals quantization"}if(this.qss&&t.Ris(i,r,this.trs,this.Yss),this.Kss&&this.Uts&&t.readFloatArray(2*i,2*r,this.Xss),this.Zss&&(t.readFloatArray(3*i,3*r,this.Wss),t.readFloatArray(3*i,3*r,this.Jss)),this.rrs>0&&t.version>=210041920)for(var f=0;f<this.rrs;++f){var o=this.nrs[f].dimension;t.skip(4*o*r)}};var Kt=function(){this.geomType=0,this.nbPrimitives=0,this.primitives=[],this.attribute=null,this.material={file:"",id:-1},this.skip=!1};Kt.prototype.ers=function(t){var i=t.qts();this.geomType=Ar[i],this.nbPrimitives=t.qts(),12==i?this.skip=!0:this.primitives=new Array(this.nbPrimitives);for(var s=0;s<this.nbPrimitives;++s){var r=null;switch(t.tis()){case 1:r=new Mr;break;case 2:r=new Sr;break;case 3:r=new jr;break;case 4:break;case 5:r=new Ir;break;case 6:r=new Nr}r&&(this.skip?r.skip(t):(r.gss(t),this.primitives[s]=r))}};var Zt=function(){Kt.call(this)};(Zt.prototype=Object.create(Kt.prototype)).constructor=Zt,Zt.prototype.gss=function(i){if(this.ers(i),this.skip)i.skip(8*this.nbPrimitives);else for(var s=0;s<this.primitives.length;++s){var r=i.sis(),n=i.Lis(r,0);n.setConnectivity(this.primitives[s].connectivity);var h=n.lss();"WIRE_EDGE"!==this.geomType&&(n.Yis(1),n.Jis(t.LinePatternEnum.SOLID)),h&&(this.thn=!0),this.primitives[s].symbol&&n.setSymbol(this.primitives[s].symbol),this.primitives[s].gas=n,i.Kis()}};var Qt=function(){Kt.call(this)};(Qt.prototype=Object.create(Kt.prototype)).constructor=Qt,Qt.prototype.gss=function(i){this.ers(i);var s=i.sis(),r=i.Lis(s,0);r.lss()&&"BOUNDARY_POINT"!=this.geomType&&"SHARP_POINT"!=this.geomType&&"SMOOTH_POINT"!=this.geomType&&"SURFACIC_POINT"!=this.geomType&&"FREE_POINT"!=this.geomType&&(this.thn=!0),"WIRE_EDGE"!==this.geomType&&(r.Yis(1),r.Jis(t.LinePatternEnum.SOLID));for(var n=0;n<this.primitives.length;++n){var h=r.clone();h.setConnectivity(this.primitives[n].connectivity),this.primitives[n].symbol&&h.setSymbol(this.primitives[n].symbol),this.primitives[n].gas=h}i.Kis()};var $t=function(){Kt.call(this)};($t.prototype=Object.create(Kt.prototype)).constructor=$t,$t.prototype.gss=function(t){Zt.prototype.gss.call(this,t);for(var i=0,s=[],r=this.primitives.length,n=0;n<r;n++)s[n]=[];if(t.version>=210041800&&(i=t.kis()),i>0){if(t.tis()){for(n=0;n<i;n++){if(t.tis()){for(var h={material:null,ars:null,layer:null},e=(t.Wts(),t.kis()),a=0;a<e;a++){s[t.kis()].push(h)}if((l=t.kis())>0)for(a=0;a<l;a++){var f=this.frs(t,rt.yts);if(a==l-1){if(f.mapping){var o=t.materials.get([f.material.id]);o&&(o.mapping=f.mapping)}f.material.ors=!0,h.material=f.material,h.ars=f.ars,h.layer=f.layer}}}}for(n=0;n<r;n++){var u=this.primitives[n],c=s[n];for(a=0;a<c.length;a++)t.Qis(c[a].material,c[a].ars,c[a].layer,this);u.material=t.hss(),u.material&&(u.material.ors=!0);for(a=0;a<c.length;a++)t.Zis()}t.version;var v=t.kis();for(n=0;n<v;++n){var l;t.ris();if((l=t.kis())>0)for(a=0;a<l;++a){f=this.frs(t,rt.urs);0==l&&(t.Qis(f.material,f.ars,f.layer,this),w=t.hss(),t.Zis())}}}}else for(n=0;n<this.nbPrimitives;n++){if(t.tis()){var w=(f=this.frs(t,rt.ots)).material;w.ors=!0,this.skip||(this.primitives[n].material=w)}}},$t.prototype.crs=function(t){var i,s={file:"",id:-1},r=0,n=t.tis(),h=0,e=null;if(n){if(2==n){t.Wts();return r=t.qts(),s.id=t.materials.add({external3DXid:r}),s}if(h=t.qts(),t.materials.Dss(h,t.name))return s={file:"",id:c=t.materials.Gss(h,t.name)}}if(t.version>=210021320){var a=t.qts();e=1===a?new Jt:4===a?new Bt:9===a&&t.version>=210042100?new zt:new Vt}else e=new Vt;i=e.gss(t);var f=t.getCurrentPosition(),o=t.Jts();o>32&&(o=32);var u=t.UAt(o);(t.Qts(f),-1!==u.indexOf('{\n"Version" : '))&&(new Bt).skip(t);if(1===a)var c=i;else c=t.materials.add(i);return s={file:"",id:c},n&&t.materials.Vss(h,c,t.name),s},$t.prototype.frs=function(t,i){var s={material:null,ars:1,layer:0};if(i&rt.ots&&(s.material=this.crs(t)),t.version>=1100500?i&rt.uts||i&rt.cts?s.ars=t.qts():i&rt.vts&&(s.ars=t.ris()):i&(rt.uts|rt.cts|rt.vts)&&(s.ars=1),i&rt.lts?s.layer=t.ris():i&rt.wts?s.layer=t.qts():i&rt.bts&&(s.layer=t.ass()),i&rt.dts){if(t.version>=210041900){var r=[0,0,0,1];if(t.Ais()){var n=!0,h=t.readFloat(),e=t.readFloat(),a=t.readFloat(),f=t.readFloat();h!=r[0]&&(r[0]=h,n=!1),e!=r[1]&&(r[1]=e,n=!1),a!=r[2]&&(r[2]=a,n=!1),f!=r[3]&&(r[3]=f,n=!1),n||(s.mapping={type:0,ObjectTransformation:null,UvTransformation:null,UvTransfoInfos:r,transformSemantic:1})}}}if(i&rt.Ats&&(t.version>=210042100&&!t.Ais())){var o=t.Wts();if(o=(o=JSON.parse(o)).mappings[o.uvSlots.Default],s.mapping||(s.mapping={type:0,ObjectTransformation:null,UvTransformation:null,UvTransfoInfos:null,transformSemantic:1}),o.vrs&&(s.mapping.transformSemantic=o.vrs+1),o.uvTransform&&(s.mapping.UvTransformation=t.Bts(o.uvTransform)),o.operator&&(s.mapping.type=o.operator.type,o.operator.transform)){var u=o.operator.transform;s.mapping.ObjectTransformation=u}}if(i&rt.mts&&(t.version>=210042320&&1==t.qts()))t.Wts(),t.qts(),t.Tis();return s};var ti=function(){};ti.prototype.gss=function(t){var i={};t.qts();i.timestamp=t.Tis();let s=t.qts();return s&&(i.comment=t.Wts(s)),i.lrs=t.qts(),t.version>210041930?i.sag3D=t.readDouble():i.sag3D=t.readFloat(),i};var ii=function(){};ii.prototype.skip=function(t,i){var s=t.qts();s<0&&(s=-s-2),t.skip(s-4)},ii.prototype.gss=function(t,i){var s=new Qs,r=t.qts();r<0&&(r=-r-2);var n=!1;t.getCurrentPosition();s.rep.gss(t),t.lis(16777216);var h,e=t.qts();if(e<=0)return t.Zis(),t.Kis(),null;for(var a=0;a<e;a++){switch(h=null,t.tis()){case M:case y:h=new xi;break;case O:case p:h=new Ns;break;case k:h=new Ui;break;case S:h=new Di;break;case g:h=new Ci;break;case j:h=new _i;break;case I:h=new Pi;break;case N:h=new Li;break;case x:h=new Vi;break;case T:h=new Bi;break;case R:h=new zi;break;case E:h=new Hi;break;case m:break;default:return}if(null!==h){h.gss(t);var f,o,u=t.sis();if((f=t.Lis(u,0)).lss())n=!0,(o=t.Kis()).inherited.FJe(0),t.Lis(o.inherited,o.Vis);h.primitive&&h.primitive.symbol&&f.setSymbol(h.primitive.symbol),h.primitive&&f.setConnectivity(h.primitive.connectivity),s.wrs(h,f,t,i),t.Kis()}else t.sis()}(s.brs(t,i),n)||0==(f=t.X9e()).getType()&&((o=t.Kis()).inherited.FJe(2),t.Lis(o.inherited,o.Vis));var c=s.$qe(t);return s.drs.length?(s.drs.push(s.rep),s.drs):c?s.rep:null};var si=function(){};si.prototype.gss=function(i){var s=new Yr,r=i.qts();r<0&&(r=-r-2),s.rep.gss(i);var n=i.qts(),h=new t.PrimitiveGroup;h.fillAttr=new t.FillAttributes,h.lineAttr=new t.LineAttributes,h.pointAttr=new t.PointAttributes;for(var e,a=0;a<n;++a){switch(e=null,i.tis()){case 121:e=new Ss;break;case 128:e=new Is;break;case 129:e=new gs;break;case 130:e=new js;break;case 131:e=new ks;break;case 132:e=new vs;break;case 135:e=new ls;break;case 136:e=new ws;break;case 164:e=new As;break;case 165:e=new ds;break;case 166:e=new bs;break;case 167:e=new ms;break;case 168:e=new Ms;break;case 169:e=new ys;break;case 105:e=new Os}if(e){var o=e.gss(i),u=i.sis(),c=i.Lis(u,0);if(e.primitive&&e.primitive.symbol&&c.setSymbol(e.primitive.symbol),c.setBasic(),c.setConnectivity(e.primitive.connectivity),2==o&&u.oss(),f&&e instanceof Os&&e.text){var v=c.getDisplayedColor(),l=-1;c.lss()&&(l=c.V_i()),e.text.ZUi=l;var w=new t.Color(v[0]/255,v[1]/255,v[2]/255,v[3]/255);e.text.color=w,i.$xe.add(e.text)}o&&s.wrs(e,c,i),i.Kis()}}var b=s.$qe(i);return s.drs.length?(s.drs.push(s.rep),s.drs):b?s.rep:null};var ri={x:0,y:0,z:0},ni={x:0,y:0,z:0},hi=function(){};hi.prototype.Ars=function(t,i){i||(i=new $s);t.qts();var s=!1;if(i.rep.gss(t),t.version>=21e5&&!l){var r=0;(m=t.tis())&&(i.vertexBuffer=new qt,i.vertexBuffer.irs(t),r=i.vertexBuffer.cis());i.mrs=t.tis();var n=0;if(i.mrs){n=new Float32Array(i.mrs+1);t.readFloatArray(0,i.mrs+1,n)}else n=t.version>210041930?t.readDouble():t.readFloat();if(a&&(i.rep.node.sag=n),t.version>=210021620)t.readDouble();t.lis(r);var h=0;i.Mrs=t.qts();for(var e=0,f=0;h<=dr.yrs;)if(0!=i.mrs||h!=dr.Ors&&h!=dr.prs&&h!=dr.krs&&h!=dr.FACES){if(0==i.mrs&&h==dr.Srs){if(!(v=t.ase()))return t.error=" container not found",!1;var o=v.grs("LOD0");if(t.rss(o),o){if(o.Qts(i.Mrs),i.Mrs=o.qts(),m){var u=o.qts(),c=o.qts();i.vertexBuffer.hrs(o,e,f,u,c),o.lis(i.vertexBuffer.cis())}i.jrs(o),i.sets[0]&&i.sets[0].thn&&(s=!0)}}else if(h==dr.Srs){if(!(v=t.ase()))return t.error=" container not found",!1;o=v.grs("LOD0");if(t.rss(o),o&&(o.Qts(i.Mrs),i.Mrs=o.qts(),m)){u=o.qts(),c=o.qts();i.vertexBuffer.hrs(o,e,f,u,c),e+=u,f+=c}}if(h==dr.Ors){if(!(v=t.ase()))return t.error=" container not found",!1;o=v.grs("LOD1");if(t.rss(o),o&&(o.Qts(i.Mrs),i.Mrs=o.qts(),m)){u=o.qts(),c=o.qts();i.vertexBuffer.hrs(o,e,f,u,c),e+=u,f+=c}}if(h==dr.prs){if(!(v=t.ase()))return t.error=" container not found",!1;o=v.grs("LOD2");if(t.rss(o),o&&(o.Qts(i.Mrs),i.Mrs=o.qts(),m)){u=o.qts(),c=o.qts();i.vertexBuffer.hrs(o,e,f,u,c),e+=u,f+=c}}if(h==dr.krs){if(!(v=t.ase()))return t.error=" container not found",!1;o=v.grs("LOD3");if(t.rss(o),o&&(o.Qts(i.Mrs),i.Mrs=o.qts(),m)){u=o.qts(),c=o.qts();i.vertexBuffer.hrs(o,e,f,u,c),e+=u,f+=c}}if(h==dr.FACES){if(!(v=t.ase()))return t.error=" container not found",!1;o=v.grs("FACES");if(t.rss(o),o){if(o.Qts(i.Mrs),i.Mrs=o.qts(),m){u=o.qts(),c=o.qts();o.lis(e+u),i.vertexBuffer.hrs(o,e,f,u,c),e+=u,f+=c}else o.lis(0);i.jrs(o),i.sets[0]&&i.sets[0].thn&&(s=!0)}}if(h==dr.yrs){var v;if(!(v=t.ase()))return t.error=" container not found",!1;var w=v.grs("LSG");if(w){t.rss(w),w.lis(r),m?w.lis(r):w.lis(0),w.Qts(i.Mrs),i.Mrs=w.qts();var b=i.sets.length,d=w.tis();i.Irs=d+b;for(var A=0;A<d;++A){switch(w.tis()){case 1:i.sets[A+b]=new Qt;break;case 2:i.sets[A+b]=new Zt;break;default:return void(i.sets[A+b]=null)}if(i.sets[A+b])if(i.sets[A+b].gss(w),i.sets[A+b].thn)s=!0,(y=t.Kis()).inherited.FJe(0),t.Lis(y.inherited,y.Vis)}}}h++}else h++;if(!s)if(0==t.X9e().getType())(y=t.Kis()).inherited.FJe(2),t.Lis(y.inherited,y.Vis)}else{var m;(m=t.tis())&&(i.vertexBuffer=new qt,i.vertexBuffer.gss(t),t.lis(i.vertexBuffer.cis()));n=0;n=t.version>210041930?t.readDouble():t.readFloat(),i.mrs=t.tis(),a&&(i.rep.node.sag=n);for(A=0;A<i.mrs;++A){var M;switch(t.tis()){case 1:M=new Mr;break;case 4:M=new kr}M&&[].push(M.gss(t)),t.readFloat(),t.ris();t.ris()}i.Irs=t.tis();for(A=0;A<i.Irs;++A){var y;switch(t.tis()){case 1:i.sets[A]=new Qt;break;case 2:i.sets[A]=new Zt;break;default:return void(i.sets[A]=null)}if(i.sets[A])if(i.sets[A].gss(t),i.sets[A].thn)s=!0,(y=t.Kis()).inherited.FJe(0),t.Lis(y.inherited,y.Vis)}if(!s)if(0==t.X9e().getType())(y=t.Kis()).inherited.FJe(2),t.Lis(y.inherited,y.Vis)}return i};var ei=function(){this.Nrs=0};ei.prototype=Object.create(hi.prototype),ei.prototype.constructor=ei,ei.prototype.gss=function(t){var i=new $s,s=this.Ars(t,i);if(i.Mrs||(i.Mrs=0),t.version<21e5&&(i.Mrs=t.qts()),!l){if(!s)return!1;var r=t.ase(),n=r?r.grs("SurfacicReps"):t;r&&n.Qts(i.Mrs),t.rss(n);var h=new ai;if(n)h.Ars(n,i);else{if(n.Dts)return;h.gss(n,i)}}return!!s&&(i.$qe(t)?i.rep:null)};var ai=function(){};ai.prototype.xrs=function(t){t.qts(),t.qts()},ai.prototype.Ars=function(t,i){if(!(t.version<1101410)&&i){t.sss(!1);t.qts(),t.readFloat(),t.readFloat();if(t.version>=210041720)128&t.tis()&&t.skip(4);if(t.version>=210042320)t.tis();var s=i.Trs("FACE"),r=i.Trs("EDGE"),n=s.length,h=r.length,e=i.mrs,a=t.qts(),f=new xi;if(n)for(var o=0;o<n;o++){var u=s[o];f.gss(t),u.cgmId=f.node.cgmId,u.decoration=f.decoration,u.boundingSphere=f.boundingSphere}for(o=0;o<e;o++)f.gss(t);var c=new Ei;if(h&&r)for(o=0;o<h;o++){var v=r[o];c.gss(t),v.cgmId=c.node.cgmId,v.decoration=c.decoration,this.xrs(t)}for(o=0;o<a;o++){var l=t.qts();t.ris(),t.ris();if(t.version>=1101710&&t.version<210042440&&t.sss(!0),l)for(var w=new Ns,b=0;b<l;b++)w.skip(t);t.version>=1101710&&t.version<210042440&&t.sss(!1)}for(var d=i.Irs,A=new Ei,m=new Ui,M=0;M<d;++M){var y=i.sets[M],O=y.primitives;for(b=0;b<O.length;b++){var p=O[b];if("FACE"!=y.geomType&&"EDGE"!=y.geomType&&"ISOPAR"!=y.geomType){var k=null,S=t.tis();switch(S){case 80:case 81:k=new xi;break;case 82:k=new Ns;break;case 84:k=m;break;case 96:case 200:k=A;break;case 162:k=new Fi;break;case 134:k=new xs;break;case 86:k=new Ci;break;case 187:k=new Ri;break;default:return}k&&(k.gss(t),p.cgmId=k.node.cgmId,p.decoration=k.decoration,p.boundingSphere=k.boundingSphere),96!=S&&200!=S&&162!=S||this.xrs(t)}}}t.sss(!0)}};var fi=function(){};fi.prototype.gss=function(t){var i=new lr,s=(t.qts(),!1);i.Rrs=0,i.vertexBuffer=new Wt;var r=null,n=null;i.rep.gss(t);var h=t.readFloat();a&&(i.rep.node.sag=h);t.readFloat(),t.readFloat();t.version>=210041740&&(128&t.tis()&&t.skip(8));if(t.version>=210042320)t.tis();if(i.Ers=t.qts(),i.Ers)for(var e=i.Ers-1;e>=0;e--){(r=new Ns).primitive.indices=i.indexBuffer,r.vertexBuffer=i.vertexBuffer,r.gss(t),r.primitive.cgmId=r.node.cgmId,r.decoration&&(r.primitive.decoration=r.decoration),i.Rrs+=r.primitive.count;var f=t.sis();if((l=t.Lis(f,0)).setConnectivity(3),t.Kis(),l.lss())s=!0,(w=t.Kis()).inherited.FJe(0),t.Lis(w.inherited,w.Vis);r.primitive.ghi=l;for(var o=i.Frs.length,u=0;u<o;u++){var c=i.Frs[u];if(c.ghi.set==r.primitive.ghi.set&&c.ghi.rgba==r.primitive.ghi.rgba){c.set.push(r.primitive),c.nbIndices+=r.primitive.count;break}}if(u==i.Frs.length)(b={}).ghi=r.primitive.ghi,b.nbIndices=r.primitive.count,b.set=[],b.set.push(r.primitive),i.Frs.push(b)}if(i._rs=t.qts(),i._rs){for(e=i._rs-1;e>=0;e--){(n=new Ui).vertexBuffer=i.vertexBuffer,n.primitive.indices=i.indexBuffer,n.gss(t),n.primitive.cgmId=n.node.cgmId,n.decoration&&(n.primitive.decoration=n.decoration),i.Rrs+=n.primitive.count;o=i.Prs.length;for(u=0;u<o;u++){var v=i.Prs[u];if(v.symbol==n.primitive.symbol){v.set.push(n.primitive),v.nbIndices+=n.primitive.count;break}}if(u==i.Prs.length)(b={}).symbol=n.primitive.symbol,b.nbIndices=n.primitive.count,b.set=[],b.set.push(n.primitive),i.Prs.push(b)}var l,w;f=t.sis();if((l=t.Lis(f,0)).setConnectivity(6),t.Kis(),l.lss())s=!0,(w=t.Kis()).inherited.FJe(0),t.Lis(w.inherited,w.Vis);for(e=0;e<i.Prs.length;e++){var b;(b=i.Prs[e]).ghi=l.clone(),b.ghi.setSymbol(b.symbol)}}s||0==(l=t.X9e()).getType()&&((w=t.Kis()).inherited.FJe(2),t.Lis(w.inherited,w.Vis));return i.$qe(t)?i.rep:null};var oi=function(){};oi.prototype=Object.create(hi.prototype),oi.prototype.constructor=oi,oi.prototype.gss=function(t){var i=new cr,s=(t.qts(),!0);if(i.rep.gss(t),i.vertexBuffer=new Wt,i.mrs=t.qts(),i.mrs>0){for(var r=[],h=1;h<=i.mrs;++h)r.push(t.readFloat());var e=new _i;s=e.gss(t,i.vertexBuffer),i.sets.push(e),n&&(i.curveVertices=e.curveVertices,i.startNormal=e.startNormal,i.endNormal=e.endNormal,i.startSideVector=e.startSideVector,i.radius=e.radius);for(h=1;h<=i.mrs-2;h++){(new _i).skip(t)}(new Ns).skip(t)}return s?i.$qe(t)?i.rep:null:(t.Zis(),t.Kis(),null)};var ui=function(){};ui.prototype=Object.create(hi.prototype),ui.prototype.constructor=ui,ui.prototype.gss=function(t){var i=new rr;t.qts();if(i.rep.gss(t),i.vertexBuffer=new Wt,i.mrs=t.qts(),i.mrs>0){for(var s=[],r=0;r<i.mrs;++r)s.push(t.readFloat());for(r=0;r<i.mrs;++r)(new Ns).gss(t)}return i.$qe(t)?i.rep:null};var ci=function(){};ci.prototype=Object.create(hi.prototype),ci.prototype.constructor=ci,ci.prototype.gss=function(t){var i=new or;t.qts();i.rep.gss(t);var s=new Ci;s.gss(t);var r=t.X9e(),n=r.getDisplayedColor(),h=s.primitive;return i.refPlane.push({rep:i.rep.node,origin:h.origin,VJi:h.direction1,OJi:h.direction2,noShow:r.isHidden(),color:n,lengthX:h.length,lengthY:h.length,mode:h.mode,type:"CAT3DPlanRep"}),i.$qe(t),null};var vi=function(){};vi.prototype=Object.create(hi.prototype),vi.prototype.constructor=vi,vi.prototype.gss=function(t){var i=new sr;t.qts();if(i.rep.gss(t),t.tis())(new Bi).gss(t);return i.$qe(t)?i.rep:null};var li=function(){};li.prototype=Object.create(hi.prototype),li.prototype.constructor=li,li.prototype.gss=function(t){var i=new nr;t.qts();if(i.rep.gss(t),t.tis())(new Bi).gss(t);return i.$qe(t)?i.rep:null};var wi=function(){};wi.prototype=Object.create(hi.prototype),wi.prototype.constructor=wi,wi.prototype.gss=function(t){var i=new vr;t.qts();if(i.rep.gss(t),i.vertexBuffer=new Wt,i.mrs=t.qts(),i.mrs>0){for(var s=[],r=1;r<=i.mrs;++r)s.push(t.readFloat());var h=new Pi;i.Urs=h.gss(t,i.vertexBuffer),i.sets.push(h),i.Urs&&n&&(i.curveVertices=h.curveVertices,i.startNormal=h.startNormal,i.endNormal=h.endNormal,i.startSideVector=h.startSideVector,i.radius=h.radius);for(r=1;r<=i.mrs-2;r++){(new Pi).skip(t)}(new Ns).skip(t)}return i.$qe(t)?i.rep:null};var bi=function(){};bi.prototype=Object.create(hi.prototype),bi.prototype.constructor=bi,bi.prototype.gss=function(t){var i=new Ur;t.qts();if(i.rep.gss(t),i.vertexBuffer=new Wt,t.tis()>0){var s=new Ss;s.gss(t),i.gp=s}return i.$qe(t)?i.rep:null};var di=function(){};di.prototype=Object.create(hi.prototype),di.prototype.constructor=di,di.prototype.gss=function(t){var i=new Dr;t.qts();i.rep.gss(t),i.vertexBuffer=new Wt;var s=new gs;return s.gss(t),i.gp=s,i.$qe(t)?i.rep:null};var Ai=function(){};Ai.prototype=Object.create(hi.prototype),Ai.prototype.constructor=Ai,Ai.prototype.gss=function(t){var i=new er;t.qts();if(i.rep.gss(t),i.vertexBuffer=new Wt,1==t.tis()){var s=new Ui;s.gss(t),i.gp=s}return i.$qe(t)?i.rep:null};var mi=function(){};mi.prototype=Object.create(hi.prototype),mi.prototype.constructor=mi,mi.prototype.gss=function(t){var i=new hr;t.qts();i.rep.gss(t);(new Di).gss(t),(new Di).gss(t),(new Di).gss(t);return i.$qe(t)?i.rep:null};var Mi=function(){};Mi.prototype=Object.create(hi.prototype),Mi.prototype.constructor=Mi,Mi.prototype.gss=function(t){var i=new ir;t.qts();if(i.rep.gss(t),i.vertexBuffer=new Wt,1==t.tis()){var s=new js;s.gss(t),i.gp=s}return i.$qe(t)?i.rep:null};var yi=function(){};yi.prototype=Object.create(hi.prototype),yi.prototype.constructor=yi,yi.prototype.gss=function(t){var i=new ar;t.qts();i.rep.gss(t),i.vertexBuffer=new Wt;var s=new Ns;return s.gss(t),i.gp=s,i.$qe(t)?i.rep:null};var Oi=function(){};Oi.prototype=Object.create(hi.prototype),Oi.prototype.constructor=Oi,Oi.prototype.Drs=function(t){var i,s=t.getCurrentPosition();ii.prototype.skip.call(this,t);var r=0;t.version>=210042110?(i=t.readFloat(),r=t.qts()):i=t.qts();var n=t.qts();return t.Qts(s),{Crs:n,mode:r,axisLength:i}},Oi.prototype.gss=function(t){t.qts();var i=this.Drs(t);if(ii.prototype.gss.call(this,t,i),t.version>=210042110){t.readFloat();t.qts()}else t.qts();t.qts();return null};var pi=function(){};pi.prototype=Object.create(hi.prototype),pi.prototype.constructor=pi,pi.prototype.gss=function(t){var i=new Cr;t.qts();if(i.rep.gss(t),i.vertexBuffer=new Wt,t.tis()>0){var s=new Is;s.gss(t),i.gp=s}return i.$qe(t)?i.rep:null};var ki=function(){};ki.prototype=Object.create(hi.prototype),ki.prototype.constructor=ki,ki.prototype.gss=function(t){var i=new Vr;t.qts();i.rep.gss(t),i.vertexBuffer=new Wt;var s=new ls;return s.gss(t),i.gp=s,i.$qe(t)?i.rep:null};var Si=function(){};Si.prototype=Object.create(hi.prototype),Si.prototype.constructor=Si,Si.prototype.gss=function(t){var i=new Lr;t.qts();i.rep.gss(t),i.vertexBuffer=new Wt,i.Grs(t);for(var s=t.qts(),r=0;r<s;r++){var n=new ks;n.gss(t),i.gp.push(n)}return i.gp.length?i.$qe(t)?i.rep:null:(t.Zis(),t.Kis(),null)};var gi=function(){};gi.prototype=Object.create(hi.prototype),gi.prototype.constructor=gi,gi.prototype.gss=function(t){var i=new Hr;t.qts();i.rep.gss(t),i.vertexBuffer=new Wt;var s=new ks,r=s.gss(t);return i.gp=s,r&&i.$qe(t)?i.rep:null};var ji=function(){};ji.prototype=Object.create(hi.prototype),ji.prototype.constructor=ji,ji.prototype.gss=function(t){var i=new zr;t.qts();i.rep.gss(t),i.vertexBuffer=new Wt;var r=new bs,n=r.gss(t);if(i.gp=r,n&&r){void 0!==r.Lrs&&0===r.Lrs&&t.Uis(!0),r.point&&(t.Cis(t.nss()),t.Ets.push(new s.Matrix4)),r.primitive.material&&t.Qis(r.primitive.material,1,0,i.rep),i.gp=r;var h=i.$qe(t);return t.Uis(!1),r.primitive.material&&t.Zis(),r.point&&(t.Ets.pop(),t.Gis()),h?i.rep:null}return null};var Ii=function(){this.node=new t.SGPrimitive,this.vertexBuffer=null,this.primitive=null,this.decoration=0};(Ii.prototype=Object.create(Ii.prototype)).constructor=Ii,Ii.prototype.Vrs=function(t){if(this.node.cgmId=0,this.decoration=0,t.version>=1100700?this.node.cgmId=t.ris():t.version>=1100200&&(this.node.cgmId=t.qts()),t.version>=1100800){var i=t.Zts();if(i>0){var s=t.decorations,r=[];if(1==i){r.push(0);t.tis()}else if(65535==i)r.push(0);else{r.push(i);for(var n=0;n<i;n++)r.push(t.tis())}this.decoration=s.Brs(r)}}},Ii.prototype.zrs=function(i,s,r,n,h,e,a,f,o){s.start=0,a<e&&(a+=2*Math.PI);var u=i.posBuffer.length/3;if(o){s.connectivity=t.ConnectivityTypeEnum.TRIANGLES,s.count+=3*(f-2);for(var c=0;c<f;++c){var v=e+(a-e)*c/(f-1);i.posBuffer.push(r+h*Math.cos(v)),i.posBuffer.push(n+h*Math.sin(v)),i.posBuffer.push(0),i.Hss.push(0),i.Hss.push(0),i.Hss.push(1)}for(c=1;c<f-1;c++)s.indices.push(0),s.indices.push(c),s.indices.push(c+1)}else{s.connectivity=t.ConnectivityTypeEnum.LINES,s.count+=2+2*(f-2);v=e;i.posBuffer.push(r+h*Math.cos(v)),i.posBuffer.push(n+h*Math.sin(v)),i.posBuffer.push(0);for(c=1;c<f;++c)v=e+(a-e)*c/(f-1),s.indices.push(u++),i.posBuffer.push(r+h*Math.cos(v)),i.posBuffer.push(n+h*Math.sin(v)),i.posBuffer.push(0),s.indices.push(u)}},Ii.prototype.Hrs=function(i,s,r,n){switch(s.start=0,s.connectivity=t.ConnectivityTypeEnum.LINES,n){case 0:s.count+=r;for(var h=0;h<r;++h)s.indices.push(i++);break;case 1:s.count+=2+2*(r-2);for(h=1;h<r;++h)s.indices.push(i++),s.indices.push(i);break;case 2:s.count+=4+2*(r-2);var e=i;for(h=0;h<r-1;++h)s.indices.push(i++),s.indices.push(i);s.indices.push(i),s.indices.push(e);break;default:return null}},Ii.prototype.Yrs=function(i,s,r,n,h,e){if(s.start=0,e){s.connectivity=t.ConnectivityTypeEnum.TRIANGLES;switch(h){case 0:case 4:s.count+=n;for(var a=0;a<n;++a)s.indices.push(r[i++]);break;case 1:case 5:s.count+=3*(n-2);var f=0;for(a=0;a<n-2;a++)s.indices.push(r[i]),s.indices.push(r[i+1+f]),s.indices.push(r[i+2-f]),i++,f=1-f;i+=2;break;case 2:case 6:s.count+=3*(n-2);var o=r[i];for(a=0;a<n-2;a++)s.indices.push(o),s.indices.push(r[i+2]),s.indices.push(r[i+1]),i++;i+=2;break;default:return null}}else{s.connectivity=t.ConnectivityTypeEnum.LINES,s.count=2+2*(n-1);for(var u=i,c=1;c<n;++c)s.indices.push(i++),s.indices.push(i);s.indices.push(i),s.indices.push(u)}return i};var Ni=function(){Ii.call(this),this.Xrs=new Float32Array(3),this.Jrs=new Float32Array(3),this.boundingSphere=null};(Ni.prototype=Object.create(Ii.prototype)).constructor=Ni,Ni.prototype.Wrs=function(t){switch(this.Vrs(t),V?L:0){case 0:for(var i=0;i<3;i++)this.Xrs[i]=t.readFloat();for(i=0;i<3;i++)this.Jrs[i]=t.readFloat();var s=new Array(3);for(i=0;i<3;i++)s[i]=t.readFloat();var r=t.readFloat();h&&(this.boundingSphere={center:s,radius:r});break;case P:var n=(ni.x-ri.x)*one_over_65535,e=(ni.y-ri.y)*one_over_65535,a=(ni.z-ri.z)*one_over_65535,f={x:t.Zts()*n+ri.x,y:t.Zts()*e+ri.y,z:t.Zts()*a+ri.z},o={x:t.Zts()*n+ri.x,y:t.Zts()*e+ri.y,z:t.Zts()*a+ri.z};this.Xrs[0]=.5*(o.x+f.x),this.Xrs[1]=.5*(o.y+f.y),this.Xrs[2]=.5*(o.z+f.z),this.Jrs[0]=o.x-f.x,this.Jrs[1]=o.y-f.y,this.Jrs[2]=o.z-f.z;for(s=new Array(3),i=0;i<3;i++)s[i]=this.Xrs[i];r=Math.max(Math.max(this.Jrs[0],this.Jrs[1]),this.Jrs[2])*Math.sqrt(2)*.5;h&&(this.boundingSphere={center:s,radius:r});break;case U:this.Xrs[0]=.5*(ni.x+ri.x),this.Xrs[1]=.5*(ni.y+ri.y),this.Xrs[2]=.5*(ni.z+ri.z),this.Jrs[0]=ni.x-ri.x,this.Jrs[1]=ni.y-ri.y,this.Jrs[2]=ni.z-ri.z;for(s=new Array(3),i=0;i<3;i++)s[i]=this.Xrs[i];r=Math.max(Math.max(this.Jrs[0],this.Jrs[1]),this.Jrs[2])*Math.sqrt(2)*.5;h&&(this.boundingSphere={center:s,radius:r})}};var xi=function(){Ni.call(this)};xi.prototype=Object.create(Ni.prototype),xi.prototype.constructor=xi,xi.prototype.gss=function(t){if(t.version>=1101410){this.Wrs(t),t.iss()&&(this.primitive=new Mr,this.primitive.gss(t),t.tis()&&(this.vertexBuffer=new Wt,this.vertexBuffer.gss(t))),t.version>=1101430?t.tis():0}else{this.Wrs(t);var i=t.qts(),s=t.qts(),r=t.qts(),n=t.qts(),h=t.qts();this.primitive=new Mr,t.version>=1100700&&t.tis();var e,a=1&(e=t.tis())||2&e,f=4&e||8&e;if(this.vertexBuffer||(this.vertexBuffer=new Wt),a)t.readFloatArray(0,i,this.vertexBuffer.posBuffer),t.tis()&&t.readFloatArray(0,i,this.vertexBuffer.uvBuffer),t.version>1100820&&(multiple_texture=t.tis());if(f)if(t.version>1000800){t.Iis(s,this.vertexBuffer.Hss);for(var o=0;o<s;o++)this.vertexBuffer.Hss[o]*=1/32767}else t.readFloatArray(0,s,this.vertexBuffer.Hss);r&&(t.version>=1100600||t.version>1000500?t.Eis(3*r,this.primitive.indices,0):this.primitive.indices=t.fss(3*r,this.primitive.indices));var u=[],c=this.primitive.indices.length;if(n){var v=[];for(t.version>1000500?t.Eis(n,v,0):t.fss(n,v),o=n-1;o>=0;o--){var l=v[o];t.version>=1100600||t.version>1000500?t.Eis(l,u,0):t.fss(l,u);for(var w=2;w<l;++w)w%2?(this.primitive.indices[c++]=u[w],this.primitive.indices[c++]=u[w-1],this.primitive.indices[c++]=u[w-2]):(this.primitive.indices[c++]=u[w-1],this.primitive.indices[c++]=u[w],this.primitive.indices[c++]=u[w-2])}}if(h){var b=[];for(t.version>1000500?t.Eis(h,b,0):t.fss(h,b),o=h-1;o>=0;o--){var d=b[o];t.version>=1100600||t.version>1000500?t.Eis(d,u,0):t.fss(d,u);for(w=2;w<d;++w)this.primitive.indices[c++]=u[0],this.primitive.indices[c++]=u[w-1],this.primitive.indices[c++]=u[w]}}t.tis()&&t.readFloatArray(0,2*i/3,this.vertexBuffer.uvBuffer),i||3!=s?i&&3==s&&(this.qrs=this.vertexBuffer.Hss):this.qrs=this.vertexBuffer.Hss}};var Ti=function(){xi.call(this)};(Ti.prototype=Object.create(xi.prototype)).constructor=Ti;var Ri=function(){Ii.call(this)};Ri.prototype=Object.create(Ii.prototype),Ri.prototype.constructor=Ri,Ri.prototype.gss=function(t){if(t.version>=210021710){this.Vrs(t);t.kis()}};var Ei=function(){Ii.call(this),this.Krs=null,this.Zrs=null,this.Qrs=null};Ei.prototype=Object.create(Ii.prototype),Ei.prototype.constructor=Ei,Ei.prototype.gss=function(t){if(t.version>=1101410)return this.Vrs(t),void(t.iss()&&(this.Qrs=new Sr,this.Qrs.gss(t),this.vertexBuffer=new Wt,this.vertexBuffer.posBuffer=vizEdge.linePos))};var Fi=function(){Ei.call(this)};Fi.prototype=Object.create(Ei.prototype),Fi.prototype.constructor=Fi,Fi.prototype.gss=function(t){if(Ei.prototype.gss.call(this,t),t.Ais()){var i=t.kis();i&&t.skip(3*i*4)}};var _i=function(){Ni.call(this),this.$rs=!1};_i.prototype=Object.create(Ni.prototype),_i.prototype.constructor=_i,_i.prototype.gss=function(t,i){this.Wrs(t);var r=t.qts();if(0==r){var h=t.qts();return t.skip(12),t.skip(12*r),t.skip(24),t.skip(12*h),this.$rs=!0,!1}h=t.qts();var e=new Float32Array(3);e[0]=t.readFloat(),e[1]=t.readFloat(),e[2]=t.readFloat();var a=1/Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]),f=new Float32Array(3);f[0]=a*e[0],f[1]=a*e[1],f[2]=a*e[2];for(var o=!0,u=!0,c=new Float32Array(12*r),v=new Float32Array(12*r),l=new Uint32Array(12*(r-1)),w=0,b=0,d=0,A=0;A<r;A++)c[w++]=t.readFloat(),c[w++]=t.readFloat(),c[w++]=t.readFloat();var m=1/r,M=[0,0,0];for(A=0;A<r;A++)M[0]+=m*c[3*A],M[1]+=m*c[3*A+1],M[2]+=m*c[3*A+2];if(n){var y=[];y[0]=M[0],y[1]=M[1],y[2]=M[2],y[3]=M[0]+e[0],y[4]=M[1]+e[1],y[5]=M[2]+e[2],this.curveVertices=y,this.startNormal=[-f[0],-f[1],-f[2]],this.endNormal=[f[0],f[1],f[2]];var O=[c[0]-M[0],c[1]-M[1],c[2]-M[2]];this.radius=Math.sqrt(O[0]*O[0]+O[1]*O[1]+O[2]*O[2]),this.startSideVector=new Float32Array([O[0]/this.radius,O[1]/this.radius,O[2]/this.radius])}var p=new Float32Array(3);for(A=0;A<3;A++)p[A]=t.readFloat();var k=new Float32Array(3);for(A=0;A<3;A++)k[A]=t.readFloat();if(n)return h>0&&t.skip(3*h*4),!0;if(r>=3){var S=new s.Vector3(p[0],p[1],p[2]),g=new s.Vector3(k[0],k[1],k[2]);S.cross(g);var j=new s.Vector3(c[3]-c[0],c[4]-c[1],c[5]-c[2]),I=new s.Vector3(c[6]-c[0],c[7]-c[1],c[8]-c[2]);j.cross(I);var N=j.dot(S);N<0&&(o=!1),I.set(e[0],e[1],e[2]),(N=I.dot(S))<0&&(u=!1)}var x=!(o^u),T=2*Math.PI/r;if(o)for(A=0;A<r;A++){var R=Math.cos(A*T),E=Math.sin(A*T);v[b++]=R*p[0]+E*k[0],v[b++]=R*p[1]+E*k[1],v[b++]=R*p[2]+E*k[2]}else for(A=r;A>0;A--){R=Math.cos(A*T),E=Math.sin(A*T);v[b++]=R*p[0]+E*k[0],v[b++]=R*p[1]+E*k[1],v[b++]=R*p[2]+E*k[2]}for(A=0;A<r;A++)c[w++]=c[3*A]+e[0],c[w++]=c[3*A+1]+e[1],c[w++]=c[3*A+2]+e[2],v[b++]=v[3*A],v[b++]=v[3*A+1],v[b++]=v[3*A+2];if(x){for(A=0;A<r-1;A++)l[d++]=A,l[d++]=A+1,l[d++]=A+r,l[d++]=A+r,l[d++]=A+1,l[d++]=A+1+r;l[d++]=0,l[d++]=r,l[d++]=r-1,l[d++]=2*r-1,l[d++]=r-1,l[d++]=r}else{for(A=0;A<r-1;A++)l[d++]=A+r,l[d++]=A+1+r,l[d++]=A,l[d++]=A,l[d++]=A+1+r,l[d++]=A+1;l[d++]=r,l[d++]=0,l[d++]=2*r-1,l[d++]=r-1,l[d++]=2*r-1,l[d++]=0}var F=w/3;for(A=0;A<r;A++)v[b++]=-f[0],v[b++]=-f[1],v[b++]=-f[2],c[w++]=c[3*A],c[w++]=c[3*A+1],c[w++]=c[3*A+2];if(x)for(A=0;A<r-2;A++)l[d++]=F,l[d++]=F+r-1-A,l[d++]=F+r-2-A;else for(A=0;A<r-2;A++)l[d++]=F,l[d++]=F+r-2-A,l[d++]=F+r-1-A;for(F=w/3,A=0;A<r;A++)v[b++]=f[0],v[b++]=f[1],v[b++]=f[2],c[w++]=c[3*(A+r)],c[w++]=c[3*(A+r)+1],c[w++]=c[3*(A+r)+2];if(x)for(A=0;A<r-2;A++)l[d++]=F,l[d++]=F+r-2-A,l[d++]=F+r-1-A;else for(A=0;A<r-2;A++)l[d++]=F,l[d++]=F+r-1-A,l[d++]=F+r-2-A;return h>0&&t.skip(3*h*4),i?(i.posBuffer=c,i.Hss=v,this.indices=l):(this.vertexBuffer=new Wt,this.vertexBuffer.posBuffer=c,this.vertexBuffer.Hss=v,this.primitive=new mr,this.primitive.indices=l),!0},_i.prototype.skip=function(t){this.Wrs(t);var i=t.qts(),s=t.qts();t.skip(12),t.skip(12*i),t.skip(24),t.skip(12*s)};var Pi=function(){Ni.call(this)};Pi.prototype=Object.create(Ni.prototype),Pi.prototype.constructor=Pi,Pi.prototype.gss=function(t,i){var s=!0;this.Wrs(t);for(var r=t.qts(),h=new Float32Array(3*r),e=0;e<3*r;e++)h[e]=t.readFloat();var a=t.qts(),f=a*(r+2),o=new Float32Array(3*f);for(e=0;e<a*r*3;e++)o[e]=t.readFloat();var u=new Float32Array(3);for(e=0;e<3;e++)u[e]=t.readFloat();var c=new Float32Array(3);for(e=0;e<3;e++)c[e]=t.readFloat();var v=t.readFloat(),l=a*r*3,w=a*(r+1)*3,b=new Float32Array(3),d=3*a*(r-1);if(b[0]=v*(o[d]-h[3*(r-1)]),b[1]=v*(o[d+1]-h[3*(r-1)+1]),b[2]=v*(o[d+2]-h[3*(r-1)+2]),b[0]*b[0]+b[1]*b[1]+b[2]*b[2]<.01&&(s=!1),s&&n)o[w]=o[l-3],o[w+1]=o[l-2],o[w+2]=o[l-1];else{e=0;for(var A=3*a-3;e<3*a;e+=3,A-=3)o[l+e]=o[e],o[l+e+1]=o[e+1],o[l+e+2]=o[e+2],o[w+e]=o[l-3*a+A],o[w+e+1]=o[l-3*a+A+1],o[w+e+2]=o[l-3*a+A+2]}if(s&&n){this.curveVertices=h,this.startNormal=u,this.endNormal=c,this.radius=1/v;var m=new Float32Array(3);m[0]=v*(o[0]-h[0]),m[1]=v*(o[1]-h[1]),m[2]=v*(o[2]-h[2]),this.startSideVector=m;var M=new Float32Array(3);M[0]=v*(o[3]-h[0]),M[1]=v*(o[4]-h[1]),M[2]=v*(o[5]-h[2]),u[0]=m[1]*M[2]-m[2]*M[1],u[1]=m[2]*M[0]-m[0]*M[2],u[2]=m[0]*M[1]-m[1]*M[0];var y=new Float32Array(3);y[0]=v*(o[d+3]-h[3*(r-1)]),y[1]=v*(o[d+4]-h[3*(r-1)+1]),y[2]=v*(o[d+5]-h[3*(r-1)+2]),c[0]=-b[1]*y[2]+b[2]*y[1],c[1]=-b[2]*y[0]+b[0]*y[2],c[2]=-b[0]*y[1]+b[1]*y[0];var O=t.qts();return t.skip(3*O*4),!0}for(var p,k,S,g=new Float32Array(3*f),j=(e=0,A=a-1,0);e<a*r;e++,A--)p=(o[3*e]-h[3*j])*v,k=(o[3*e+1]-h[3*j+1])*v,S=(o[3*e+2]-h[3*j+2])*v,0==p&&0==k&&0==S?0==j?(g[3*e]=u[0],g[3*e+1]=u[1],g[3*e+2]=u[2]):(g[3*e]=c[0],g[3*e+1]=c[1],g[3*e+2]=c[2]):(g[3*e]=p,g[3*e+1]=k,g[3*e+2]=S),0==A&&(A=a,j++);for(e=0;e<3*a;e+=3)g[l+e]=u[0],g[l+e+1]=u[1],g[l+e+2]=u[2],g[w+e]=c[0],g[w+e+1]=c[1],g[w+e+2]=c[2];var I=0,N=new Uint32Array(6*(r-1)*a+6*(a-2));for(e=1;e<r;e++){for(A=0;A<a-1;A++)N[I++]=A+1+(e-1)*a,N[I++]=A+(e-1)*a,N[I++]=A+e*a,N[I++]=A+1+(e-1)*a,N[I++]=A+e*a,N[I++]=A+1+e*a;N[I++]=e*a,N[I++]=(e-1)*a,N[I++]=e*a-1,N[I++]=e*a-1,N[I++]=(1+e)*a-1,N[I++]=e*a}var x=a*r;for(e=0;e<a-2;e++)N[I++]=x,N[I++]=x+a-2-e,N[I++]=x+a-1-e;x=a*(r+1);for(e=0;e<a-2;e++)N[I++]=x,N[I++]=x+a-2-e,N[I++]=x+a-1-e;O=t.qts();return t.skip(3*O*4),i?(i.posBuffer=o,i.Hss=g,this.indices=N):(this.vertexBuffer=new Wt,this.vertexBuffer.posBuffer=o,this.vertexBuffer.Hss=g,this.primitive=new mr,this.primitive.indices=N),!1},Pi.prototype.skip=function(t){this.Wrs(t);var i=t.qts();t.skip(3*i*4);var s=t.qts();t.skip(3*s*i*4),t.skip(12),t.skip(12),t.skip(4);var r=t.qts();t.skip(3*r*4)};var Ui=function(){Ii.call(this),this.tns=!0,this.primitive=new mr,this.vertexBuffer=null};Ui.prototype=Object.create(Ii.prototype),Ui.prototype.constructor=Ui,Ui.prototype.gss=function(i){if(this.Vrs(i),i.iss()){this.vertexBuffer||(this.vertexBuffer=new Wt),this.primitive.symbol=i.qts();var s=this.vertexBuffer.posBuffer.length/3;this.primitive.start=this.primitive.indices.length,this.primitive.connectivity=t.ConnectivityTypeEnum.POINTS;var r=i.qts();this.primitive.count=r;for(var n=0;n<r;n++)this.vertexBuffer.posBuffer.push(i.readFloat()),this.vertexBuffer.posBuffer.push(i.readFloat()),this.vertexBuffer.posBuffer.push(i.readFloat()),this.primitive.indices.push(s++)}};var Di=function(){Ii.call(this),this.tns=!0};Di.prototype=Object.create(Ii.prototype),Di.prototype.constructor=Di,Di.prototype.gss=function(t){this.Vrs(t);var i,s=t.readFloat(),r=t.readFloat(),n=t.readFloat(),h=t.readFloat(),e=t.readFloat(),a=t.readFloat();t.qts(),t.qts();if(t.version<210042210){if((i=t.qts())>0)t.Wts()}else(i=t.Tis())>0&&t.skip(2*i);this.primitive={origin:[s,r,n],direction:[h,e,a]}};var Ci=function(){Ii.call(this),this.tns=!0};Ci.prototype=Object.create(Ii.prototype),Ci.prototype.constructor=Ci,Ci.prototype.gss=function(t){if(this.Vrs(t),t.iss()){var i=t.readFloat(),s=t.readFloat(),r=t.readFloat(),n=t.readFloat(),h=t.readFloat(),e=t.readFloat(),a=t.readFloat(),f=t.readFloat(),o=t.readFloat(),u=t.readFloat(),c=0;t.version>=1100910&&(c=t.tis()),this.primitive={origin:[i,s,r],direction1:[n,h,e],direction2:[a,f,o],length:u,mode:c}}};var Gi=function(){Ii.call(this),this.tns=!0};(Gi.prototype=Object.create(Ii.prototype)).constructor=Gi,Gi.prototype.ins=function(t){var i={},r=t[0];return 0==r>>3&&(i.sns=!!(4&r),i.rns=!!(2&r),i.nns=!!(1&r),i.hns=new s.Color(t[1],t[2],t[3]),i.ens=new s.Color(t[4],t[5],t[6]),i.HEi=t[7]),i},Gi.prototype.gss=function(t){if(this.Vrs(t),t.iss()){var i=!1;1==t.tis()&&(i=!0);var s=t.readFloat(),r=t.readFloat(),n=t.readFloat(),h=t.readFloat(),e=t.readFloat(),a=t.readFloat(),f=t.readFloat(),o=t.readFloat(),u=t.readFloat(),c=t.readFloat(),v=t.readFloat(),l=t.ass(),w="";if(l){for(var b=[],d=0;d<l;d++)b.push(String.fromCharCode(t.Zts()));w=b.join("")}if(t.version>=210042460){var A=t.kis();A&&t.pis(A,[]),t.version>=210042510&&t.dis()}this.primitive={label:w,origin:[s,r,n],direction1:[h,e,a],direction2:[o,u,c],lengthX:f,lengthY:v,ans:null,mode:i}}};var Li=function(){Ii.call(this),this.tns=!0};Li.prototype=Object.create(Ii.prototype),Li.prototype.constructor=Li,Li.prototype.gss=function(t){this.Vrs(t);t.readFloat(),t.readFloat(),t.readFloat(),t.readFloat(),t.qts(),t.qts();var i=t.qts();if(i)t.UAt(i)};var Vi=function(){Ii.call(this),this.tns=!0};Vi.prototype=Object.create(Ii.prototype),Vi.prototype.constructor=Vi,Vi.prototype.gss=function(t){this.Vrs(t);var i=t.readFloat(),s=t.readFloat(),r=t.readFloat(),n=t.readFloat(),h=t.readFloat(),e=t.readFloat();t.qts(),t.qts();if(t.qts())t.Wts();this.primitive={origin:[i,s,r],direction:[n,h,e]}};var Bi=function(){Ii.call(this),this.tns=!0};Bi.prototype=Object.create(Ii.prototype),Bi.prototype.constructor=Bi,Bi.prototype.gss=function(t){this.Vrs(t),t.skip(16),t.qts(),t.skip(36)};var zi=function(){Ii.call(this),this.tns=!0};zi.prototype=Object.create(Ii.prototype),zi.prototype.constructor=zi,zi.prototype.gss=function(t){this.Vrs(t),t.readFloat(),t.readFloat(),t.readFloat(),t.readFloat(),t.qts(),t.readFloat(),t.readFloat(),t.readFloat(),t.readFloat(),t.readFloat(),t.readFloat(),t.readFloat(),t.readFloat(),t.readFloat()};var Hi=function(){Ii.call(this),this.vertexBuffer=null,this.primitive=new mr,this.point=[],this.Lrs=0,this.fns=!0,this.tns=!0};Hi.prototype=Object.create(Ii.prototype),Hi.prototype.constructor=Hi,Hi.prototype.gss=function(i){this.Vrs(i);if(i.tis()){var s=(new Ut).gss(i);this.point.push(i.readFloat()),this.point.push(i.readFloat()),this.point.push(i.readFloat());i.qts(),i.qts(),i.qts();if(null==s)return!1;var r=i.textures.add(s),n=s.width,h=s.height;this.vertexBuffer||(this.vertexBuffer=new Wt),this.primitive.start=this.primitive.indices.length;var e=this.vertexBuffer.posBuffer.length/3;this.vertexBuffer.posBuffer.push(0),this.vertexBuffer.posBuffer.push(0),this.vertexBuffer.posBuffer.push(0),this.vertexBuffer.Hss.push(0),this.vertexBuffer.Hss.push(0),this.vertexBuffer.Hss.push(1),this.vertexBuffer.posBuffer.push(n),this.vertexBuffer.posBuffer.push(0),this.vertexBuffer.posBuffer.push(0),this.vertexBuffer.Hss.push(0),this.vertexBuffer.Hss.push(0),this.vertexBuffer.Hss.push(1),this.vertexBuffer.posBuffer.push(n),this.vertexBuffer.posBuffer.push(h),this.vertexBuffer.posBuffer.push(0),this.vertexBuffer.Hss.push(0),this.vertexBuffer.Hss.push(0),this.vertexBuffer.Hss.push(1),this.vertexBuffer.posBuffer.push(0),this.vertexBuffer.posBuffer.push(h),this.vertexBuffer.posBuffer.push(0),this.vertexBuffer.Hss.push(0),this.vertexBuffer.Hss.push(0),this.vertexBuffer.Hss.push(1),this.primitive.connectivity=t.ConnectivityTypeEnum.TRIANGLES,this.primitive.count=6,this.primitive.indices.push(e),this.primitive.indices.push(e+1),this.primitive.indices.push(e+2),this.primitive.indices.push(e+2),this.primitive.indices.push(e+3),this.primitive.indices.push(e+0),this.vertexBuffer.qss=!0,this.vertexBuffer.Yss.push(0),this.vertexBuffer.Yss.push(0),this.vertexBuffer.Yss.push(0),this.vertexBuffer.Yss.push(1),this.vertexBuffer.Yss.push(0),this.vertexBuffer.Yss.push(0),this.vertexBuffer.Yss.push(1),this.vertexBuffer.Yss.push(1),this.vertexBuffer.Yss.push(0),this.vertexBuffer.Yss.push(0),this.vertexBuffer.Yss.push(1),this.vertexBuffer.Yss.push(0);var a={textureId:r,shading:"Basic",ors:!0,useAsGas:!0},f={file:"",id:i.materials.add(a)};return this.primitive.material=f,!0}return!1};var Yi=1,Xi=2,Ji=14,Wi=15,qi=16,Ki=17,Zi=18,Qi=19,$i=20,ts=21,is=22,ss=23,rs=24,ns=25,hs=26,es=27,as=28,fs=29,os=30,us=31,cs=32,vs=function(){Ii.call(this),this.vertexBuffer=null,this.primitive=new mr};vs.prototype=Object.create(Ii.prototype),vs.prototype.constructor=vs,vs.prototype.lineType=null,vs.prototype.gss=function(i){this.Vrs(i);var s=i.tis(),r=[];i.readFloatArray(0,4,r),this.vertexBuffer||(this.vertexBuffer=new Wt),this.primitive.start=this.primitive.indices.length;var n=this.vertexBuffer.posBuffer.length/3;return this.vertexBuffer.posBuffer.push(r[0]),this.vertexBuffer.posBuffer.push(r[1]),this.vertexBuffer.posBuffer.push(0),this.vertexBuffer.posBuffer.push(r[2]),this.vertexBuffer.posBuffer.push(r[1]),this.vertexBuffer.posBuffer.push(0),this.vertexBuffer.posBuffer.push(r[2]),this.vertexBuffer.posBuffer.push(r[3]),this.vertexBuffer.posBuffer.push(0),this.vertexBuffer.posBuffer.push(r[0]),this.vertexBuffer.posBuffer.push(r[3]),this.vertexBuffer.posBuffer.push(0),s?(this.primitive.connectivity=t.ConnectivityTypeEnum.TRIANGLES,this.primitive.count=6,this.primitive.indices.push(n),this.primitive.indices.push(n+1),this.primitive.indices.push(n+2),this.primitive.indices.push(n+2),this.primitive.indices.push(n+3),this.primitive.indices.push(n+0),this.vertexBuffer.Hss.push(0),this.vertexBuffer.Hss.push(0),this.vertexBuffer.Hss.push(1),this.vertexBuffer.Hss.push(0),this.vertexBuffer.Hss.push(0),this.vertexBuffer.Hss.push(1),this.vertexBuffer.Hss.push(0),this.vertexBuffer.Hss.push(0),this.vertexBuffer.Hss.push(1),this.vertexBuffer.Hss.push(0),this.vertexBuffer.Hss.push(0),this.vertexBuffer.Hss.push(1)):(this.primitive.connectivity=t.ConnectivityTypeEnum.LINES,this.primitive.count=8,this.primitive.indices.push(n),this.primitive.indices.push(n+1),this.primitive.indices.push(n+1),this.primitive.indices.push(n+2),this.primitive.indices.push(n+2),this.primitive.indices.push(n+3),this.primitive.indices.push(n+3),this.primitive.indices.push(n+0)),!0};var ls=function(){Ii.call(this),this.vertexBuffer=null,this.primitive=new mr,this.primitives=[]};ls.prototype=Object.create(Ii.prototype),ls.prototype.constructor=ls,ls.prototype.lineType=null,ls.prototype.gss=function(t){if(this.Vrs(t),t.version>1101410){t.qts();var i=[];t.readFloatArray(0,2,i);var r=t.readFloat(),n=t.qts()}var h=[];t.readFloatArray(0,2,h);var e=new s.Vector2(h[0],h[1]);e.normalize();var a=t.readFloat(),f=r*Math.tan(a);this.vertexBuffer||(this.vertexBuffer=new Wt);var o=this.vertexBuffer.posBuffer.length/3;switch(n!==us&&(this.vertexBuffer.posBuffer.push(i[0]-e.x*r+e.y*f),this.vertexBuffer.posBuffer.push(i[1]-e.y*r-e.x*f),this.vertexBuffer.posBuffer.push(0),this.vertexBuffer.posBuffer.push(i[0]),this.vertexBuffer.posBuffer.push(i[1]),this.vertexBuffer.posBuffer.push(0),this.vertexBuffer.posBuffer.push(i[0]-e.x*r-e.y*f),this.vertexBuffer.posBuffer.push(i[1]-e.y*r+e.x*f),this.vertexBuffer.posBuffer.push(0)),n){case Ji:var u=new mr;this.Hrs(o,u,3,1),this.primitive=u;break;case Wi:(u=new mr).count=0;var c=[0,1,2];this.Yrs(0,u,c,c.length,0,!1),this.primitive=u;break;case qi:case Ki:(u=new mr).count=0;c=[0,1,2];this.Yrs(0,u,c,c.length,0,!0),this.primitive=u;break;case os:u=new mr;this.Hrs(o,u,3,1);o=this.vertexBuffer.posBuffer.length/3;this.vertexBuffer.posBuffer.push(i[0]-r*e.x-e.x*r+e.y*f),this.vertexBuffer.posBuffer.push(i[1]-r*e.y-e.y*r-e.x*f),this.vertexBuffer.posBuffer.push(0),this.vertexBuffer.posBuffer.push(i[0]-r*e.x),this.vertexBuffer.posBuffer.push(i[1]-r*e.y),this.vertexBuffer.posBuffer.push(0),this.vertexBuffer.posBuffer.push(i[0]-r*e.x-e.x*r-e.y*f),this.vertexBuffer.posBuffer.push(i[1]-r*e.y-e.y*r+e.x*f),this.vertexBuffer.posBuffer.push(0),this.Hrs(o,u,3,1),this.primitive=u;break;case cs:(u=new mr).count=0;c=[0,1,2];this.Yrs(0,u,c,c.length,0,!0);o=this.vertexBuffer.posBuffer.length/3;this.vertexBuffer.posBuffer.push(i[0]-r*e.x-e.x*r+e.y*f),this.vertexBuffer.posBuffer.push(i[1]-r*e.y-e.y*r-e.x*f),this.vertexBuffer.posBuffer.push(0),this.vertexBuffer.posBuffer.push(i[0]-r*e.x),this.vertexBuffer.posBuffer.push(i[1]-r*e.y),this.vertexBuffer.posBuffer.push(0),this.vertexBuffer.posBuffer.push(i[0]-r*e.x-e.x*r-e.y*f),this.vertexBuffer.posBuffer.push(i[1]-r*e.y-e.y*r+e.x*f),this.vertexBuffer.posBuffer.push(0);c=[3,5,4];this.Yrs(0,u,c,c.length,0,!0),this.primitive=u;break;case us:a=Math.acos(-e.y);a=Math.asin(e.x)<0?-a:a;var v=.5*r,l=17;if(bn){var w=bn,b=Math.PI,d=400;if(v*Math.PI*2<bn);else{w>v&&(w=v);var A=Math.acos(1-w/v);d=0==A?400:Math.PI/A+.5}l=Math.floor(b*d*(1/(2*Math.PI))+2.5)}var m=i[0]+v*e.y,M=i[1]-v*e.x,y=new mr;this.zrs(this.vertexBuffer,y,m,M,v,a,a+Math.PI,l,!1);m=i[0]-v*e.y,M=i[1]+v*e.x;this.zrs(this.vertexBuffer,y,m,M,v,a+Math.PI,a,l,!1),this.primitive=y;break;default:y=new mr;this.zrs(this.vertexBuffer,y,i[0],i[1],r/2,0,2*Math.PI,17,!0),this.primitive=y}return!0};var ws=function(){Ii.call(this),this.vertexBuffer=null,this.primitive=new mr,this.primitives=[]};ws.prototype=Object.create(Ii.prototype),ws.prototype.constructor=ws,ws.prototype.lineType=null,ws.prototype.gss=function(t){this.Vrs(t);t.qts();var i=[];t.readFloatArray(0,2,i);var s=t.readFloat(),r=17;if(bn){var n=s/2,h=bn,e=2*Math.PI,a=400;if(n*Math.PI*2<bn);else{h>n&&(h=n);var f=Math.acos(1-h/n);a=0==f?400:Math.PI/f+.5}r=Math.floor(e*a*(1/(2*Math.PI))+2.5)}var o=t.qts();this.vertexBuffer||(this.vertexBuffer=new Wt);var u=this.vertexBuffer.posBuffer.length/3;switch(o){case Zi:var c=new mr;this.zrs(this.vertexBuffer,c,i[0],i[1],s/2,0,2*Math.PI,r,!1),this.primitive=c;break;case Qi:case as:c=new mr;this.zrs(this.vertexBuffer,c,i[0],i[1],s/2,0,2*Math.PI,r,!1),this.primitive=c;break;case $i:c=new mr;this.zrs(this.vertexBuffer,c,i[0],i[1],s/2,0,2*Math.PI,r,!0),this.primitive=c;break;case ts:c=new mr;this.zrs(this.vertexBuffer,c,i[0],i[1],s/2,0,2*Math.PI,r,!0);var v=t.materials.add({backgoundColor:!0});c.material={file:"",id:v},this.primitives.push(c);var l=new mr;this.zrs(this.vertexBuffer,l,i[0],i[1],s/2,0,2*Math.PI,r,!1);var w=(m=s/2)*Math.cos(Math.PI/4),b=m*Math.sin(Math.PI/4),d=m*Math.cos(5*Math.PI/4),A=m*Math.sin(5*Math.PI/4);u=this.vertexBuffer.posBuffer.length/3;this.vertexBuffer.posBuffer.push(i[0]+w),this.vertexBuffer.posBuffer.push(i[1]+b),this.vertexBuffer.posBuffer.push(0),this.vertexBuffer.posBuffer.push(i[0]+d),this.vertexBuffer.posBuffer.push(i[1]+A),this.vertexBuffer.posBuffer.push(0),this.vertexBuffer.posBuffer.push(i[0]-w),this.vertexBuffer.posBuffer.push(i[1]-A),this.vertexBuffer.posBuffer.push(0),this.vertexBuffer.posBuffer.push(i[0]-d),this.vertexBuffer.posBuffer.push(i[1]-b),this.vertexBuffer.posBuffer.push(0),this.Hrs(u,l,4,0),this.primitives.push(l);break;case is:case ss:case hs:case es:var m=s/2;this.vertexBuffer.posBuffer.push(i[0]-m),this.vertexBuffer.posBuffer.push(i[1]-m),this.vertexBuffer.posBuffer.push(0),this.vertexBuffer.posBuffer.push(i[0]-m),this.vertexBuffer.posBuffer.push(i[1]+m),this.vertexBuffer.posBuffer.push(0),this.vertexBuffer.posBuffer.push(i[0]+m),this.vertexBuffer.posBuffer.push(i[1]+m),this.vertexBuffer.posBuffer.push(0),this.vertexBuffer.posBuffer.push(i[0]+m),this.vertexBuffer.posBuffer.push(i[1]-m),this.vertexBuffer.posBuffer.push(0);var M=new mr;M.count=0;var y=[0,1,2,0,2,3];this.Yrs(0,M,y,y.length,0,!0),this.primitive=M;break;case rs:case ns:case fs:m=s/2;this.vertexBuffer.posBuffer.push(i[0]),this.vertexBuffer.posBuffer.push(i[1]+m),this.vertexBuffer.posBuffer.push(0),this.vertexBuffer.posBuffer.push(i[0]-m),this.vertexBuffer.posBuffer.push(i[1]-m),this.vertexBuffer.posBuffer.push(0),this.vertexBuffer.posBuffer.push(i[0]+m),this.vertexBuffer.posBuffer.push(i[1]-m),this.vertexBuffer.posBuffer.push(0);var O=new mr;O.count=0;y=[0,1,2];this.Yrs(0,O,y,y.length,0,!0),this.primitive=O;break;case Yi:case Xi:var p=.5*s,k=1,S=0;o==Yi&&(S=-(k=Math.PI/4)),k*=p,S*=p,this.vertexBuffer.posBuffer.push(i[0]+k),this.vertexBuffer.posBuffer.push(i[1]+S),this.vertexBuffer.posBuffer.push(0),this.vertexBuffer.posBuffer.push(i[0]-k),this.vertexBuffer.posBuffer.push(i[1]-S),this.vertexBuffer.posBuffer.push(0),this.vertexBuffer.posBuffer.push(i[0]-S),this.vertexBuffer.posBuffer.push(i[1]+k),this.vertexBuffer.posBuffer.push(0),this.vertexBuffer.posBuffer.push(i[0]+S),this.vertexBuffer.posBuffer.push(i[1]-k),this.vertexBuffer.posBuffer.push(0);var g=new mr;this.Hrs(u,g,4,0),this.primitive=g;break;default:c=new mr;this.zrs(this.vertexBuffer,c,i[0],i[1],s/2,0,2*Math.PI,r,!0),this.primitive=c}return!0};var bs=function(){Ii.call(this),this.vertexBuffer=null,this.primitive=new mr,this.point=[],this.Lrs=2,this.fns=!0};bs.prototype=Object.create(Ii.prototype),bs.prototype.constructor=bs,bs.prototype.lineType=null,bs.prototype.gss=function(i){this.Vrs(i),i.readFloatArray(0,2,this.point),this.point.push(0);i.qts(),i.qts(),i.qts(),i.qts();this.Lrs=i.qts();var s=null;i.Ais()&&(s=(new Ut).gss(i));if(null==s)return!1;var r=i.textures.add(s),n=s.width*s.Nss,h=s.height*s.Tss;0==this.Lrs&&(n=s.width,h=s.height),this.vertexBuffer||(this.vertexBuffer=new Wt),this.primitive.start=this.primitive.indices.length;var e=this.vertexBuffer.posBuffer.length/3;this.vertexBuffer.posBuffer.push(this.point[0]),this.vertexBuffer.posBuffer.push(this.point[1]),this.vertexBuffer.posBuffer.push(0),this.vertexBuffer.posBuffer.push(this.point[0]+n),this.vertexBuffer.posBuffer.push(this.point[1]),this.vertexBuffer.posBuffer.push(0),this.vertexBuffer.posBuffer.push(this.point[0]+n),this.vertexBuffer.posBuffer.push(this.point[1]+h),this.vertexBuffer.posBuffer.push(0),this.vertexBuffer.posBuffer.push(this.point[0]),this.vertexBuffer.posBuffer.push(this.point[1]+h),this.vertexBuffer.posBuffer.push(0),this.primitive.connectivity=t.ConnectivityTypeEnum.TRIANGLES,this.primitive.count=6,this.primitive.indices.push(e),this.primitive.indices.push(e+1),this.primitive.indices.push(e+2),this.primitive.indices.push(e+2),this.primitive.indices.push(e+3),this.primitive.indices.push(e+0),this.vertexBuffer.Yss.push(0),this.vertexBuffer.Yss.push(0),this.vertexBuffer.Yss.push(0),this.vertexBuffer.Yss.push(1),this.vertexBuffer.Yss.push(0),this.vertexBuffer.Yss.push(0),this.vertexBuffer.Yss.push(1),this.vertexBuffer.Yss.push(1),this.vertexBuffer.Yss.push(0),this.vertexBuffer.Yss.push(0),this.vertexBuffer.Yss.push(1),this.vertexBuffer.Yss.push(0);var a={textureId:r,shading:"Basic",ors:!0,useAsGas:!0},f={file:"",id:i.materials.add(a)};return this.primitive.material=f,!0};var ds=function(){Ii.call(this),this.vertexBuffer=null,this.primitives=[],this.primitive=new mr};ds.prototype=Object.create(Ii.prototype),ds.prototype.constructor=ds,ds.prototype.lineType=null,ds.prototype.gss=function(t){return this.skip(t),!1},ds.prototype.skip=function(t){this.Vrs(t);t.readFloatArray(0,2,[]),t.readFloatArray(0,2,[]);t.readFloat(),t.readFloat(),t.readFloat(),t.qts();t.readFloatArray(0,10,[]),t.readFloatArray(0,2,[]);t.Wts()};var As=function(){Ii.call(this),this.vertexBuffer=null,this.primitive=new mr,this.text=null};As.prototype=Object.create(Ii.prototype),As.prototype.constructor=As,As.prototype.lineType=null,As.prototype.gss=function(t){this.Vrs(t);var i=[];t.readFloatArray(0,2,i);var s=t.readFloat();t.qts(),t.qts();t.Ais()&&t.sis(),t.Ais()&&t.sis();var r=t.qts();if(r>0){var n="",h=[];t.Iis(r,h);for(var e=0;e<r;e++)n+=String.fromCharCode(h[e])}return this.text={text:n,anchor:{x:i[0],y:i[1]},height:s},!1};var ms=function(){Ii.call(this),this.vertexBuffer=null,this.primitive=new mr,this.nodes=[]};ms.prototype=Object.create(Ii.prototype),ms.prototype.constructor=ms,ms.prototype.lineType=null,ms.prototype.gss=function(i){this.Vrs(i);var s=i.qts(),r=i.qts(),n=i.qts(),h=i.qts(),e=i.qts(),a=i.readFloat(),f=i.readFloat(),o=i.readFloat(),u=[];if(s>0&&r>0){var c=[],v=[];i.readFloatArray(0,2*r,c),i.readFloatArray(0,s,this.nodes),i.readFloatArray(0,r,v)}if(n>0){i.readFloatArray(0,2*n,[])}this.vertexBuffer||(this.vertexBuffer=new Wt),this.primitive.start=this.primitive.indices.length;var l=this.vertexBuffer.posBuffer.length/3;if(this.primitive.connectivity=t.ConnectivityTypeEnum.LINES,h){i.readFloatArray(0,2*h,u);for(var w=0;w<h;w++)this.primitive.indices.push(l++),this.vertexBuffer.posBuffer.push(u[2*w]),this.vertexBuffer.posBuffer.push(u[2*w+1]),this.vertexBuffer.posBuffer.push(0),this.primitive.indices.push(l);return this.primitive.count=2*h-2,!0}var b=f-a;if(0==b)return!1;var d=Math.PI/Math.acos(1-.01/o)*.5+.5;d>100&&(d=100);var A,m,M,y=d+1,O=b/d;M=a;for(var p=!0,k=0;k<d+1;k++){var S,g,j,I;S=0,g=0,j=0,I=0;var N=0;for(w=0;w<r;w++)S+=(I=Math.abs(M-f)<=1e-5&&w==r-1?1:this.ons(w,e,M,1))*c[N]*v[w],g+=I*c[N+1]*v[w],j+=I*v[w],N+=2;j<=1e-15?y--:(A=S/j,m=g/j,this.vertexBuffer.posBuffer.push(A),this.vertexBuffer.posBuffer.push(m),this.vertexBuffer.posBuffer.push(0),p||(this.primitive.indices.push(l++),this.primitive.indices.push(l)),p=!1),M=a+(k+1)*O}return y>0&&(this.primitive.count=2*y-2,!0)},ms.prototype.ons=function(t,i,s,r){var n=0;if(1==i)n=s>=this.nodes[t]&&s<this.nodes[t+1]?1:0;else if(s<this.nodes[t]||s>=this.nodes[t+i])n=0;else{var h=this.ons(t,i-1,s,r),e=this.ons(t+1,i-1,s,r),a=1e-6*r;n=(Math.abs(this.nodes[t]-this.nodes[t+i-1])<=a?0:(s-this.nodes[t])/(this.nodes[t+i-1]-this.nodes[t]))*h+(Math.abs(this.nodes[t+1]-this.nodes[t+i])<=a?0:(this.nodes[t+i]-s)/(this.nodes[t+i]-this.nodes[t+1]))*e}return n};var Ms=function(){Ii.call(this),this.vertexBuffer=null,this.primitive=new mr};Ms.prototype=Object.create(Ii.prototype),Ms.prototype.constructor=Ms,Ms.prototype.lineType=null,Ms.prototype.gss=function(i){this.Vrs(i);var s=i.qts(),r=[];if(s>0){i.readFloatArray(0,2*s,r),this.vertexBuffer||(this.vertexBuffer=new Wt),this.primitive.start=this.primitive.indices.length;var n=this.vertexBuffer.posBuffer.length/3;if(this.primitive.connectivity=t.ConnectivityTypeEnum.LINES,s<4)return!1;var h,e,a,f,o,u,c,v,l,w,b,d,A,m,M=(s-1)%3,y=s-M,O=0;h=r[0],e=r[1];for(var p=2,k=0;k<y-1;k+=3){l=(c=r[p+4])-h+3*(a=r[p])-3*(o=r[p+2]),w=(v=r[p+5])-e+3*(f=r[p+1])-3*(u=r[p+3]),b=3*(o-2*a+h),d=3*(u-2*f+e),A=3*(a-h),m=3*(f-e);var S=Math.sqrt((h-c)*(h-c)+(e-v)*(e-v))/2;O=.01;var g=0;if(S>0&&O>=0&&O<=2*S){var j=Math.acos(1-O/S);j>0&&(g=Math.floor(Math.PI/j*.5+.5))}g<=0&&(g=1),g>100&&(g=100);var I,N,x,T=g+1,R=1/g;I=h,N=e,this.vertexBuffer.posBuffer.push(I),this.vertexBuffer.posBuffer.push(N),this.vertexBuffer.posBuffer.push(0),x=R;for(var E=0;E<g;E++)I=l*Math.pow(x,3)+b*Math.pow(x,2)+A*x+h,N=w*Math.pow(x,3)+d*Math.pow(x,2)+m*x+e,this.vertexBuffer.posBuffer.push(I),this.vertexBuffer.posBuffer.push(N),this.vertexBuffer.posBuffer.push(0),this.primitive.indices.push(n++),this.primitive.indices.push(n),x+=R;this.primitive.count=2*T-2,h=c,e=v,p+=6}if(M>0)for(k=0;k<M+1;k++)this.vertexBuffer.posBuffer.push(r[2*(y-1+k)]),this.vertexBuffer.posBuffer.push(r[2*(y-1+k)+1]),this.primitive.indices.push(n++),this.primitive.indices.push(n);return this.primitive.count+=2*(M+1),!0}return!1};var ys=function(){Ii.call(this),this.vertexBuffer=null,this.primitive=new mr,this.primitives=[]};ys.prototype=Object.create(Ii.prototype),ys.prototype.constructor=ys,ys.prototype.lineType=null,ys.prototype.gss=function(i){this.Vrs(i);var s=i.qts(),r=[],n=0;i.fss(s,r);for(var h=0;h<s;++h)n+=r[h];var e=0;e=i.version<1101840||i.version>=21e5&&i.version<2100130?n:i.qts();var a=[];i.readFloatArray(0,2*e,a),this.vertexBuffer||(this.vertexBuffer=new Wt);var f=this.vertexBuffer.posBuffer.length/3;for(h=0;h<e;h++)this.vertexBuffer.posBuffer.push(a[2*h]),this.vertexBuffer.posBuffer.push(a[2*h+1]),this.vertexBuffer.posBuffer.push(0);if(i.qts()){var o=new mr;o.cgmId=this.primitive.cgmId,o.start=o.indices.length,o.connectivity=t.ConnectivityTypeEnum.TRIANGLES;var u=i.qts(),c=[],v=[],l=0,w=[];i.fss(u,c),i.fss(u,v);for(h=0;h<u;++h)l+=c[h];i.fss(l,w),o.count=0;var b=0;for(h=0;h<u;++h)switch(v[h]){case 0:case 4:o.count+=c[h];for(var d=0;d<c[h];++d)o.indices.push(w[b++]-1);break;case 1:case 5:o.count+=3*(c[h]-2);var A=0;for(d=0;d<c[h]-2;d++)o.indices.push(w[b]-1),o.indices.push(w[b+1+A]-1),o.indices.push(w[b+2-A]-1),b++,A=1-A;b+=2;break;case 2:case 6:o.count+=3*(c[h]-2);var m=w[b]-1;for(d=0;d<c[h]-2;d++)o.indices.push(m),o.indices.push(w[b+2]-1),o.indices.push(w[b+1]-1),b++;b+=2;break;default:return null}return this.primitives.push(o),!0}var M=new mr;M.cgmId=this.primitive.cgmId,M.start=M.indices.length,M.connectivity=t.ConnectivityTypeEnum.LINES,M.count=2*e-2;for(m=f,h=1;h<e;h++)M.indices.push(f++),M.indices.push(f);return M.indices.push(f),M.indices.push(m),this.primitives.push(M),!0};var Os=function(){Ii.call(this),this.vertexBuffer=null,this.primitive=new mr,this.text=null,this.tns=!0};Os.prototype=Object.create(Ii.prototype),Os.prototype.constructor=Os,Os.prototype.lineType=null,Os.prototype.gss=function(t){var i=t.qts(),s=[];t.pis(i,s);for(var r="",n=0;n<s.length;n++)r+=String.fromCharCode(s[n]);var h=r.substring(r.length-5,r.length),e=!0;".font"!==h&&".FONT"!==h||(e=!1);var a=t.qts(),o="";for(n=0;n<a;n++)o+=String.fromCharCode(t.Zts());t.Zts();t.readFloat(),t.readFloat(),t.readFloat(),t.readFloat();var u=t.ess();t.readFloatArray(0,4,[]);var c=t.readFloat(),v=t.ess();t.ess();t.readFloatArray(0,2,[]);t.readFloat(),t.readFloat(),t.readFloat(),t.readFloat(),t.readFloat();var l=t.ess();if(t.version>=2100020||t.version>=1101600&&t.version<21e5)t.qts();if(t.version>=2100070||t.version>=1101730&&t.version<21e5)t.qts();t.qts(),t.qts();var w=[t.readFloat(),t.readFloat(),t.readFloat(),t.readFloat()];if(t.version>=1101330)t.readFloat();var b=[];if(t.readFloatArray(0,22,b),e&&(t.readFloat(),t.readFloat(),t.readFloat(),t.readFloat(),t.readFloat(),t.readFloat(),t.readFloat()),f&&a){var d=t.Dis(),A=t.nss();this.text={text:o,sYi:d,bbox:w,uns:u,cns:l,matrix:A,fontName:r,color:null,stroke:!1,path:v,bold:!1,italic:!1,width:b[21],orientationAngle:c}}};var ps=function(){Ii.call(this),this.vertexBuffer=null,this.primitive=new mr};(ps.prototype=Object.create(Ii.prototype)).constructor=ps,ps.prototype.lineType=null,ps.prototype.gss=function(t){var i=ks.prototype.gss.call(this,t),s=t.qts();if(s>0){t.fss(s,[])}return i};var ks=function(){Ii.call(this),this.vertexBuffer=null,this.primitive=new mr};ks.prototype=Object.create(Ii.prototype),ks.prototype.constructor=ks,ks.prototype.lineType=null,ks.prototype.gss=function(i){this.Vrs(i);var s=i.tis();if(i.version>=1101900&&i.version<21e5||i.version>=2100170){if(0==i.qts())return i.qts(),i.qts(),!1;var r=[];if((w=i.qts())>0){var n=[];i.readFloatArray(0,2*w,r)}var h=i.qts();this.vertexBuffer||(this.vertexBuffer=new Wt),this.primitive.start=this.primitive.indices.length;for(var e=this.vertexBuffer.posBuffer.length/3,a=0;a<w;++a)this.vertexBuffer.posBuffer.push(r[2*a]),this.vertexBuffer.posBuffer.push(r[2*a+1]),this.vertexBuffer.posBuffer.push(0);if(h>0){if(4!=s&&3!=s||!o)for(a=0;a<w;++a)this.vertexBuffer.Hss.push(0),this.vertexBuffer.Hss.push(0),this.vertexBuffer.Hss.push(1);else for(var a=0;a<w;++a)this.vertexBuffer.Hss.push(0),this.vertexBuffer.Hss.push(0),this.vertexBuffer.Hss.push(0);var f=[],u=[];for(a=0;a<h;++a)f[a]=i.ris();for(a=0;a<h;++a)u[a]=i.ris();var c=0;for(a=0;a<h;a++)c+=u[a];var v=[];for(a=0;a<c;++a)v[a]=i.ris()-1;this.primitive.count=0;var l=e;for(a=0;a<h;++a)l=this.Yrs(l,this.primitive,v,u[a],f[a],!0)}else this.Yrs(e,this.primitive,void 0,w,void 0,!1);return 4!=s&&3!=s||!!o&&2}this.vertexBuffer||(this.vertexBuffer=new Wt),this.primitive.connectivity=t.ConnectivityTypeEnum.TRIANGLES,this.primitive.start=this.primitive.indices.length;var w;e=this.vertexBuffer.posBuffer.length/3;if((w=i.qts())>0){n=[];i.readFloatArray(0,2*w,n)}if(1==s){if((h=i.qts())>0){for(f=[],u=[],a=0;a<h;++a)f[a]=i.ris();for(a=0;a<h;++a)u[a]=i.ris(),0!==f[a]&&4!==f[a]||u[a]/3,1!==f[a]&&5!==f[a]||u[a]-2,2!==f[a]&&6!==f[a]||u[a]-2;var b=0;for(a=0;a<h;a++)b+=u[a];var d=[];for(a=0;a<b;++a)d[a]=i.ris();var A=0;for(a=0;a<h;++a){if(0===f[a]||4===f[a]){b=u[a];for(var m=0;m<b;++m)this.primitive.indices.push(d[A++]-1+e)}if(1===f[a]||5===f[a]){var M=u[a];for(m=2;m<M;++m)m%2?(this.primitive.indices.push(d[A+m]-1+e),this.primitive.indices.push(d[A+m-1]-1+e),this.primitive.indices.push(d[A+m-2]-1+e)):(this.primitive.indices.push(d[A+m-1]-1+e),this.primitive.indices.push(d[A+m]-1+e),this.primitive.indices.push(d[A+m-2]-1+e));A+=M}if(2===f[a]||6===f[a]){var y=u[a];for(m=2;m<y;++m)this.primitive.indices.push(d[A]-1+e),this.primitive.indices.push(d[A+m-1]-1+e),this.primitive.indices.push(d[A+m]-1+e);A+=y}}this.primitive.count=this.primitive.indices.length}for(a=0;a<w;++a)this.vertexBuffer.posBuffer.push(n[2*a]),this.vertexBuffer.posBuffer.push(n[2*a+1]),this.vertexBuffer.posBuffer.push(0)}return 4!=s&&3!=s};var Ss=function(){Ii.call(this),this.primitive=new mr};Ss.prototype=Object.create(Ii.prototype),Ss.prototype.constructor=Ss,Ss.prototype.lineType=null,Ss.prototype.gss=function(t){this.Vrs(t);var i=t.readDouble(),s=t.readDouble(),r=t.readDouble(),n=t.readDouble(),h=t.readDouble(),e=t.tis(),a=t.qts(),f=(t.readDouble(),t.readDouble(),17);if(bn){var o=bn,u=h-n,c=400;if(0==a)if(r*Math.PI*2<bn);else{o>r&&(o=r);var v=Math.acos(1-o/r);c=0==v?400:Math.PI/v+.5}f=Math.floor(u*c*(1/(2*Math.PI))+2.5)}return this.vertexBuffer||(this.vertexBuffer=new Wt),this.zrs(this.vertexBuffer,this.primitive,i,s,r,n,h,f,e),!0};var gs=function(){Ii.call(this),this.vertexBuffer=null,this.primitive=new mr};gs.prototype=Object.create(Ii.prototype),gs.prototype.constructor=gs,gs.prototype.lineType=null,gs.prototype.gss=function(i){this.Vrs(i),this.primitive.connectivity=t.ConnectivityTypeEnum.LINES,this.vertexBuffer||(this.vertexBuffer=new Wt);var s=this.vertexBuffer.posBuffer.length/3,r=i.qts(),n=i.tis(),h=!1;0==n&&1&r&&(r--,h=!0);for(var e=0;e<r;++e)this.vertexBuffer.posBuffer.push(i.readFloat()),this.vertexBuffer.posBuffer.push(i.readFloat()),this.vertexBuffer.posBuffer.push(0);if(h&&(i.readFloat(),i.readFloat()),this.Hrs(s,this.primitive,r,n),i.version>=1101850&&i.version<21e5||i.version>=2100170)i.tis();else if(2==r){var a=this.vertexBuffer.posBuffer.length-6;this.vertexBuffer.posBuffer[a],this.vertexBuffer.posBuffer[a+3],this.vertexBuffer.posBuffer[a],this.vertexBuffer.posBuffer[a+3];(this.vertexBuffer.posBuffer[a+1]-this.vertexBuffer.posBuffer[a+4])*(this.vertexBuffer.posBuffer[a+1]-this.vertexBuffer.posBuffer[a+4])}return!0};var js=function(){Ii.call(this),this.vertexBuffer=null,this.primitive=new mr};js.prototype=Object.create(Ii.prototype),js.prototype.constructor=js,js.prototype.lineType=null,js.prototype.gss=function(i){this.Vrs(i),this.vertexBuffer||(this.vertexBuffer=new Wt),this.primitive.symbol=i.qts();var s=this.vertexBuffer.posBuffer.length/3;this.primitive.start=this.primitive.indices.length,this.primitive.connectivity=t.ConnectivityTypeEnum.POINTS;var r=i.qts();this.primitive.count=r;for(var n=0;n<r;n++)this.vertexBuffer.posBuffer.push(i.readFloat()),this.vertexBuffer.posBuffer.push(i.readFloat()),this.vertexBuffer.posBuffer.push(0),this.primitive.indices.push(s++);return!0};var Is=function(){Ii.call(this),this.vertexBuffer=null,this.primitive=new mr};Is.prototype=Object.create(Ii.prototype),Is.prototype.constructor=Is,Is.prototype.lineType=null,Is.prototype.gss=function(i){this.Vrs(i);var r=i.readDouble(),n=i.readDouble(),h=i.readDouble(),e=i.readDouble(),a=i.readDouble(),f=i.readDouble(),o=i.readDouble(),u=i.tis(),c=i.qts(),v=i.readDouble(),l=i.readDouble(),w=h>e?h:e;f<a&&(f+=2*Math.PI),a<0&&(a+=2*Math.PI,f+=2*Math.PI);var b=f-a,d=17;if(bn){var A=bn,m=(b=f-a,400);if(0==c)if(w*Math.PI*2<bn);else A>w&&(A=w),m=0==(O=Math.acos(1-A/w))?400:Math.PI/O+.5;d=Math.floor(b*m*(1/(2*Math.PI))+2.5)}var M=b/(d-1),y=[];y[0]=v*h,y[1]=l*e,y[2]=0;var O=e/h,p=Math.cos(M),k=Math.sin(M),S=0,g=3;for(S=1;S<d;S++)y[g]=p*y[g-3]-k*y[g-2]/O,y[g+1]=k*y[g-3]*O+p*y[g-2],y[g+2]=0,g+=3;var j=new s.Matrix4;j.makeRotationZ(o),j.setPosition({x:r,y:n,z:0}),g=0;var I=new s.Vector4;for(S=0;S<d;S++)I.set(y[g],y[g+1],0,1),I.Fm(j),y[g]=I.x,y[g+1]=I.y,y[g+2]=0,g+=3;this.vertexBuffer||(this.vertexBuffer=new Wt),this.primitive.start=this.primitive.indices.length;var N=this.vertexBuffer.posBuffer.length/3;if(u){this.primitive.connectivity=t.ConnectivityTypeEnum.TRIANGLES,this.primitive.count=3*(d-2),this.vertexBuffer.posBuffer=y;for(S=1;S<d-1;S++)this.primitive.indices.push(0),this.primitive.indices.push(S),this.primitive.indices.push(S+1)}else{this.primitive.connectivity=t.ConnectivityTypeEnum.LINES,this.primitive.count=2+2*(d-2),this.vertexBuffer.posBuffer=y;for(S=1;S<d;++S)this.primitive.indices.push(N++),this.primitive.indices.push(N)}return!0};var Ns=function(){Ii.call(this),this.vertexBuffer=null,this.primitive=new mr,this.tns=!0};Ns.prototype=Object.create(Ii.prototype),Ns.prototype.constructor=Ns,Ns.prototype.lineType=null,Ns.prototype.gss=function(i){if(this.Vrs(i),i.iss()){this.primitive.connectivity=t.ConnectivityTypeEnum.LINES,this.vertexBuffer||(this.vertexBuffer=new Wt);var s=this.vertexBuffer.posBuffer.length/3;this.primitive.start=this.primitive.indices.length;var r=i.qts(),n=i.qts();switch(this.primitive.count=r,n){case 0:this.primitive.count=r;for(var h=0;h<r;++h)this.vertexBuffer.posBuffer.push(i.readFloat()),this.vertexBuffer.posBuffer.push(i.readFloat()),this.vertexBuffer.posBuffer.push(i.readFloat()),this.primitive.indices.push(s++);break;case 1:this.primitive.count=2+2*(r-2),this.vertexBuffer.posBuffer.push(i.readFloat()),this.vertexBuffer.posBuffer.push(i.readFloat()),this.vertexBuffer.posBuffer.push(i.readFloat());for(h=1;h<r;++h)this.primitive.indices.push(s++),this.vertexBuffer.posBuffer.push(i.readFloat()),this.vertexBuffer.posBuffer.push(i.readFloat()),this.vertexBuffer.posBuffer.push(i.readFloat()),this.primitive.indices.push(s);break;case 2:this.primitive.count=4+2*(r-2);var e=s;this.vertexBuffer.posBuffer.push(i.readFloat()),this.vertexBuffer.posBuffer.push(i.readFloat()),this.vertexBuffer.posBuffer.push(i.readFloat());for(h=1;h<r;++h)this.primitive.indices.push(s++),this.vertexBuffer.posBuffer.push(i.readFloat()),this.vertexBuffer.posBuffer.push(i.readFloat()),this.vertexBuffer.posBuffer.push(i.readFloat()),this.primitive.indices.push(s);this.primitive.indices.push(s),this.primitive.indices.push(e);break;default:return null}if(2==r){var a=this.vertexBuffer.posBuffer.length-6,f=this.vertexBuffer.posBuffer,o=(f[a]-f[a+3])*(f[a]-f[a+3]);o+=(f[a+1]-f[a+4])*(f[a+1]-f[a+4]),(o+=(f[a+2]-f[a+5])*(f[a+2]-f[a+5]))>=1e12&&(this.primitive.tns=!0)}}},Ns.prototype.skip=function(t){if(this.Vrs(t),t.iss()){var i=t.qts();t.qts();i>0&&t.skip(3*i*4)}};var xs=function(){Ns.call(this)};xs.prototype=Object.create(Ns.prototype),xs.prototype.constructor=xs;var Ts=0,Rs=1,Es=2,Fs=1,_s=2,Ps=4,Us=8,Ds=16,Cs=function(){},Gs=[],Ls=null,Vs=function(t,i,s){this.vns=t,this.normal=i,this.next=s},Bs=function(t,i,s){if(Ls){var r=Ls;return Ls=Ls.next,r.vns=t,r.normal=i,r.next=s,r}return new Vs(t,i,s)},zs=function(t){for(var i=t;i;){var s=i.next;i.next=Ls,Ls=i,i=s}};Cs.prototype.lns=function(i,r,n){for(var h=i?i.posBuffer:null,e=i?i.Xss:null,a=i?i.Jss:null,f=i?i.Wss:null,o=i?i.Hss:null,u=i?i.Yss:null,c=h?h.length/3:0,v=o?o.length/3:0,l=Gs.length;l<c;++l)Gs[l]=null;var w=new t.Mesh,b=c,d=0,A=r.length,m=0;for(l=0;l<A;l++)m+=r[l].nbIndices;var M=new Uint32Array(m),y=0;for(l=0;l<A;l++){var O=0,p=r[l],k=null==p.material?n.hss():p.material;switch(p.connectivity){case t.ConnectivityTypeEnum.TRIANGLES:O=new t.DrawingGroup(p.gas,k,4,y,p.nbIndices,void 0,void 0,s.GeomTypeEnum[p.geomType]);break;case t.ConnectivityTypeEnum.LINES:O=new t.DrawingGroup(p.gas,k,1,y,p.nbIndices,void 0,void 0,s.GeomTypeEnum[p.geomType]);break;case t.ConnectivityTypeEnum.POINTS:O=new t.DrawingGroup(p.gas,k,0,y,p.nbIndices,void 0,void 0,s.GeomTypeEnum[p.geomType])}d=p.set.length;var S=p.set;O.tEi=new Array(d);for(var g=0;g<d;g++){var j=y,I=S[g],N=I.indices?I.indices.length:0,x=I.qrs,T=I.qrs?I.qrs.length:0,R=I.indices;if(0===T)N&&(M.set(R,y),y+=N);else for(var E=x[0],F=x[1],_=x[2],P=0;P<N;P++){var U=R[P];if(U<v){var D=3*U;if(o[D]===E&&o[D+1]===F&&o[D+2]===_){M[y++]=U;continue}}else null===Gs[U]&&(Gs[U]=Bs(U,x,null));for(var C=!1,G=0,L=Gs[U];null!==L;){var V=L.normal;if(V[0]===E&&V[1]===F&&V[2]===_){C=!0,G=L.vns;break}L=L.next}C?M[y++]=G:(Gs[U]=Bs(b,x,Gs[U]),M[y++]=b++)}var B=new t.wns(I.cgmId,O,j,N);I.decoration&&(B.decoration=I.decoration),I.boundingSphere&&(B.boundingSphere=I.boundingSphere),O.tEi[g]=B}w.drawingGroups.push(O)}var z=new Float32Array(3*b),H=new Float32Array(3*b),Y=null,X=!!i&&i.Kss,J=!!i&&i.Zss,W=!!i&&i.qss;X&&(Y=new Float32Array(3*b));var q=null;J&&(q=new Float32Array(3*b));var K=null;J&&(K=new Float32Array(3*b));var Z=null;W&&(Z=new Float32Array(3*b));var Q=o?o.length:0,$=h?h.length:0;for(l=0;l<Q;++l)H[l]=o[l];for(l=0;l<$;++l)z[l]=h[l];if(X)for(l=0;l<$;++l)Y[l]=e[l];if(J)for(l=0;l<$;++l)q[l]=a[l],K[l]=f[l];if(W)for(l=0;l<$;++l)Z[l]=u[l];for(l=0;l<c;++l)for(L=Gs[l];null!==L;){var tt=3*l,it=3*L.vns;z[it]=h[tt],z[it+1]=h[tt+1],z[it+2]=h[tt+2],H[it]=L.normal[0],H[it+1]=L.normal[1],H[it+2]=L.normal[2],X&&(Y[it]=e[tt],Y[it+1]=e[tt+1],Y[it+2]=e[tt+2]),J&&(q[it]=a[tt],q[it+1]=a[tt+1],q[it+2]=a[tt+2],K[it]=f[tt],K[it+1]=f[tt+1],K[it+2]=f[tt+2]),W&&(Z[it]=u[tt],Z[it+1]=u[tt+1],Z[it+2]=u[tt+2]),L=L.next}w.vertexIndexArray=M,w.vertexPositionArray=z,w.vertexNormalArray=H,w.vertexUvArray=Z,w.vertexTangentArray=K,w.vertexBinormalArray=q;var st=new s.Color,rt=new s.Color,nt=this.rep.bns,ht=nt>>24&255,et=nt>>16&255,at=nt>>8&255,ft=255&nt;st.eMi(ht,et,at),rt.eMi(ht,et,at),w.gas.fill={color:st,opacity:ft},w.gas.line={color:rt,opacity:ft,lineWidth:1};var ot=[0,0,0],ut=[0,0,0],ct=z;if($>=3){var vt,lt,wt,bt,dt,At;vt=lt=ct[0],wt=bt=ct[1],dt=At=ct[2];for(var mt=3;mt<$;mt+=3){var Mt=ct[mt],yt=ct[mt+1],Ot=ct[mt+2];Mt<vt?vt=Mt:Mt>lt&&(lt=Mt),yt<wt?wt=yt:yt>bt&&(bt=yt),Ot<dt?dt=Ot:Ot>At&&(At=Ot)}ot=[vt,wt,dt],ut=[lt,bt,At]}w.AABB={min:ot,max:ut};for(l=0;l<c;l++)zs(Gs[l]),Gs[l]=null;return w},Cs.prototype.Ans=function(i,s){if(s.globalMatrix=i.nss(),s.axis){var r=i.axisSystems.add(s);return s.axisSystems=r,i.Zis(),i.Kis(),this}if(s.curveVertices){r=i.curvedPipes.add(s);return this.rep.curvedPipe=r,i.Zis(),i.Kis(),this}if(null!=s.canonicalType){r=i.canonicals.add(s);return this.rep.mns=r,i.Zis(),i.Kis(),this}if(s.refPlanes){r=i.refPlanes.add(s);return s.Mns=r,this}var n=i.Pis(),h=i.X9e(),a=(h.getType(),h.lss()),f=h.isHidden(),o=h.bss(),u=i.Dis();s.gas=h,this.rep.node.solid=o,e&&s.rep instanceof t.SGRep&&(s.rep.boundingSphere=this.rep.boundingSphere),a&&(s.thn=!0),f&&(s.noShow=!0),u&&(s.sYi=u);var c=i.zts(s,u,a,this.rep.excludeFromBounding,n);c&&(this.rep.renderType=c.renderType,this.rep.yns=c.indice)},Cs.prototype.Ons=function(t){if(this.rep.node.type){var i=t.sgRep,s=t.nbRep++;return i.push(this.rep.node.cgmId+1),i.push(this.rep.node.solid),i.push(this.rep.node.namingContext),a&&i.push(this.rep.node.sag),e&&(i.push(this.rep.boundingSphere.radius),i.push(this.rep.boundingSphere.center[0]),i.push(this.rep.boundingSphere.center[1]),i.push(this.rep.boundingSphere.center[2])),this.rep.node=s,s}return this.rep.node},Cs.prototype.$qe=function(t){var i=this.build(t);return null==i?(t.Zis(),t.Kis(),null):(this.Ans(t,i),i.rep=this.Ons(t),t.Zis(),t.Kis(),this)};var Hs=function(){Cs.call(this),this.rep=new Ks};(Hs.prototype=Object.create(Cs.prototype)).constructor=Hs;var Ys=function(){Cs.call(this),this.rep=new Js};(Ys.prototype=Object.create(Cs.prototype)).constructor=Ys;var Xs=function(t){t=t||{},this.pns=void 0!==t.pns?t.pns:0,this.kns=void 0!==t.kns?t.kns:0,this.Sns=void 0!==t.Sns?t.Sns:0,this.material=void 0!==t.material?t.material:{file:"",id:-1},this.node=void 0!==t.node?t.node:null,this.boundingSphere=null,this.renderType=void 0!==t.renderType?t.renderType:0};Xs.prototype.gss=function(t){this.namingContext=0,this.pns=t.qts(),this.kns=t.sis(),this.kns.isHidden()&&(this.node.noShow=!0);t.Lis(this.kns,this.pns);this.material={file:"",id:-1},this.Sns=0;t.qts(),t.qts();var i=t.readFloat(),s=t.readFloat(),r=t.readFloat(),n=t.readFloat(),h=(s-i)*(s-i)+(n-r)*(n-r);if(h=.5*Math.sqrt(h),this.boundingSphere={radius:h,center:[.5*(s+i),.5*(n+r),0]},t.version>=1101303)t.readFloat();t.version>=210042500&&t.Zts()},Xs.prototype.gns=function(){var t=new Array;for(var i in this.children)t[i]="object"==typeof this.children[i]?this.children[i].clone():this.children[i];return t};var Js=function(i){Xs.call(this,i=i||{}),this.node=void 0!==i.node?i.node:new t.SGRep};Js.prototype=Object.create(Xs.prototype),Js.prototype.constructor=Js,Js.prototype.clone=function(){return new Js({renderType:this.renderType,node:this.node,namingContext:this.namingContext,Sns:this.Sns,jns:this.jns,material:this.material,kns:this.kns,pns:this.pns})};var Ws=function(i){Xs.call(this,i=i||{}),this.node=void 0!==i.node?i.node:new t.SGBag,this.children=void 0!==i.children?this.gns(i.children):[]};(Ws.prototype=Object.create(Xs.prototype)).constructor=Ws,Ws.prototype.clone=function(){return new Ws({children:this.gns(),node:this.node.clone(),Sns:this.Sns,jns:this.jns,material:this.material,kns:this.kns,pns:this.pns})};var qs=function(t){t=t||{},this.pns=void 0!==t.pns?t.pns:0,this.kns=void 0!==t.kns?t.kns:0,this.Sns=void 0!==t.Sns?t.Sns:0,this.material=void 0!==t.material?t.material:{file:"",id:-1},this.layer=void 0!==t.layer?t.layer:rt.ets,this.node=void 0!==t.node?t.node:null,this.boundingSphere=null};qs.prototype.gss=function(t){this.namingContext=0,this.pns=t.kis(),this.kns=t.sis(),this.kns.isHidden()&&(this.node.noShow=!0),0==t.Lis(this.kns,this.pns).getType()&&(this.thn=!0),this.material={file:"",id:-1},this.Sns=0,2==t.qts()&&(this.excludeFromBounding=!0);t.qts();var i=t.readFloat(),s=(t.readFloat(),t.readFloat()),r=t.readFloat(),n=t.readFloat();(this.boundingSphere={radius:i,center:[s,r,n]},t.version>=210042410)&&(V=t.dis(),(L===P||L===U||t.version>=210042415&&B==D)&&V&&(ri.x=t.readFloat(),ri.y=t.readFloat(),ri.z=t.readFloat(),ni.x=t.readFloat(),ni.y=t.readFloat(),ni.z=t.readFloat()));if(t.version>1100800&&(this.node.cgmId=t.ris(),t.Zts(),t.version>1101020&&(this.namingContext=t.tis(),this.node.namingContext=this.namingContext)),t.tis()){var h=this.frs(t,rt.ots|rt.uts);this.material=h.material,this.Sns=h.ars}if(t.version>=210041800&&t.tis()){if((h=this.frs(t,rt.bts|rt.dts|rt.Ats|rt.mts)).mapping)(f=t.materials.get([this.material.id]))&&(f.mapping=h.mapping);this.layer=h.layer;var e=t.kis();if(e>0)for(var a=0;a<e;++a){var f;if((h=this.frs(t,rt.Ots)).mapping)(f=t.materials.get([h.material.id]))&&(f.mapping=h.mapping);(h.layer<this.layer||h.layer==this.layer&&h.ars>=this.Sns)&&(this.layer=h.layer,this.material=h.material,this.Sns=h.ars)}}if((t.Qis(this.material,this.Sns,this.layer,this),t.version>=210041910)&&t.tis()){t.pis(6,[])}},qs.prototype.frs=function(t,i){var s={material:null,ars:1,layer:0};if(i&rt.ots&&(s.material=this.crs(t)),t.version>=1100500?i&rt.uts||i&rt.cts?s.ars=t.qts():i&rt.vts&&(s.ars=t.ris()):i&(rt.uts|rt.cts|rt.vts)&&(s.ars=1),i&rt.lts||i&rt.wts?s.layer=t.ris():i&rt.bts&&(s.layer=t.ass()),i&rt.dts){if(t.version>=210041900){var r=[0,0,0,1];if(t.Ais()){var n=!0,h=t.readFloat(),e=t.readFloat(),a=t.readFloat(),f=t.readFloat();h!=r[0]&&(r[0]=h,n=!1),e!=r[1]&&(r[1]=e,n=!1),a!=r[2]&&(r[2]=a,n=!1),f!=r[3]&&(r[3]=f,n=!1),n||(s.mapping={type:0,ObjectTransformation:null,UvTransformation:null,UvTransfoInfos:r,transformSemantic:1})}}}if(i&rt.Ats&&(t.version>=210042100&&!t.Ais())){var o=t.Wts();if(o=(o=JSON.parse(o)).mappings[o.uvSlots.Default],s.mapping||(s.mapping={type:0,ObjectTransformation:null,UvTransformation:null,UvTransfoInfos:null,transformSemantic:1}),o.vrs&&(s.mapping.transformSemantic=o.vrs+1),o.uvTransform&&(s.mapping.UvTransformation=t.Bts(o.uvTransform)),o.operator&&(s.mapping.type=o.operator.type,o.operator.transform)){var u=o.operator.transform;s.mapping.ObjectTransformation=u}}if(i&rt.mts&&(t.version>=210042320&&1==t.qts()))t.Wts(),t.qts(),t.Tis();return s},qs.prototype.crs=function(t){var i,s={file:"",id:-1},r=0,n=t.tis(),h=0,e=null;if(n){if(2==n){t.Wts();return r=t.qts(),s.id=t.materials.add({external3DXid:r}),s}if(h=t.qts(),t.materials.Dss(h,t.name))return s={file:"",id:c=t.materials.Gss(h,t.name)}}if(t.version>=210021320){var a=t.qts();e=1===a?new Jt:4===a?new Bt:9===a&&t.version>=210042100?new zt:new Vt}else e=new Vt;i=e.gss(t);var f=t.getCurrentPosition(),o=t.Jts();o>32&&(o=32);var u=t.UAt(o);(t.Qts(f),-1!==u.indexOf('{\n"Version" : '))&&(new Bt).skip(t);if(1===a)var c=i;else c=t.materials.add(i);return s={file:"",id:c},n&&t.materials.Vss(h,c,t.name),s},qs.prototype.gns=function(){var t=new Array;for(var i in this.children)t[i]="object"==typeof this.children[i]?this.children[i].clone():this.children[i];return t};var Ks=function(i){qs.call(this,i=i||{}),this.node=void 0!==i.node?i.node:new t.SGRep,this.namingContext=void 0!==i.namingContext?i.namingContext:0,this.yns=void 0!==i.yns?i.yns:-1,this.renderType=void 0!==i.renderType?i.renderType:0,this.curvedPipe=void 0!==i.curvedPipe?i.curvedPipe:-1};Ks.prototype=Object.create(qs.prototype),Ks.prototype.constructor=Ks,Ks.prototype.clone=function(){return new Ks({curvedPipe:this.curvedPipe,renderType:this.renderType,yns:this.yns,node:this.node,namingContext:this.namingContext,Sns:this.Sns,jns:this.jns,material:this.material,kns:this.kns,pns:this.pns})};var Zs=function(i){qs.call(this,i=i||{}),this.node=void 0!==i.node?i.node:new t.SGBag,this.children=void 0!==i.children?i.children:[]};(Zs.prototype=Object.create(qs.prototype)).constructor=Zs,Zs.prototype.clone=function(){return new Zs({children:this.gns(),node:this.node.clone(),Sns:this.Sns,jns:this.jns,material:this.material,kns:this.kns,pns:this.pns})};var Qs=function(){Hs.call(this),this.Ins=[],this.vertexBuffer=null,this.Nns=[],this.axisSystems=[],this.refPlane=[],this.xns=!1,this.Zss=!1,this.Tns=[],this.drs=[]};Qs.prototype=Object.create(Hs.prototype),Qs.prototype.constructor=Qs,Qs.prototype.brs=function(t,i){for(var s=0;s<this.Tns.length;s++)this.Rns(this.Tns[s].gp,this.Tns[s].att);if(this.Nns.length){if(i&&i.Crs){var r=this.Nns[0].gp.primitive;this.Nns[0].att.getDisplayedColor();var n=this.Nns[0].att.getDisplayedColor();if(this.Nns[0].gp instanceof Ci){var h=this.Ons(t);this.refPlane.push({rep:h,origin:r.origin,VJi:r.direction1,OJi:r.direction2,noShow:this.Nns[0].att.isHidden(),color:n,lengthX:r.length,lengthY:r.length,mode:r.mode,KZi:i.mode===ht,type:"CAT3DCustomRep"}),this.Nns=[]}}for(s=0;s<this.Nns.length;s++)if(this.Nns[s].gp instanceof Ui||this.Nns[s].gp instanceof Ns){this.Nns[s].gp.tns=!1;var e=this.Nns[s].gp.vertexBuffer;e&&(this.xns=!!e.qss&&e.qss,this.Zss=!!e.Zss&&e.Zss),this.Rns(this.Nns[s].gp,this.Nns[s].att)}}},Qs.prototype.yOn=function(t,i,r,n){var h=new Br,e=r.nss();if(h.rep.pns=n.pns,h.rep.kns=n.kns,h.rep.Sns=n.Sns,h.rep.pns=n.pns,h.rep.node.noShow=n.node.noShow,h.vertexBuffer=new Wt,h.gp=t,t&&t.primitive){if(void 0!==t.Lrs&&0===t.Lrs&&r.Uis(!0),t.point){var a,f=(new s.Matrix4).setPosition({x:t.point[0],y:t.point[1],z:t.point[2]});a=e?(new s.Matrix4).multiplyMatrices(e,f):f,r.Cis(a),r.Ets.push(new s.Matrix4)}t.primitive.material&&r.Qis(t.primitive.material,1,0,h.rep);var o=h.build(r);h.Ans(r,o),o.rep=h.Ons(r),r.Gis(),t.point&&(r.Ets.pop(),r.Gis()),t.primitive.material&&r.Zis(),r.Uis(!1)}return h.rep},Qs.prototype.wrs=function(t,i,s,r){if(!t.$rs)if(t.tns){if(t.fns)return void this.drs.push(this.yOn(t,i,s,this.rep));if(this.Nns.push({gp:t,att:i}),2==this.rep.namingContext&&7==this.Nns.length&&this.Nns[0].gp instanceof Ui&&this.Nns[1].gp instanceof Di&&this.Nns[2].gp instanceof Di&&this.Nns[3].gp instanceof Di&&this.Nns[4].gp instanceof Ci&&this.Nns[5].gp instanceof Ci&&this.Nns[6].gp instanceof Ci){var n=this.Nns[0].att.getDisplayedColor(),h=[(a=this.Nns[0].gp.vertexBuffer.posBuffer)[(f=this.Nns[0].gp.primitive.indices)[0]],a[f[0]+1],a[f[0]+2]],e=this.Ons(s);this.axisSystems.push({rep:e,origin:h,VJi:this.Nns[1].gp.primitive.direction,OJi:this.Nns[2].gp.primitive.direction,UJi:this.Nns[3].gp.primitive.direction,refPlanes:[this.Nns[4].gp.primitive,this.Nns[5].gp.primitive,this.Nns[6].gp.primitive],color:n,KZi:!1}),this.Nns=[]}if(2==this.rep.namingContext&&7==this.Nns.length&&this.Nns[0].gp instanceof Ui&&this.Nns[1].gp instanceof Vi&&this.Nns[2].gp instanceof Vi&&this.Nns[3].gp instanceof Vi&&this.Nns[4].gp instanceof Ns&&this.Nns[5].gp instanceof Ns&&this.Nns[6].gp instanceof Ns){var a,f;n=this.Nns[0].att.getDisplayedColor(),h=[(a=this.Nns[0].gp.vertexBuffer.posBuffer)[(f=this.Nns[0].gp.primitive.indices)[0]],a[f[0]+1],a[f[0]+2]],e=this.Ons(s);this.axisSystems.push({rep:e,origin:h,VJi:this.Nns[1].gp.primitive.direction,OJi:this.Nns[2].gp.primitive.direction,UJi:this.Nns[3].gp.primitive.direction,refPlanes:[this.Nns[4].gp.vertexBuffer.posBuffer,this.Nns[5].gp.vertexBuffer.posBuffer,this.Nns[6].gp.vertexBuffer.posBuffer],color:n,KZi:!0,length:r.axisLength}),this.Nns=[]}}else{var o=t.vertexBuffer;o&&(this.xns=!!o.qss&&o.qss,this.Zss=!!o.Zss&&o.Zss),this.Tns.push({gp:t,att:i})}},Qs.prototype.Rns=function(t,i){var s=t.primitive,r=void 0;2==this.rep.namingContext&&t instanceof Ui&&(r="FREE_POINT");for(var n=this.Ins.length,h=0;h<n;h++){var e=this.Ins[h];if(e.connectivity==s.connectivity&&e.gas.isEqual(i)&&(null==e.material&&null==s.material||e.material.id==s.material.id&&e.material.file==s.material.file)&&(void 0===r||e.geomType===r)){e.set.push(s),e.nbIndices+=s.indices.length;break}}if(h==this.Ins.length){var a={};a.connectivity=s.connectivity,a.gas=i,a.material=s.material,a.nbIndices=s.indices.length,a.Ens=0,a.set=[],r&&(a.geomType=r),a.set.push(s),this.Ins.push(a)}null==this.vertexBuffer&&(this.vertexBuffer=new Wt,this.vertexBuffer.qss=this.xns,this.vertexBuffer.Kss=!1,this.vertexBuffer.Zss=this.Zss);for(var f=t.vertexBuffer,o=s.indices,u=this.vertexBuffer.posBuffer.length/3,c=0;c<o.length;c++)o[c]=o[c]+u;for(c=0;c<f.posBuffer.length;c++)this.vertexBuffer.posBuffer.push(f.posBuffer[c]),f.Hss.length?this.vertexBuffer.Hss.push(f.Hss[c]):this.vertexBuffer.Hss.push(0),this.xns&&(f.Yss.length?this.vertexBuffer.Yss.push(f.Yss[c]):this.vertexBuffer.Yss.push(0)),this.Zss&&(f.Wss.length?this.vertexBuffer.Wss.push(f.Wss[c]):this.vertexBuffer.Wss.push(0),f.Jss.length?this.vertexBuffer.Jss.push(f.Jss[c]):this.vertexBuffer.Jss.push(0))},Qs.prototype.build=function(t){if(this.axisSystems.length>0)return{axis:this.axisSystems[0]};if(0==this.Ins.length)return this.refPlane&&this.refPlane.length>0?{refPlanes:this.refPlane}:null;var i=this.lns(this.vertexBuffer,this.Ins,t);return this.refPlane.length>0&&(i.refPlanes=this.refPlane),i};var $s=function(){Hs.call(this),this.vertexBuffer=null,this.mrs=0,this.ADi=[],this.Fns=[],this.sag=0,this._ns=[],this.Irs=0,this.sets=[],this.Mrs=0};$s.prototype=Object.create(Hs.prototype),$s.prototype.constructor=$s,$s.prototype.Trs=function(t){for(var i=[],s=0;s<this.sets.length;s++)if(this.sets[s].geomType==t)for(var r=this.sets[s].primitives,n=0;n<r.length;n++)i.push(r[n]);return i},$s.prototype.jrs=function(t){if(t.tis()){if(t.version>=2100180)switch(t.tis()){case 2:this.sets[0]=new Zt;break;case 3:this.sets[0]=new $t;break;default:this.sets[0]=null}else this.sets[0]=new Zt;this.sets[0]&&this.sets[0].gss(t)}},$s.prototype.build=function(i){var s,r,n,h,e,a=null!==this.vertexBuffer,f=(this.rep.kns.getType(),this.rep.kns.bss(),[]);if(0==this.Irs)return null;for(s=0;s<this.Irs;s++)for(this.sets[s].primitive?(h=1,e=[this.sets[s].primitive]):(h=this.sets[s].primitives.length,e=this.sets[s].primitives),r=0;r<h;r++)if(n=e[r]){if(n.posBuffer){this.vertexBuffer||(this.vertexBuffer=new Wt);for(var o=n.indices,u=this.vertexBuffer.posBuffer.length/3,c=0;c<o.length;c++)o[c]=o[c]+u;for(c=0;c<n.posBuffer.length;c++)this.vertexBuffer.posBuffer.push(n.posBuffer[c]),n.Hss&&n.Hss.length?this.vertexBuffer.Hss.push(n.Hss[c]):this.vertexBuffer.Hss.push(0);this.vertexBuffer.Zss&&(this.vertexBuffer.Wss.push(0),this.vertexBuffer.Jss.push(0)),this.vertexBuffer.qss&&this.vertexBuffer.Yss.push(0)}else if(!a)continue;n.indices.length,n.qrs&&n.qrs.length>0&&n.indices.length;var v=f.length;for(c=0;c<v;c++){var l=f[c];if(l.connectivity==n.connectivity&&l.geomType==this.sets[s].geomType&&l.gas.isEqual(n.gas)&&t.Pns(l.material,n.material)){l.set.push(n),l.nbIndices+=n.indices.length;break}}if(c==f.length){var w={};w.connectivity=n.connectivity,w.gas=n.gas,w.geomType=this.sets[s].geomType,w.material=n.material,w.nbIndices=n.indices.length,w.Ens=0,w.set=[],w.set.push(n),f.push(w)}}return this.vertexBuffer?this.lns(this.vertexBuffer,f,i):null};var tr=function(){$s.call(this)};(tr.prototype=Object.create($s.prototype)).constructor=tr,tr.prototype.build=function(t){};var ir=function(){Ys.call(this),this.gp=[]};ir.prototype=Object.create(Hs.prototype),ir.prototype.constructor=ir,ir.prototype.build=function(t){return null};var sr=function(){Hs.call(this),this.gp=[]};sr.prototype=Object.create(Hs.prototype),sr.prototype.constructor=sr,sr.prototype.build=function(t){return null};var rr=function(){Hs.call(this),this.gp=[]};rr.prototype=Object.create(Hs.prototype),rr.prototype.constructor=rr,rr.prototype.build=function(t){return null};var nr=function(){Hs.call(this),this.gp=[]};nr.prototype=Object.create(Hs.prototype),nr.prototype.constructor=nr,nr.prototype.build=function(t){return null};var hr=function(){Hs.call(this),this.gp=[]};hr.prototype=Object.create(Hs.prototype),hr.prototype.constructor=hr,hr.prototype.build=function(t){return null};var er=function(){Hs.call(this),this.gp=[]};er.prototype=Object.create(Hs.prototype),er.prototype.constructor=er,er.prototype.build=function(t){return null};var ar=function(){Hs.call(this),this.gp=[]};ar.prototype=Object.create(Hs.prototype),ar.prototype.constructor=ar,ar.prototype.build=function(i){var s=new t.Mesh,r=i.hss(),n=i.X9e();n.setConnectivity(this.gp.primitive.connectivity);var h=new t.DrawingGroup(n,r,this.gp.primitive.connectivity==t.ConnectivityTypeEnum.LINES?1:4,0,this.gp.primitive.indices.length),e=new t.wns(this.gp.node.cgmId,h,0,this.gp.primitive.indices.length);this.gp.decoration&&(e.decoration=this.gp.decoration),this.gp.boundingSphere&&(e.boundingSphere=this.gp.boundingSphere),h.tEi.push(e),s.drawingGroups.push(h),s.vertexIndexArray=this.gp.primitive.indices,s.vertexPositionArray=this.gp.vertexBuffer.posBuffer,s.vertexNormalArray=this.gp.vertexBuffer.Hss,s.gas=n;var a=[0,0,0],f=[0,0,0],o=(a=[0,0,0],f=[0,0,0],s.vertexPositionArray.length);if(o>=3){a=[s.vertexPositionArray[0],s.vertexPositionArray[1],s.vertexPositionArray[2]],f=[s.vertexPositionArray[0],s.vertexPositionArray[1],s.vertexPositionArray[2]];for(var u=0;u<o;u+=3)s.vertexPositionArray[u]<a[0]&&(a[0]=s.vertexPositionArray[u]),s.vertexPositionArray[u+1]<a[1]&&(a[1]=s.vertexPositionArray[u+1]),s.vertexPositionArray[u+2]<a[2]&&(a[2]=s.vertexPositionArray[u+2]),s.vertexPositionArray[u]>f[0]&&(f[0]=s.vertexPositionArray[u]),s.vertexPositionArray[u+1]>f[1]&&(f[1]=s.vertexPositionArray[u+1]),s.vertexPositionArray[u+2]>f[2]&&(f[2]=s.vertexPositionArray[u+2])}return a[2]=-.01,f[2]=.01,s.AABB={min:a,max:f},s};var fr=function(){Hs.call(this),this.gp=[]};(fr.prototype=Object.create(Hs.prototype)).constructor=fr,fr.prototype.build=function(i){var s=new t.Mesh,r=i.hss(),n=i.X9e();n.setConnectivity(this.gp.primitive.connectivity);var h=new t.DrawingGroup(n,r,this.gp.primitive.connectivity==t.ConnectivityTypeEnum.LINES?1:4,0,this.gp.primitive.indices.length),e=new t.wns(this.gp.node.cgmId,h,0,this.gp.primitive.indices.length);this.gp.decoration&&(e.decoration=this.gp.decoration),this.gp.boundingSphere&&(e.boundingSphere=this.gp.boundingSphere),h.tEi.push(e),s.drawingGroups.push(h),s.vertexIndexArray=this.gp.primitive.indices,s.vertexPositionArray=this.gp.vertexBuffer.posBuffer,s.vertexNormalArray=this.gp.vertexBuffer.Hss,s.gas=n;var a=[0,0,0],f=[0,0,0],o=(a=[0,0,0],f=[0,0,0],s.vertexPositionArray.length);if(o>=3){a=[s.vertexPositionArray[0],s.vertexPositionArray[1],s.vertexPositionArray[2]],f=[s.vertexPositionArray[0],s.vertexPositionArray[1],s.vertexPositionArray[2]];for(var u=0;u<o;u+=3)s.vertexPositionArray[u]<a[0]&&(a[0]=s.vertexPositionArray[u]),s.vertexPositionArray[u+1]<a[1]&&(a[1]=s.vertexPositionArray[u+1]),s.vertexPositionArray[u+2]<a[2]&&(a[2]=s.vertexPositionArray[u+2]),s.vertexPositionArray[u]>f[0]&&(f[0]=s.vertexPositionArray[u]),s.vertexPositionArray[u+1]>f[1]&&(f[1]=s.vertexPositionArray[u+1]),s.vertexPositionArray[u+2]>f[2]&&(f[2]=s.vertexPositionArray[u+2])}return a[2]=-.01,f[2]=.01,s.AABB={min:a,max:f},s};var or=function(){Hs.call(this),this.refPlane=[]};or.prototype=Object.create(Hs.prototype),or.prototype.constructor=or,or.prototype.build=function(t){if(this.refPlane)return{refPlanes:this.refPlane}};var ur=function(){Hs.call(this),this.refPlane=[]};(ur.prototype=Object.create(Hs.prototype)).constructor=ur,ur.prototype.build=function(t){if(this.refPlane)return{refPlanes:this.refPlane}};var cr=function(){Hs.call(this),this.vertexBuffer=null,this.sets=[]};cr.prototype=Object.create(Hs.prototype),cr.prototype.constructor=cr,cr.prototype.build=function(i){var r=new t.Mesh,h=i.hss(),e=i.X9e();e.setConnectivity(0);var a=e.getDisplayedColor(),f=new s.Color;if(f.eMi(a[0]/255,a[1]/255,a[2]/255),n)return{gas:{color:f,opacity:a[3]/255},matId:h,curveVertices:this.curveVertices,startNormal:this.startNormal,endNormal:this.endNormal,radius:this.radius,startSideVector:this.startSideVector};var o=new t.DrawingGroup(e,h,4,0,this.sets[0].indices.length),u=new t.wns(this.sets[0].node.cgmId,o,0,this.sets[0].indices.length);this.sets[0].decoration&&(u.decoration=this.sets[0].decoration),this.sets[0].boundingSphere&&(u.boundingSphere=this.sets[0].boundingSphere),o.tEi.push(u),r.drawingGroups.push(o),r.vertexIndexArray=this.sets[0].indices,r.vertexPositionArray=this.vertexBuffer.posBuffer,r.vertexNormalArray=this.vertexBuffer.Hss,r.gas=e;var c=this.sets[0].Xrs,v=this.sets[0].Jrs,l=[c[0]-v[0],c[1]-v[1],c[2]-v[2]],w=[c[0]+v[0],c[1]+v[1],c[2]+v[2]];return r.AABB={min:l,max:w},r};var vr=function(){Hs.call(this),this.sets=[],this.Urs=!0};vr.prototype=Object.create(Hs.prototype),vr.prototype.constructor=vr,vr.prototype.build=function(i){var r=new t.Mesh,h=i.hss(),e=i.X9e();e.setConnectivity(0);var a=e.getDisplayedColor(),f=new s.Color;if(f.eMi(a[0]/255,a[1]/255,a[2]/255),this.Urs&&n)return{gas:{color:f,opacity:a[3]/255},matId:h,curveVertices:this.curveVertices,startNormal:this.startNormal,endNormal:this.endNormal,radius:this.radius,startSideVector:this.startSideVector};var o=new t.DrawingGroup(e,h,4,0,this.sets[0].indices.length),u=new t.wns(this.sets[0].node.cgmId,o,0,this.sets[0].indices.length);this.sets[0].decoration&&(u.decoration=this.sets[0].decoration),this.sets[0].boundingSphere&&(u.boundingSphere=this.sets[0].boundingSphere),o.tEi.push(u),r.drawingGroups.push(o),r.vertexIndexArray=this.sets[0].indices,r.vertexPositionArray=this.vertexBuffer.posBuffer,r.vertexNormalArray=this.vertexBuffer.Hss,r.gas=e;var c=this.sets[0].Xrs,v=this.sets[0].Jrs,l=[c[0]-v[0],c[1]-v[1],c[2]-v[2]],w=[c[0]+v[0],c[1]+v[1],c[2]+v[2]];return r.AABB={min:l,max:w},r};var lr=function(){Hs.call(this),this.Prs=[],this.Frs=[],this.vertexBuffer=null,this.indexBuffer=[],this.Ers=0,this._rs=0,this.Rrs=0};lr.prototype=Object.create(Hs.prototype),lr.prototype.constructor=lr,lr.prototype.build=function(i){var r=[0,0,0],n=[0,0,0],h=i.hss();if(this.Prs.length||this.Frs.length){var e=new t.Mesh,a=this.vertexBuffer.posBuffer.length;if(a>=3){r=[this.vertexBuffer.posBuffer[0],this.vertexBuffer.posBuffer[1],this.vertexBuffer.posBuffer[2]],n=[this.vertexBuffer.posBuffer[0],this.vertexBuffer.posBuffer[1],this.vertexBuffer.posBuffer[2]],e.vertexPositionArray=new Float32Array(a);for(var f=0;f<a;f+=3)e.vertexPositionArray[f]=this.vertexBuffer.posBuffer[f],e.vertexPositionArray[f+1]=this.vertexBuffer.posBuffer[f+1],e.vertexPositionArray[f+2]=this.vertexBuffer.posBuffer[f+2],e.vertexPositionArray[f]<r[0]&&(r[0]=e.vertexPositionArray[f]),e.vertexPositionArray[f+1]<r[1]&&(r[1]=e.vertexPositionArray[f+1]),e.vertexPositionArray[f+2]<r[2]&&(r[2]=e.vertexPositionArray[f+2]),e.vertexPositionArray[f]>n[0]&&(n[0]=e.vertexPositionArray[f]),e.vertexPositionArray[f+1]>n[1]&&(n[1]=e.vertexPositionArray[f+1]),e.vertexPositionArray[f+2]>n[2]&&(n[2]=e.vertexPositionArray[f+2])}e.AABB={min:r,max:n},e.vertexNormalArray=new Float32Array(a);for(f=0;f<a;f++)e.vertexNormalArray[f]=0;e.vertexIndexArray=new Uint32Array(this.Rrs);var o=0;if(this.Ers>0)for(f=0;f<this.Frs.length;f++){var u=this.Frs[f],c=new t.DrawingGroup(u.ghi,h,1,o,u.nbIndices,void 0,void 0,s.GeomTypeEnum.WIRE_EDGE);e.drawingGroups.push(c);for(var v=u.set,l=0;l<v.length;l++){var w=v[l];c.tEi.push(w);for(var b=0;b<w.count;b++)e.vertexIndexArray[o++]=this.indexBuffer[w.start+b]}}if(this._rs)for(f=0;f<this.Prs.length;f++){u=this.Prs[f],c=new t.DrawingGroup(u.ghi,h,0,o,u.nbIndices,void 0,void 0,s.GeomTypeEnum.BOUNDARY_POINT);e.drawingGroups.push(c);for(v=u.set,l=0;l<v.length;l++){(w=v[l]).ghi=u.ghi,c.tEi.push(w);for(b=0;b<w.count;b++)e.vertexIndexArray[o++]=this.indexBuffer[w.start+b]}}return e}return null};var wr=function(){};wr.prototype.gss=function(t){return null};var br=function(){};br.prototype.gss=function(t){var i=t.qts();i<0&&(i=-i-2),t.skip(i-4)};var dr={Srs:0,Ors:1,prs:2,krs:3,FACES:4,yrs:5},Ar=["BOUNDARY_EDGE","SHARP_EDGE","SMOOTH_EDGE","BOUNDARY_POINT","SHARP_POINT","SMOOTH_POINT","SURFACIC_POINT","FREE_POINT","WIRE_EDGE","INFINITE_FACE","FACE","EDGE","ISOPAR","UNKNOWN"],mr=function(){this.indices=[],this.cgmId=-1,this.count=0,this.start=0,this.material=null,this.connectivity=t.ConnectivityTypeEnum.TRIANGLES,this.gas=null,this.decoration=0,this.boundingSphere=null};mr.prototype.constructor=mr;var Mr=function(){mr.call(this),this.qrs=null};Mr.prototype=Object.create(mr.prototype),Mr.prototype.constructor=Mr;var yr=[],Or=[],pr=[];Mr.prototype.gss=function(t){var i=t.tis(),s=1&i,r=2&i,n=4&i,h=8&i,e=(t.Vts(),0);s&&(e=t.qts());var a=0;r&&(a=t.qts());var f=0;n&&(f=t.qts());t.qts();h&&(this.qrs=new Array(3),t.readFloatArray(0,3,this.qrs));var o=e,u=0,c=0;if(t.version>=2100170||t.version>=1101910&&t.version<21e5){for(var v=0;v<a;++v){var l=t.qts();yr[v]=l,c+=l,o+=l-2}for(v=0;v<f;++v){var w=t.qts();Or[v]=w,u+=w,o+=w-2}}else{for(v=0;v<a;++v){l=t._is();yr[v]=l,c+=l,o+=l-2}for(v=0;v<f;++v){w=t._is();Or[v]=w,u+=w,o+=w-2}}if(!(o<=0)){this.indices=new Array(3*o);var b=3*e;t.Eis(b,this.indices,0),t.Eis(c+u,pr,0);var d=0;for(v=0;v<a;++v){l=yr[v];d+=2;for(var A=2;A<l;++A)A%2?(this.indices[b++]=pr[d],this.indices[b++]=pr[d-1],this.indices[b++]=pr[d-2]):(this.indices[b++]=pr[d-1],this.indices[b++]=pr[d],this.indices[b++]=pr[d-2]),d++}for(v=0;v<f;++v){var m=d;w=Or[v];d+=2;for(A=2;A<w;++A)this.indices[b++]=pr[m],this.indices[b++]=pr[d-1],this.indices[b++]=pr[d],d++}}};var kr=function(){};kr.prototype.gss=function(t){var i=t.cis(),s=t._is();t.lis(s);var r=(new Mr).gss(t);return t.lis(i),r};var Sr=function(){mr.call(this),this.connectivity=t.ConnectivityTypeEnum.LINES};Sr.prototype=Object.create(mr.prototype),Sr.prototype.constructor=Sr;var gr=[];Sr.prototype.gss=function(t){var i=t.qts();if(i>0){t.Eis(i,gr,0);var s=1;if(i>1){this.indices=new Array(2*(i-1));this.indices[0]=gr[0];for(var r=2;r<i;++r){var n=gr[r-1];this.indices[s++]=n,this.indices[s++]=n}this.indices[s++]=gr[i-1]}else this.indices=[]}t.version>=210021300&&t.Ais()},Sr.prototype.skip=function(t){var i=t.qts();i>0&&t.Eis(i,gr,0),t.version>=210021300&&t.Ais()};var jr=function(){mr.call(this),this.connectivity=t.ConnectivityTypeEnum.LINES,this.posBuffer=[]};jr.prototype=Object.create(mr.prototype),jr.prototype.constructor=jr,jr.prototype.gss=function(t){var i=t.qts(),s=t.qts(),r=0;if(i)switch(s){case 0:for(var n=0;n<i;++n)this.indices.push(r++),this.posBuffer.push(t.readFloat()),this.posBuffer.push(t.readFloat()),this.posBuffer.push(t.readFloat());break;case 1:if(i>0){this.posBuffer.push(t.readFloat()),this.posBuffer.push(t.readFloat()),this.posBuffer.push(t.readFloat());for(n=1;n<i;++n)this.indices.push(r++),this.indices.push(r),this.posBuffer.push(t.readFloat()),this.posBuffer.push(t.readFloat()),this.posBuffer.push(t.readFloat())}break;case 2:if(i>0){this.posBuffer.push(t.readFloat()),this.posBuffer.push(t.readFloat()),this.posBuffer.push(t.readFloat());for(n=1;n<i;++n)this.indices.push(r++),this.posBuffer.push(t.readFloat()),this.posBuffer.push(t.readFloat()),this.posBuffer.push(t.readFloat()),this.indices.push(r);this.indices.push(r),this.indices.push(0)}}},jr.prototype.skip=function(t){var i=t.qts();t.qts();i&&t.skip(4*i*3)};var Ir=function(){mr.call(this),this.connectivity=t.ConnectivityTypeEnum.POINTS,this.posBuffer=null,this.symbol=0};Ir.prototype=Object.create(mr.prototype),Ir.prototype.constructor=Ir,Ir.prototype.skip=function(t){t.qts();var i=t.qts();t.skip(3*i*4)},Ir.prototype.gss=function(i){this.symbol=i.qts(),this.start=this.indices.length,this.connectivity=t.ConnectivityTypeEnum.POINTS;var s=i.qts();this.posBuffer=new Array(3*s),i.readFloatArray(0,3*s,this.posBuffer);for(var r=0;r<s;++r)this.indices.push(r)};var Nr=function(){mr.call(this),this.connectivity=t.ConnectivityTypeEnum.TRIANGLES,this.posBuffer=[]};Nr.prototype=Object.create(mr.prototype),Nr.prototype.constructor=Nr,Nr.prototype.gss=function(t){t.readFloat(),t.readFloat(),t.readFloat(),t.readFloat(),t.readFloat(),t.readFloat(),t.readFloat(),t.readFloat(),t.readFloat(),t.readFloat(),t.tis()},Nr.prototype.skip=function(t){t.skip(40),t.tis()};var xr=function(t){Cs.call(this),this.rep=new Zs(t)};xr.prototype=Object.create(Cs.prototype),xr.prototype.constructor=xr,xr.prototype.gss=function(t){(this.rep.gss(t),t.version>=1000800)&&(t.tis()&&(this.rep.node.matrix=t.nis()));t.$is(this.rep.node.matrix);for(var i=t.qts(),s=0;s<i;++s){if(1==t.tis()){var r=t.qts();if(t.Pts.Uns(r)){if(a=t.Pts.get(r)){if(!t.xts&&!this.rep.node.noShow){var n=a.clone();this.$qe(n,!1,t),this.rep.children.push(n);continue}this.rep.children.push(a)}}else{var h=t.$ts(),e=t.iis(h);if(t.error)return!1;var a=e.gss(t,this.rep.node.noShow);if(t.error)return!1;if(t.Pts.Dns(a,r),a)if(a.length)for(var f=0;f<a.length;f++)this.rep.children.push(a[f]);else this.rep.children.push(a)}}else{h=t.$ts(),e=t.iis(h);if(t.error)return!1;var o=e.gss(t,this.rep.node.noShow);if(t.error)return!1;if(o)if(o.length)for(f=0;f<o.length;f++)this.rep.children.push(o[f]);else this.rep.children.push(o)}}t.version>=210021330&&(t.tis()&&(v?(this.rep.node.uuid_1=t.ris(),this.rep.node.uuid_2=t.ris(),this.rep.node.uuid_3=t.ris(),this.rep.node.uuid_4=t.ris()):t.skip(16)));return t.Zis(),t.Kis(),t.tss(),this.rep},xr.prototype.Ons=function(t){var i=t.sgRep,s=t.nbRep++;return i.push(this.rep.node.cgmId+1),i.push(this.rep.node.solid),i.push(this.rep.node.namingContext),a&&i.push(this.rep.node.sag),e&&(i.push(this.rep.boundingSphere.radius),i.push(this.rep.boundingSphere.center[0]),i.push(this.rep.boundingSphere.center[1]),i.push(this.rep.boundingSphere.center[2])),s},xr.prototype.Cns=function(t,i){var s=t.sgRep,r=t.nbRep++,n=3;e&&(n+=4),a&&(n+=1);for(var h=i*n,f=0;f<n;f++)s.push(s[h++]);return r},xr.prototype.$qe=function(t,i,s){var r=!i;if(t){if(t.node.noShow)return;if(r&&(s.Lis(t.kns,t.pns),s.$is(t.node.matrix),s.Qis(t.material,t.Sns,t.layer,t)),t instanceof Ks){var n=null;if(-1!==t.yns){if((f=s.Xrn(t.yns,t.renderType)).thn){var h=s.Kis();h.inherited.FJe(0),s.Lis(h.inherited,h.Vis)}(n=f.clone()).rep=this.Cns(s,t.node);for(var e=0;e<n.drawingGroups.length;++e){var a=n.drawingGroups;a[e].material&&a[e].material.ors||(a[e].material=s.hss())}}if(t.axisSystems){var f,o=(f=s.axisSystems.get(t.axisSystems)).axis;(n={axis:{origin:[o.origin[0],o.origin[1],o.origin[2]],VJi:[o.VJi[0],o.VJi[1],o.VJi[2]],OJi:[o.OJi[0],o.OJi[1],o.OJi[2]],UJi:[o.UJi[0],o.UJi[1],o.UJi[2]],color:o.color},globalMatrix:s.nss()}).rep=t.node}if(t.curvedPipe>-1){var u=s.curvedPipes.get(t.curvedPipe);(n={curveVertices:u.curveVertices,startNormal:u.startNormal,endNormal:u.endNormal,radius:u.radius,startSideVector:u.startSideVector,matId:u.matId,gas:u.gas,globalMatrix:s.nss()}).rep=t.node}if(t.mns){var c=s.mns.get(t.mns);(n={type:c.type,DYi:c.DYi,Gns:c.Gns,matId:c.matId,gas:c.gas,globalMatrix:s.nss()}).rep=t.node}return null==n?(s.Zis(),s.tss(),s.Kis(),null):(this.Ans(s,n),void(r&&(s.Kis(),s.tss(),s.Zis())))}}var v=t.children.length;for(e=0;e<v;e++)this.$qe(t.children[e],!1,s);r&&(s.Kis(),s.tss(),s.Zis())};var Tr=function(t){xr.call(this),this.rep=new Zs(t)};Tr.prototype=Object.create(xr.prototype),Tr.prototype.constructor=Tr,Tr.prototype.gss=function(t){var i=t.Yts();if(t.Xts(),xr.prototype.gss.call(this,t),t.version<210021340)t.readFloat();else t.readFloat(),t.readFloat();if(1==t.tis())t.readFloat(),t.readFloat(),t.readFloat();return t.Hts(i),this.rep};var Rr=function(t){xr.call(this),this.rep=new Zs(t)};Rr.prototype=Object.create(xr.prototype),Rr.prototype.constructor=Fr,Rr.prototype.gss=function(t){xr.prototype.gss.call(this,t);var i=t.qts();if(i>0){var s=t.Yts();t.Xts();for(var r=0;r<i;r++){t.readFloat();var n=t.$ts(),h=t.iis(n).gss(t,this.rep.node.noShow);if(t.error)return!1;h&&this.rep.children.push(h)}t.Hts(s)}return this.rep};var Er=function(t){};Er.prototype=Object.create(xr.prototype),Er.prototype.constructor=Fr,Er.prototype.gss=function(t){var i=new ur;if(i.rep.gss(t),t.Ais()){var s=new Gi;s.gss(t)}var r=t.X9e(),n=r.getDisplayedColor(),h=s.primitive;return i.refPlane.push({rep:i.rep.node,origin:h.origin,VJi:h.direction1,OJi:h.direction2,label:h.label,noShow:r.isHidden(),ans:h.ans,color:n,lengthX:h.lengthX,lengthY:h.lengthY,mode:h.mode,KZi:h.mode===ht,type:"CAT3DReferencePlaneRep"}),i.$qe(t),null};var Fr=function(t){xr.call(this),this.rep=new Zs(t)};Fr.prototype=Object.create(xr.prototype),Fr.prototype.constructor=Fr,Fr.prototype.gss=function(t){this.rep.gss(t);var s=t.iss();t.sss(!1);var r=t.qts();if(r>0){var n=t.$ts(),h=t.iis(n).gss(t,this.rep.node.noShow);if(t.error)return!1;h&&this.rep.children.push(h);t.readFloat()}if(r>1){var e=t.Yts();for(t.Xts(),i=1;i<r;i++){n=t.$ts(),h=t.iis(n).gss(t,this.rep.node.noShow);if(t.error)return!1;h&&this.rep.children.push(h);t.readFloat()}t.Hts(e)}return t.Zis(),t.Kis(),t.tss(),t.sss(s),this.rep};var _r=function(t){this.rep=new Zs(t)};_r.prototype=Object.create(xr.prototype),_r.prototype.constructor=_r,_r.prototype.Lns=function(t){for(var i=t.qts(),r=0;r<i;++r){if(t.tis()){var n=t.qts();if(!t.Rts.Uns(n)||!t.Pts.Uns(n))if(t.Rts.Dns(!0,n),112==(h=t.$ts()))t.iis(h).gss(t,!0);else(new br).gss(t)}else{var h;if(112==(h=t.$ts()))t.iis(h).gss(t,!0);else(new br).gss(t)}}var e=t.qts();if(t.readFloatArray(0,3,[]),1==e&&(t.Cis(t.tss()),t.Ets.push(new s.Matrix4)),t.version>=1101500)t.qts(),t.qts(),t.qts()},_r.prototype.gss=function(t){(this.rep.gss(t),t.version>=1000800)&&(t.tis()&&(this.rep.node.matrix=t.nis()));t.$is(this.rep.node.matrix);var i=t.getCurrentPosition();this.Lns(t,[]),t.Qts(i);for(var s=t.qts(),r=0;r<s;++r){if(t.tis()){var n=t.qts();if(t.Pts.Uns(n)){if(a=t.Pts.get(n)){if(!t.xts){var h=a.clone();this.$qe(h,!1,t)}this.rep.children.push(a)}}else{var e=t.$ts(),a=t.iis(e).gss(t);t.Pts.Dns(a,n),a&&this.rep.children.push(a)}}else{e=t.$ts();var f=t.iis(e).gss(t);f&&this.rep.children.push(f)}}t.Zis(),t.Kis(),t.tss();var o=t.qts();if(t.readFloatArray(0,3,[]),o&&t.Gis(),t.version>=1101500)t.qts(),t.qts(),t.qts();return this.rep};var Pr=function(t){this.rep=new Ws(t)};Pr.prototype=Object.create(xr.prototype),Pr.prototype.constructor=Pr,Pr.prototype.gss=function(t,i){(this.rep.gss(t),t.version>=1000800)&&(t.tis()&&(this.rep.node.matrix=t.eis()));t.$is(this.rep.node.matrix);for(var s=t.qts(),r=0;r<s;++r){if(1==t.tis()){var n=t.qts();if(t.Pts.Uns(n)){if(i)continue;if(a=t.Pts.get(n)){if(!t.xts){var h=a.clone();this.$qe(h,!1,t)}this.rep.children.push(a)}}else{var e=t.$ts();if(i){if(t.Rts.Uns(n))continue;if(112==e){t.iis(e).gss(t,!0),t.Rts.Dns(!0,n);continue}(new br).gss(t);continue}var a=t.iis(e).gss(t);t.Pts.Dns(a,n),a&&this.rep.children.push(a)}}else{e=t.$ts();if(i){if(112==e){t.iis(e).gss(t,!0);continue}(new br).gss(t);continue}var f=t.iis(e).gss(t);f&&this.rep.children.push(f)}}return t.Zis(),t.Kis(),t.tss(),this.rep};var Ur=function(){Ys.call(this),this.gp=[]};Ur.prototype=Object.create(Ys.prototype),Ur.prototype.constructor=Ur,Ur.prototype.build=function(i){var s=new t.Mesh,r=i.hss(),n=i.X9e();n.setBasic(),n.setConnectivity(this.gp.primitive.connectivity);var h=new t.DrawingGroup(n,r,this.gp.primitive.connectivity==t.ConnectivityTypeEnum.LINES?1:4,0,this.gp.primitive.indices.length),e=new t.wns(this.gp.node.cgmId,h,0,this.gp.primitive.indices.length);this.gp.decoration&&(e.decoration=this.gp.decoration),this.gp.boundingSphere&&(e.boundingSphere=this.gp.boundingSphere),h.tEi.push(e),s.drawingGroups.push(h),s.vertexIndexArray=this.gp.primitive.indices,s.vertexPositionArray=this.gp.vertexBuffer.posBuffer,s.vertexNormalArray=this.gp.vertexBuffer.Hss,s.gas=n;var a=[0,0,0],f=[0,0,0],o=(a=[0,0,0],f=[0,0,0],s.vertexPositionArray.length);if(o>=3){a=[s.vertexPositionArray[0],s.vertexPositionArray[1],s.vertexPositionArray[2]],f=[s.vertexPositionArray[0],s.vertexPositionArray[1],s.vertexPositionArray[2]];for(var u=0;u<o;u+=3)s.vertexPositionArray[u]<a[0]&&(a[0]=s.vertexPositionArray[u]),s.vertexPositionArray[u+1]<a[1]&&(a[1]=s.vertexPositionArray[u+1]),s.vertexPositionArray[u+2]<a[2]&&(a[2]=s.vertexPositionArray[u+2]),s.vertexPositionArray[u]>f[0]&&(f[0]=s.vertexPositionArray[u]),s.vertexPositionArray[u+1]>f[1]&&(f[1]=s.vertexPositionArray[u+1]),s.vertexPositionArray[u+2]>f[2]&&(f[2]=s.vertexPositionArray[u+2])}return a[2]=-.01,f[2]=.01,s.AABB={min:a,max:f},s};var Dr=function(){Ys.call(this),this.gp=[]};Dr.prototype=Object.create(Ys.prototype),Dr.prototype.constructor=Dr,Dr.prototype.build=function(i){var s=new t.Mesh,r=i.hss(),n=i.X9e();n.setConnectivity(this.gp.primitive.connectivity);var h=new t.DrawingGroup(n,r,this.gp.primitive.connectivity==t.ConnectivityTypeEnum.LINES?1:4,0,this.gp.primitive.indices.length),e=new t.wns(this.gp.node.cgmId,h,0,this.gp.primitive.indices.length);this.gp.decoration&&(e.decoration=this.gp.decoration),this.gp.boundingSphere&&(e.boundingSphere=this.gp.boundingSphere),h.tEi.push(e),s.drawingGroups.push(h),s.vertexIndexArray=this.gp.primitive.indices,s.vertexPositionArray=this.gp.vertexBuffer.posBuffer,s.vertexNormalArray=this.gp.vertexBuffer.Hss,s.gas=n;var a=[0,0,0],f=[0,0,0],o=(a=[0,0,0],f=[0,0,0],s.vertexPositionArray.length);if(o>=3){a=[s.vertexPositionArray[0],s.vertexPositionArray[1],s.vertexPositionArray[2]],f=[s.vertexPositionArray[0],s.vertexPositionArray[1],s.vertexPositionArray[2]];for(var u=0;u<o;u+=3)s.vertexPositionArray[u]<a[0]&&(a[0]=s.vertexPositionArray[u]),s.vertexPositionArray[u+1]<a[1]&&(a[1]=s.vertexPositionArray[u+1]),s.vertexPositionArray[u+2]<a[2]&&(a[2]=s.vertexPositionArray[u+2]),s.vertexPositionArray[u]>f[0]&&(f[0]=s.vertexPositionArray[u]),s.vertexPositionArray[u+1]>f[1]&&(f[1]=s.vertexPositionArray[u+1]),s.vertexPositionArray[u+2]>f[2]&&(f[2]=s.vertexPositionArray[u+2])}return a[2]=-.01,f[2]=.01,s.AABB={min:a,max:f},s};var Cr=function(){Ys.call(this),this.gp=[]};Cr.prototype=Object.create(Ys.prototype),Cr.prototype.constructor=Cr,Cr.prototype.build=function(i){var s=new t.Mesh,r=i.hss(),n=i.X9e();n.setBasic(),n.setConnectivity(this.gp.primitive.connectivity);var h=new t.DrawingGroup(n,r,this.gp.primitive.connectivity==t.ConnectivityTypeEnum.LINES?1:4,0,this.gp.primitive.indices.length),e=new t.wns(this.gp.node.cgmId,h,0,this.gp.primitive.indices.length);this.gp.decoration&&(e.decoration=this.gp.decoration),this.gp.boundingSphere&&(e.boundingSphere=this.gp.boundingSphere),h.tEi.push(e),s.drawingGroups.push(h),s.vertexIndexArray=this.gp.primitive.indices,s.vertexPositionArray=this.gp.vertexBuffer.posBuffer,s.vertexNormalArray=this.gp.vertexBuffer.Hss,s.gas=n;var a=[0,0,0],f=[0,0,0],o=(a=[0,0,0],f=[0,0,0],s.vertexPositionArray.length);if(o>=3){a=[s.vertexPositionArray[0],s.vertexPositionArray[1],s.vertexPositionArray[2]],f=[s.vertexPositionArray[0],s.vertexPositionArray[1],s.vertexPositionArray[2]];for(var u=0;u<o;u+=3)s.vertexPositionArray[u]<a[0]&&(a[0]=s.vertexPositionArray[u]),s.vertexPositionArray[u+1]<a[1]&&(a[1]=s.vertexPositionArray[u+1]),s.vertexPositionArray[u+2]<a[2]&&(a[2]=s.vertexPositionArray[u+2]),s.vertexPositionArray[u]>f[0]&&(f[0]=s.vertexPositionArray[u]),s.vertexPositionArray[u+1]>f[1]&&(f[1]=s.vertexPositionArray[u+1]),s.vertexPositionArray[u+2]>f[2]&&(f[2]=s.vertexPositionArray[u+2])}return a[2]=-.01,f[2]=.01,s.AABB={min:a,max:f},s};var Gr=function(){Ys.call(this),this.gp=null,this.mat=!1};(Gr.prototype=Object.create(Ys.prototype)).constructor=Gr,Gr.prototype.gss=function(t){if(t.Ais()){var i=null;(t.version>=1101860&&t.version<21e5||t.version>=2100170?(i=new ps).gss(t):(i=new ks).gss(t))&&(this.gp=i)}if(t.Ais()){var s=(new Vt).gss(t),r={file:"",id:t.materials.add(s)};if(t.Qis(r,1,0,this.rep),this.mat=!0,s&&void 0!==s.textureId&&this.gp&&this.gp.primitive&&6==this.gp.primitive.count){var n=this.gp.vertexBuffer.Yss;n.push(0),n.push(0),n.push(0),n.push(1),n.push(0),n.push(0),n.push(1),n.push(1),n.push(0),n.push(0),n.push(1),n.push(0)}}};var Lr=function(){Ys.call(this),this.gp=[],this.mat=!1};Lr.prototype=Object.create(Ys.prototype),Lr.prototype.constructor=Lr,Lr.prototype.Grs=function(t){if(t.Ais()){var i=new Gr;i.gss(t),i.gp&&(this.gp.push(i.gp),this.mat=i.mat)}},Lr.prototype.build=function(i){var s=new t.Mesh,r=i.hss();this.mat&&i.Zis();var n=i.X9e();n.lss()&&n.setBasic(),n.setConnectivity(this.gp[0].primitive.connectivity);var h=new t.DrawingGroup(n,r,this.gp[0].primitive.connectivity==t.ConnectivityTypeEnum.LINES?1:4,0,this.gp[0].primitive.indices.length),e=new t.wns(this.gp[0].node.cgmId,h,0,this.gp[0].primitive.indices.length);this.gp[0].decoration&&(e.decoration=this.gp.decoration),this.gp[0].boundingSphere&&(e.boundingSphere=this.gp[0].boundingSphere),h.tEi.push(e),s.drawingGroups.push(h),s.vertexIndexArray=this.gp[0].primitive.indices,s.vertexPositionArray=this.gp[0].vertexBuffer.posBuffer,s.vertexNormalArray=this.gp[0].vertexBuffer.Hss,s.vertexUvArray=this.gp[0].vertexBuffer.Yss,s.gas=n;var a=[0,0,0],f=[0,0,0],o=(a=[0,0,0],f=[0,0,0],s.vertexPositionArray.length);if(o>=3){a=[s.vertexPositionArray[0],s.vertexPositionArray[1],s.vertexPositionArray[2]],f=[s.vertexPositionArray[0],s.vertexPositionArray[1],s.vertexPositionArray[2]];for(var u=0;u<o;u+=3)s.vertexPositionArray[u]<a[0]&&(a[0]=s.vertexPositionArray[u]),s.vertexPositionArray[u+1]<a[1]&&(a[1]=s.vertexPositionArray[u+1]),s.vertexPositionArray[u+2]<a[2]&&(a[2]=s.vertexPositionArray[u+2]),s.vertexPositionArray[u]>f[0]&&(f[0]=s.vertexPositionArray[u]),s.vertexPositionArray[u+1]>f[1]&&(f[1]=s.vertexPositionArray[u+1]),s.vertexPositionArray[u+2]>f[2]&&(f[2]=s.vertexPositionArray[u+2])}return a[2]=-.01,f[2]=.01,s.AABB={min:a,max:f},s};var Vr=function(){Ys.call(this),this.gp=[]};Vr.prototype=Object.create(Ys.prototype),Vr.prototype.constructor=Vr,Vr.prototype.build=function(i){var s=new t.Mesh,r=i.hss(),n=i.X9e();n.setConnectivity(this.gp.primitive.connectivity);var h=new t.DrawingGroup(n,r,this.gp.primitive.connectivity==t.ConnectivityTypeEnum.LINES?1:4,0,this.gp.primitive.indices.length),e=new t.wns(this.gp.node.cgmId,h,0,this.gp.primitive.indices.length);this.gp.decoration&&(e.decoration=this.gp.decoration),this.gp.boundingSphere&&(e.boundingSphere=this.gp.boundingSphere),h.tEi.push(e),s.drawingGroups.push(h),s.vertexIndexArray=this.gp.primitive.indices,s.vertexPositionArray=this.gp.vertexBuffer.posBuffer,s.vertexNormalArray=this.gp.vertexBuffer.Hss,s.gas=n;var a=[0,0,0],f=[0,0,0],o=(a=[0,0,0],f=[0,0,0],s.vertexPositionArray.length);if(o>=3){a=[s.vertexPositionArray[0],s.vertexPositionArray[1],s.vertexPositionArray[2]],f=[s.vertexPositionArray[0],s.vertexPositionArray[1],s.vertexPositionArray[2]];for(var u=0;u<o;u+=3)s.vertexPositionArray[u]<a[0]&&(a[0]=s.vertexPositionArray[u]),s.vertexPositionArray[u+1]<a[1]&&(a[1]=s.vertexPositionArray[u+1]),s.vertexPositionArray[u+2]<a[2]&&(a[2]=s.vertexPositionArray[u+2]),s.vertexPositionArray[u]>f[0]&&(f[0]=s.vertexPositionArray[u]),s.vertexPositionArray[u+1]>f[1]&&(f[1]=s.vertexPositionArray[u+1]),s.vertexPositionArray[u+2]>f[2]&&(f[2]=s.vertexPositionArray[u+2])}return a[2]=-.01,f[2]=.01,s.AABB={min:a,max:f},s};var Br=function(){Hs.call(this),this.gp=[]};Br.prototype=Object.create(Hs.prototype),Br.prototype.constructor=Br,Br.prototype.build=function(i){var s=new t.Mesh,r=i.X9e(),n=i.hss();r.setConnectivity(0);var h=new t.DrawingGroup(r,n,4,0,this.gp.primitive.indices.length),e=new t.wns(this.gp.node.cgmId,h,0,this.gp.primitive.indices.length);this.gp.decoration&&(e.decoration=this.gp.decoration),this.gp.boundingSphere&&(e.boundingSphere=this.gp.boundingSphere),h.tEi.push(e),s.drawingGroups.push(h),s.vertexIndexArray=this.gp.primitive.indices,s.vertexPositionArray=this.gp.vertexBuffer.posBuffer,s.vertexNormalArray=this.gp.vertexBuffer.Hss,s.vertexUvArray=this.gp.vertexBuffer.Yss,s.gas=r;var a=[0,0,0],f=[0,0,0],o=(a=[0,0,0],f=[0,0,0],s.vertexPositionArray.length);if(o>=3){a=[s.vertexPositionArray[0],s.vertexPositionArray[1],s.vertexPositionArray[2]],f=[s.vertexPositionArray[0],s.vertexPositionArray[1],s.vertexPositionArray[2]];for(var u=0;u<o;u+=3)s.vertexPositionArray[u]<a[0]&&(a[0]=s.vertexPositionArray[u]),s.vertexPositionArray[u+1]<a[1]&&(a[1]=s.vertexPositionArray[u+1]),s.vertexPositionArray[u+2]<a[2]&&(a[2]=s.vertexPositionArray[u+2]),s.vertexPositionArray[u]>f[0]&&(f[0]=s.vertexPositionArray[u]),s.vertexPositionArray[u+1]>f[1]&&(f[1]=s.vertexPositionArray[u+1]),s.vertexPositionArray[u+2]>f[2]&&(f[2]=s.vertexPositionArray[u+2])}return a[2]=-.01,f[2]=.01,s.AABB={min:a,max:f},s};var zr=function(){Ys.call(this),this.gp=[]};zr.prototype=Object.create(Ys.prototype),zr.prototype.constructor=zr,zr.prototype.build=function(i){var s=new t.Mesh,r=i.X9e();r.setConnectivity(this.gp.primitive.connectivity);var n=i.hss(),h=new t.DrawingGroup(r,n,4,0,this.gp.primitive.indices.length),e=new t.wns(this.gp.node.cgmId,h,0,this.gp.primitive.indices.length);this.gp.decoration&&(e.decoration=this.gp.decoration),this.gp.boundingSphere&&(e.boundingSphere=this.gp.boundingSphere),h.tEi.push(e),s.drawingGroups.push(h),s.vertexIndexArray=this.gp.primitive.indices,s.vertexPositionArray=this.gp.vertexBuffer.posBuffer,s.vertexNormalArray=this.gp.vertexBuffer.Hss,s.vertexUvArray=this.gp.vertexBuffer.Yss,s.gas=r;var a=[0,0,0],f=[0,0,0],o=(a=[0,0,0],f=[0,0,0],s.vertexPositionArray.length);if(o>=3){a=[s.vertexPositionArray[0],s.vertexPositionArray[1],s.vertexPositionArray[2]],f=[s.vertexPositionArray[0],s.vertexPositionArray[1],s.vertexPositionArray[2]];for(var u=0;u<o;u+=3)s.vertexPositionArray[u]<a[0]&&(a[0]=s.vertexPositionArray[u]),s.vertexPositionArray[u+1]<a[1]&&(a[1]=s.vertexPositionArray[u+1]),s.vertexPositionArray[u+2]<a[2]&&(a[2]=s.vertexPositionArray[u+2]),s.vertexPositionArray[u]>f[0]&&(f[0]=s.vertexPositionArray[u]),s.vertexPositionArray[u+1]>f[1]&&(f[1]=s.vertexPositionArray[u+1]),s.vertexPositionArray[u+2]>f[2]&&(f[2]=s.vertexPositionArray[u+2])}return a[2]=-.01,f[2]=.01,s.AABB={min:a,max:f},s};var Hr=function(){Ys.call(this),this.gp=[]};Hr.prototype=Object.create(Ys.prototype),Hr.prototype.constructor=Hr,Hr.prototype.build=function(i){var s=new t.Mesh,r=i.hss(),n=i.X9e();n.setBasic(),n.setConnectivity(this.gp.primitive.connectivity);var h=new t.DrawingGroup(n,r,this.gp.primitive.connectivity==t.ConnectivityTypeEnum.LINES?1:4,0,this.gp.primitive.indices.length),e=new t.wns(this.gp.node.cgmId,h,0,this.gp.primitive.indices.length);this.gp.decoration&&(e.decoration=this.gp.decoration),this.gp.boundingSphere&&(e.boundingSphere=this.gp.boundingSphere),h.tEi.push(e),s.drawingGroups.push(h),s.vertexIndexArray=this.gp.primitive.indices,s.vertexPositionArray=this.gp.vertexBuffer.posBuffer,s.vertexNormalArray=this.gp.vertexBuffer.Hss,s.gas=n;var a=[0,0,0],f=[0,0,0],o=(a=[0,0,0],f=[0,0,0],s.vertexPositionArray.length);if(o>=3){a=[s.vertexPositionArray[0],s.vertexPositionArray[1],s.vertexPositionArray[2]],f=[s.vertexPositionArray[0],s.vertexPositionArray[1],s.vertexPositionArray[2]];for(var u=0;u<o;u+=3)s.vertexPositionArray[u]<a[0]&&(a[0]=s.vertexPositionArray[u]),s.vertexPositionArray[u+1]<a[1]&&(a[1]=s.vertexPositionArray[u+1]),s.vertexPositionArray[u+2]<a[2]&&(a[2]=s.vertexPositionArray[u+2]),s.vertexPositionArray[u]>f[0]&&(f[0]=s.vertexPositionArray[u]),s.vertexPositionArray[u+1]>f[1]&&(f[1]=s.vertexPositionArray[u+1]),s.vertexPositionArray[u+2]>f[2]&&(f[2]=s.vertexPositionArray[u+2])}return a[2]=-.01,f[2]=.01,s.AABB={min:a,max:f},s};var Yr=function(){Ys.call(this),this.Ins=[],this.vertexBuffer=null,this.drs=[]};Yr.prototype=Object.create(Ys.prototype),Yr.prototype.constructor=Yr,Yr.prototype.wrs=function(i,s,r){if(i.fns)this.drs.push(this.yOn(i,s,r,this.rep));else{null==this.vertexBuffer&&(this.vertexBuffer=new Wt);for(var n=this.vertexBuffer.posBuffer.length/3,h=i.vertexBuffer,e=0;e<h.posBuffer.length;e++)this.vertexBuffer.posBuffer.push(h.posBuffer[e]),h.Hss.length?this.vertexBuffer.Hss.push(h.Hss[e]):this.vertexBuffer.Hss.push(void 0);var a=[];i.primitives&&i.primitives.length?a=i.primitives:a.push(i.primitive);for(e=0;e<a.length;e++){var f=a[e],o=this.Ins.length;for(l=0;l<o;l++){var u=this.Ins[l];if(u.connectivity==f.connectivity&&u.gas.isEqual(s)&&t.Pns(u.material,f.material)){u.set.push(f),u.nbIndices+=f.indices.length;break}}if(l==this.Ins.length){var c={};c.connectivity=f.connectivity,c.gas=s,c.material=f.material,c.nbIndices=f.indices.length,c.Ens=0,c.set=[],c.set.push(f),this.Ins.push(c)}for(var v=f.indices,l=0;l<v.length;l++)v[l]=v[l]+n}}},Yr.prototype.yOn=function(t,i,r,n){var h=new zr,e=r.nss();if(h.rep.pns=n.pns,h.rep.kns=n.kns,h.rep.Sns=n.Sns,h.rep.pns=n.pns,h.rep.node.noShow=n.node.noShow,h.vertexBuffer=new Wt,h.gp=t,t&&t.primitive){if(void 0!==t.Lrs&&0===t.Lrs&&r.Uis(!0),t.point){var a,f=(new s.Matrix4).setPosition({x:t.point[0],y:t.point[1],z:t.point[2]});a=e?(new s.Matrix4).multiplyMatrices(e,f):f,r.Cis(a),r.Ets.push(new s.Matrix4)}t.primitive.material&&r.Qis(t.primitive.material,1,0,h.rep);var o=h.build(r);h.Ans(r,o),o.rep=h.Ons(r),r.Gis(),t.point&&(r.Ets.pop(),r.Gis()),t.primitive.material&&r.Zis(),r.Uis(!1)}return h.rep},Yr.prototype.build=function(t){return 0==this.Ins.length?null:this.lns(this.vertexBuffer,this.Ins,t)};var Xr=function(){xr.call(this)};Xr.prototype=Object.create(xr.prototype),Xr.prototype.constructor=Xr,Xr.prototype.gss=function(t){t.qts();var i=xr.prototype.gss.call(this,t);t.readFloat();return i};var Jr=function(){xr.call(this)};Jr.prototype=Object.create(xr.prototype),Jr.prototype.constructor=Jr,Jr.prototype.gss=function(t){t.qts();var i=xr.prototype.gss.call(this,t);t.tis();return i};var Wr=function(){Pr.call(this)};Wr.prototype=Object.create(Pr.prototype),Wr.prototype.constructor=Wr,Wr.prototype.gss=function(t){var i=t.qts(),s=Pr.prototype.gss.call(this,t);t.qts();return i=t.qts(),(i=Math.abs(i))>0&&t.skip(4*(2*i+1)),s};var qr=function(){xr.call(this)};qr.prototype=Object.create(xr.prototype),qr.prototype.constructor=qr,qr.prototype.gss=function(t){var i=t.getCurrentPosition()+t.qts()+1,s=xr.prototype.gss.call(this,t);return t.Qts(i),s};var Kr=function(){xr.call(this)};Kr.prototype=Object.create(xr.prototype),Kr.prototype.constructor=Kr,Kr.prototype.gss=function(t){var i=xr.prototype.gss.call(this,t);t.tis();return i};var Zr=function(){qr.call(this)};Zr.prototype=Object.create(qr.prototype),Zr.prototype.constructor=Zr,Zr.prototype.gss=function(t){t.getCurrentPosition(),t.qts();var i=qr.prototype.gss.call(this,t);return t.readFloat(),i};var Qr=function(){xr.call(this)};Qr.prototype=Object.create(xr.prototype),Qr.prototype.constructor=Qr,Qr.prototype.Vns=function(i,r,n){if(r.node instanceof t.SGBag)for(a=0;a<r.children.length;a++)this.Vns(i,r.children[a],n);else{var h=i.Xrn(r.yns,r.renderType).vertexUvArray,e=h?h.length/3:0;if(e>0)for(var a=0,f=0,o=new s.Vector4,a=0;a<e;a++,f+=3)o.set(h[f],h[f+1],h[f+2],1),o.Fm(n),h[f]=o.x/o.w,h[f+1]=o.y/o.w,h[f+2]=o.z/o.w}},Qr.prototype.gss=function(t,i){xr.prototype.gss.call(this,t,i);if(t.Ais()){var s=tn.prototype.gss.call(this,t);void 0!==s.Bns&&this.Vns(t,this.rep,s.Bns)}return this.rep};var $r=function(t){Cs.call(this),this.rep=new Ks(t)};$r.prototype=Object.create(Cs.prototype),$r.prototype.constructor=$r,$r.prototype.zns=function(i){switch(i){case 0:return t.ConnectivityTypeEnum.POINTS;case 1:return t.ConnectivityTypeEnum.LINES;case 2:return t.ConnectivityTypeEnum.LINE_STRIP;case 3:return t.ConnectivityTypeEnum.LINE_LOOP;case 4:return t.ConnectivityTypeEnum.TRIANGLES;case 5:return t.ConnectivityTypeEnum.TRIANGLE_STRIP;case 6:return t.ConnectivityTypeEnum.TRIANGLE_FAN;default:return t.ConnectivityTypeEnum.TRIANGLES}},$r.prototype.Hns=function(i){switch(i){case t.DataTypeEnum.Yns:case t.DataTypeEnum.Xns:return 1;case t.DataTypeEnum.SHORT:case t.DataTypeEnum.Jns:return 2;case t.DataTypeEnum.INT:case t.DataTypeEnum.UINT:case t.DataTypeEnum.FLOAT:return 4;case t.DataTypeEnum.Wns:return 8;default:return 1}},$r.prototype.qns=function(t){},$r.prototype.gss=function(i){i.lis(16777216);var s=i.qts();if(s<=0)return null;var r=[],n=new t.PrimitiveGroup;n.fillAttr=new t.FillAttributes,n.lineAttr=new t.LineAttributes;for(var h=0;h<s;h++){var e=0;(v=new t.Buffer).indexBuffer=i.Ais(),e=i.qts(),v.format=i.tis(),v.dimension=i.tis(),v.size=e*v.dimension;var a=i.Ais();switch(n.dhi(h,v),a){case Rs:v.data=new Float32Array(v.size),i.Sis(e,v.data,0);break;case Es:v.data=new Float32Array(v.size),i.gis(e,v.data,0);break;case Ts:switch(v.format){case t.DataTypeEnum.FLOAT:v.data=new Float32Array(v.size),i.readFloatArray(0,v.size,v.data);break;case t.DataTypeEnum.INT:v.data=new Int32Array(v.size),i.fss(v.size,v.data);break;case t.DataTypeEnum.UINT:v.data=new Uint32Array(v.size),i.fss(v.size,v.data);break;default:v.data=new Uint8Array(v.size),i.pis(v.size,v.data)}}}var f=i.qts();if(f<=0&&s<=0)return this.rep.gss(i),null;for(h=0;h<f;h++){var o=new t.Primitive;o.nbIndices=i.qts(),o.connectivity=this.zns(i.tis());for(var u=i.qts(),c=0;c<u;c++){var v,l=new t.VertexComponent;if(l.component=i.tis(),l.cardinality=i.tis(),l.bufferId=i.qts(),l.offset=i.qts(),l.indices=null,null!==(v=n.Kns(l.bufferId))){var w=this.Hns(v.format);if(v.Zns?l.offset/=w*v.Zns:l.offset/=w*v.dimension,v.component=l.component,(v.component===t.VertexComponentEnum.TEX_COORD_0||v.component===t.VertexComponentEnum.TEX_COORD_1||v.component===t.VertexComponentEnum.TEX_COORD_2||v.component===t.VertexComponentEnum.TEX_COORD_3)&&v.dimension<3){e=v.size/v.dimension;for(var b=new Float32Array(3*e),d=0;d<e;d++)b[3*d]=v.data[v.dimension*d],v.dimension>1?b[3*d+1]=v.data[2*d+1]:b[3*d+1]=0,b[3*d+2]=0;v.data=b,v.size=3*e,v.Zns=v.dimension,v.dimension=3}l.nbValuesPerVertex=v.dimension,l.format=v.format}if(i.Ais()&&(l.indices=new t.IndexArray,l.indices.bufferId=i.qts(),l.indices.offset=i.qts(),null!==(v=n.Kns(l.indices.bufferId)))){w=this.Hns(v.format);l.indices.offset/=w,l.indices.format=v.format}o.addVertexComponent(l)}var A=null;if(i.Ais()){var m=tn.prototype.gss.call(this,i);m.gas&&(A=m.gas)}var M=!1;if(o)o.Qns()&&(M=!0);r.push({prim:o,gas:A,$ns:m.size,symbol:m.symbol,usedVertexColor:M})}this.rep.gss(i);var y=!1;for(h=0;h<r.length;h++){if(r[h].gas){var O;(O=i.Lis(r[h].gas,0)).getDisplayedColor(),O.isTransparent(),O.bss(),O.getType(),O.Xis();O.setConnectivity(r[h].prim.connectivity),O.lss()&&(y=!0),r[h].prim.ghi=O,i.Kis()}else(O=i.X9e()).setConnectivity(r[h].prim.connectivity),r[h].prim.ghi=O;r[h].pointSize&&r[h].prim.ghi.Yis(r.pointSize),r[h].symbol&&r[h].prim.ghi.setSymbol(r[h].symbol),r[h].usedVertexColor&&(r[h].prim.ghi.uss(),r[h].prim.connectivity==t.ConnectivityTypeEnum.POINTS&&(r[h].prim.ghi.setColor(8),r[h].symbol&&r[h].prim.ghi.setSymbol(0),r[h].pointSize||r[h].prim.ghi.Yis(1))),n.Shi(r[h].prim)}if(!y&&0==(O=i.X9e()).getType()){var p=i.Kis();p.inherited.FJe(2),i.Lis(p.inherited,p.Vis)}n.material=i.hss();var k=t.convertToGeometry3js(n,void 0,void 0,void 0,void 0,!0);return k.rep=this.rep.node,this.Ans(i,k),k.rep=this.Ons(i),i.Zis(),i.Kis(),this.rep};var tn=function(){};tn.prototype.constructor=tn,tn.prototype.ths=function(t){for(var i=0;t;)1&t&&i++,t>>=1;return i},tn.prototype.ihs=function(t,i){for(var s=1,r=0;r<i+1;r++){for(;!(1&t);)t>>=1,s<<=1;t>>=1,r!==i&&(s<<=1)}return s},tn.prototype.gss=function(t){for(var i={},r=t.qts(),n=t.getCurrentPosition(),h=t.qts(),e=tn.prototype.ths(r),a=0;a<e;a++){switch(tn.prototype.ihs(r,a)){case Fs:i.gas=t.sis();break;case _s:var f=[];if(t.version>=210021610){var o=t.kis(),u=t.tis(),c=[];t.his(c,u);var v=0;for(a=0,v=0;a<16;a++){switch((o&3<<2*a)>>>2*a){case 0:f.push(c[v++]);break;case 1:f.push(0);break;case 2:f.push(1);break;case 3:f.push(-1)}}}else f=new Float32Array(16),t.readFloatArray(0,16,f);var l=new s.Matrix4;l.set(f[0],f[4],f[8],f[12],f[1],f[5],f[9],f[13],f[2],f[6],f[10],f[14],f[3],f[7],f[11],f[15]),i.Bns=l;break;case Ps:t.qts();break;case Us:i.symbol=t.qts();break;case Ds:i.size=t.qts()}}return t.Qts(n+h),i};var sn=function(){return mn?{sag:mn.sag3D,shs:mn.lrs}:{sag:.2,shs:1}},rn=function(t){switch(t){case"Cuboid":case"Sphere":case"PartialSphere":case"Cone":return!0;case"Cylinder":case"PartialTorus":case"Torus":case"CurvedPipe":return!n}},nn=function(){Hs.call(this)};nn.prototype=Object.create(Hs.prototype),nn.prototype.constructor=nn,nn.prototype.gss=function(t){return this.rep.gss(t),this.infos={bottomCenter:[t.readFloat(),t.readFloat(),t.readFloat()],topCenter:[t.readFloat(),t.readFloat(),t.readFloat()],Lee:t.readFloat(),Fee:t.readFloat()},this.$qe(t)?this.rep:null},nn.prototype.build=function(i){var s=i.hss(),r=i.X9e(),n=this.infos;return!rn("Cone")?{gas:r,matId:s,canonicalType:et,DYi:[n.bottomCenter[0],n.bottomCenter[1],n.bottomCenter[2],n.topCenter[0],n.topCenter[1],n.topCenter[2]],Gns:[n.Lee,n.Fee]}:t.rhs(n.bottomCenter,n.topCenter,n.Lee,n.Fee,r,s,sn(),!0,i.decorations)};var hn=function(){Hs.call(this)};hn.prototype=Object.create(Hs.prototype),hn.prototype.constructor=hn,hn.prototype.gss=function(t){return this.rep.gss(t),this.infos={ohi:[t.readFloat(),t.readFloat(),t.readFloat()],qP:[t.readFloat(),t.readFloat(),t.readFloat()],JP:[t.readFloat(),t.readFloat(),t.readFloat()],nhs:t.readFloat()},this.$qe(t)?this.rep:null},hn.prototype.build=function(i){var s=i.hss(),r=i.X9e(),n=this.infos;return!rn("Cuboid")?{gas:r,matId:s,canonicalType:ft,DYi:[n.ohi[0],n.ohi[1],n.ohi[2],n.qP[0],n.qP[1],n.qP[2],n.JP[0],n.JP[1],n.JP[2]],Gns:[n.nhs]}:t.hhs(n.ohi,n.qP,n.JP,n.nhs,r,s,!0)};var en=function(){Hs.call(this)};en.prototype=Object.create(Hs.prototype),en.prototype.constructor=en,en.prototype.gss=function(t){this.rep.gss(t);for(var i=t.kis(),s=[],r=0;r<3*i;r++)s.push(t.readFloat());return this.infos={ehs:s,ahs:[t.readFloat(),t.readFloat(),t.readFloat()],fhs:[t.readFloat(),t.readFloat(),t.readFloat()],radius:t.readFloat()},this.$qe(t)?this.rep:null},en.prototype.build=function(i){var r=i.hss(),n=i.X9e(),h=this.infos;if(!rn("CurvedPipe")){var e=[-h.ahs[2],h.ahs[0],-h.ahs[1]],a=(h.fhs[2],h.fhs[0],h.fhs[1],[h.ahs[1]*e[2]-h.ahs[2]*e[1],h.ahs[2]*e[0]-h.ahs[0]*e[2],h.ahs[0]*e[1]-h.ahs[1]*e[0]]),f=n.getDisplayedColor(),o=new s.Color;return o.eMi(f[0]/255,f[1]/255,f[2]/255),{gas:{color:o,opacity:f[3]/255},matId:r,curveVertices:h.ehs,startNormal:h.ahs,endNormal:h.fhs,radius:h.radius,startSideVector:a}}for(var u=[],c=[],v=0,l=0;l<h.ehs.length/3;l++)c.push(h.radius),u.push(new s.Vector3(h.ehs[v++],h.ehs[v++],h.ehs[v++]));var w=new s.Vector3(h.ahs[0],h.ahs[1],h.ahs[2]),b=new s.Vector3(h.fhs[0],h.fhs[1],h.fhs[2]);return t.ohs(u,c,w,b,!0,n,r,sn(),!0)};var an=function(){Hs.call(this)};an.prototype=Object.create(Hs.prototype),an.prototype.constructor=an,an.prototype.gss=function(t){return this.rep.gss(t),this.infos={bottomCenter:[t.readFloat(),t.readFloat(),t.readFloat()],topCenter:[t.readFloat(),t.readFloat(),t.readFloat()],radius:t.readFloat()},this.$qe(t)?this.rep:null},an.prototype.build=function(i){var r=i.hss(),h=i.X9e(),e=this.infos,a=[e.topCenter[0]-e.bottomCenter[0],e.topCenter[1]-e.bottomCenter[1],e.topCenter[2]-e.bottomCenter[2]],f=Math.sqrt(a[0]*a[0]+a[1]*a[1]+a[2]*a[2]);a[0]/=f,a[1]/=f,a[2]/=f;var o=[-a[2],a[0],-a[1]],u=[a[1]*o[2]-a[2]*o[1],a[2]*o[0]-a[0]*o[2],a[0]*o[1]-a[1]*o[0]],c=!rn("Cylinder");if(n){var v=h.getDisplayedColor(),l=new s.Color;return l.eMi(v[0]/255,v[1]/255,v[2]/255),{gas:{color:l,opacity:v[3]/255},matId:r,curveVertices:[e.bottomCenter[0],e.bottomCenter[1],e.bottomCenter[2],e.topCenter[0],e.topCenter[1],e.topCenter[2]],startNormal:[-a[0],-a[1],-a[2]],endNormal:a,radius:e.radius,startSideVector:u}}return c?{gas:h,matId:0,canonicalType:at,DYi:[e.bottomCenter[0],e.bottomCenter[1],e.bottomCenter[2],e.topCenter[0],e.topCenter[1],e.topCenter[2]],Gns:[e.radius]}:t.rhs(e.bottomCenter,e.topCenter,e.radius,e.radius,h,r,sn(),!0,i.decorations)};var fn=function(){Hs.call(this)};fn.prototype=Object.create(Hs.prototype),fn.prototype.constructor=fn,fn.prototype.gss=function(t){return this.rep.gss(t),this.infos={center:[t.readFloat(),t.readFloat(),t.readFloat()],qP:[t.readFloat(),t.readFloat(),t.readFloat()],JP:[t.readFloat(),t.readFloat(),t.readFloat()],uhs:t.readFloat(),chs:t.readFloat(),vhs:t.readFloat(),lhs:t.readFloat()},this.$qe(t)?this.rep:null},fn.prototype.build=function(i){var s=i.hss(),r=i.X9e(),n=this.infos;return!rn("PartialSphere")?{gas:r,matId:s,canonicalType:ut,DYi:[n.center[0],n.center[1],n.center[2],n.qP[0],n.qP[1],n.qP[2],n.JP[0],n.JP[1],n.JP[2]],Gns:[n.uhs,n.chs,n.vhs,n.lhs]}:t.whs(n.vhs,n.lhs,n.uhs,n.chs,n.center,n.qP,n.JP,r,s,sn(),!0,i.decorations)};var on=function(){Hs.call(this)};on.prototype=Object.create(Hs.prototype),on.prototype.constructor=on,on.prototype.gss=function(t){return this.rep.gss(t),this.infos={center:[t.readFloat(),t.readFloat(),t.readFloat()],qP:[t.readFloat(),t.readFloat(),t.readFloat()],JP:[t.readFloat(),t.readFloat(),t.readFloat()],lne:t.readFloat(),bhs:t.readFloat()},this.$qe(t)?this.rep:null},on.prototype.build=function(i){var r=i.hss(),h=i.X9e(),e=this.infos,a=!rn("PartialTorus"),f=t.dhs(new s.Vector3(e.center[0],e.center[1],e.center[2]),new s.Vector3(e.qP[0],e.qP[1],e.qP[2]),new s.Vector3(e.JP[0],e.JP[1],e.JP[2]),e.bhs,sn(),e.lne);if(n){var o=h.getDisplayedColor(),u=new s.Color;return u.eMi(o[0]/255,o[1]/255,o[2]/255),{gas:{color:u,opacity:o[3]/255},matId:r,curveVertices:f.ehs,startNormal:f.startNormal,endNormal:f.endNormal,startSideVector:e.qP,radius:e.lne}}if(a)return{gas:h,matId:r,canonicalType:vt,DYi:[e.center[0],e.center[1],e.center[2],e.qP[0],e.qP[1],e.qP[2],e.JP[0],e.JP[1],e.JP[2]],Gns:[e.lne,e.bhs]};for(var c=[],v=[],l=0,w=0;w<f.ehs.length/3;w++)v.push(e.lne),c.push(new s.Vector3(f.ehs[l++],f.ehs[l++],f.ehs[l++]));var b=new s.Vector3(f.startNormal[0],f.startNormal[1],f.startNormal[2]),d=new s.Vector3(f.endNormal[0],f.endNormal[1],f.endNormal[2]);return t.ohs(c,v,b,d,!0,h,r,sn(),!0,i.decorations,e)};var un=function(){Hs.call(this)};un.prototype=Object.create(Hs.prototype),un.prototype.constructor=un,un.prototype.gss=function(t){return this.rep.gss(t),this.infos={center:[t.readFloat(),t.readFloat(),t.readFloat()],radius:t.readFloat()},this.$qe(t)?this.rep:null},un.prototype.build=function(i){var s=i.hss(),r=i.X9e(),n=this.infos;return!rn("Sphere")?{gas:r,matId:s,canonicalType:ot,DYi:n.center,Gns:[n.radius]}:t.whs(-Math.PI/2,Math.PI/2,0,2*Math.PI,n.center,[n.radius,0,0],[0,1,0],r,s,sn(),!0,i.decorations)};var cn=function(){Hs.call(this)};cn.prototype=Object.create(Hs.prototype),cn.prototype.constructor=cn,cn.prototype.gss=function(t){return this.rep.gss(t),this.infos={center:[t.readFloat(),t.readFloat(),t.readFloat()],planeNormal:[t.readFloat(),t.readFloat(),t.readFloat()],lne:t.readFloat()},this.$qe(t)?this.rep:null},cn.prototype.build=function(i){var r=i.hss(),h=i.X9e(),e=this.infos,a=new s.Vector3(e.planeNormal[0],e.planeNormal[1],e.planeNormal[2]),f=a.length();a.normalize();var o=new s.Vector3(-e.planeNormal[2],e.planeNormal[0],-e.planeNormal[1]),u=new s.Vector3;u.crossVectors(a,o),u.normalize();var c=new s.Vector3;c.crossVectors(a,u),c.normalize(),u.multiplyScalar(f),c.multiplyScalar(f);var v=t.dhs(new s.Vector3(e.center[0],e.center[1],e.center[2]),u,c,2*Math.PI,sn(),e.lne),l=!rn("Torus");if(n){var w=h.getDisplayedColor(),b=new s.Color;return b.eMi(w[0]/255,w[1]/255,w[2]/255),{gas:{color:b,opacity:w[3]/255},matId:r,curveVertices:v.ehs,startNormal:v.startNormal,endNormal:v.endNormal,startSideVector:[u.x,u.y,u.z],radius:e.lne}}if(l)return{gas:h,matId:r,canonicalType:ct,DYi:[e.center[0],e.center[1],e.center[2],e.planeNormal[0],e.planeNormal[1],e.planeNormal[2]],Gns:[e.lne]};for(var d=[],A=[],m=0,M=0;M<v.ehs.length/3;M++)A.push(e.lne),d.push(new s.Vector3(v.ehs[m++],v.ehs[m++],v.ehs[m++]));var y=new s.Vector3(v.startNormal[0],v.startNormal[1],v.startNormal[2]);new s.Vector3(v.endNormal[0],v.endNormal[1],v.endNormal[2]);return t.Ahs(new s.Vector3(e.center[0],e.center[1],e.center[2]),d,A,y,h,r,sn(),!0,i.decorations)};var vn=function(t){this.Mss=t.ris(!1);new bt(t);var i=t.ris(!1);this.name=t.Kts(i/2),this.mhs=new At(t,0),this.getId=function(){return this.mhs.id}},ln=function(t,i){this.Mhs=i;var s=t;this.name=i.name;var r=[],n=[];this.header=null,this.ZU=function(t){},this.grs=function(t,r){for(var h=0;h<n.length;++h)if(n[h].name==t){var e=n[h];return r&&e.Qts(0),e}return null!=(e=s.yhs(i,t))&&(null!=this.header&&(e.version=this.header.version,e.conversion=this.header.conversion),e.wis(this),n.push(e)),e},this.yhs=function(){return this.grs(this.name)},this.Ohs=function(i){for(var s=0;s<r.length;++s)if(r[s].name==i)return r[s];var n=t.Ohs(this.Mhs,i);return n&&r.push(n),n},this.phs=function(t){if(!this.header){this.header=t?this.grs(t):this.yhs();var i=this.header.tis();if(this.header.conversion=!i,this.header.version=this.header.ris(),this.header.version>210042510)return{error:"warning cgr version not supported"};this.header.version>=1101310&&this.header.ris()}},this.khs=function(t){this.header=t;var i=this.header.tis();if(this.header.conversion=!i,this.header.version=this.header.ris(),this.header.version>210042510)return{error:"warning ugr version not supported"}},this._ss=function(){var t=s.Shs();return t?t.Ohs("Resources"):null},this.Pss=function(t){var i,s=null,r=t.tis(),n=t.qts();if(t.textures.Ess(n))return i=t.textures.getIndex(n);var h=this.grs("MainCGRResourceStreamer");h.Qts(n),t.rss(h);var e=null;if(h.tis())h.Wts(),h.Wts();else if(r){s=(e=new Gt).gss(h)}else{switch(h.tis()){case mt:break;case Mt:e=new Lt}var a=h.Wts().split("\\"),f=a[a.length-1];null!=e&&(s=e.gss(h,f))}return null!=s?(i=t.textures.add(s),t.textures.Fss(n,i),i):null},this.VJe=function(t,i,s){var r=null,n=this.grs("MainCGRResourceStreamer");t.rss(n),n.Qts(i);var h=n.tis();if(2==h)r=(new Ct).createTexture(n);else if(1==h){r=(new Ut).gss(n)}else if(3==h||4==h||5==h){var e=0;r=null;5==h&&(e=n.kis());var a=n.kis();if(a>0)return r=new Uint8Array(a),n.pis(a,r),{img:r,imgType:h,format:e}}return r},this.zss=function(t){var i=0;t.tis()&&(i=t.qts());var s=this.grs("MainCGRResourceStreamer");if(s.conversion=t.conversion,s.Qts(i),s.version=t.version,!s.tis()){var r=new Xt;r.gss(s)}return r}},wn=[],bn=0,dn=1,An=!1,mn=null,Mn=function(t){this.ghs=t,this.jhs=0,this.position=0,this.Ihs=[],this.Nhs=[],this.currentView=null,this.xhs=null,this.Ths=0,this.Rhs=0,this.Ehs=0,this.Fhs=0,this._hs=0};Mn.prototype.Phs=function(t){var i=this.ghs.hts(t.offset,t.length),s=this.Nhs.length;this.Ihs.length&&this.Ihs[this.Ihs.length-1];this.Nhs=this.Nhs.concat(i);for(var r=s;r<this.Nhs.length;++r)0==r?this.Ihs.push(0):this.Ihs.push(this.Ihs[r-1]+this.Nhs[r-1].lvi.byteLength);null===this.currentView&&(this.currentView=this.Nhs[0].lvi,this.xhs=this.Nhs[0].buffer,this.Ths=this.Nhs[0].offset,this.jhs=0,this.Ehs=this.currentView.byteLength-4,this.Fhs=this.currentView.byteLength-2,this._hs=this.currentView.byteLength-8)},Mn.prototype.Uhs=function(t){this.Nhs.push({lvi:new DataView(t.buffer,0,t.length),buffer:t,offset:0}),this.Ihs.push(0),this.currentView=this.Nhs[0].lvi,this.xhs=this.Nhs[0].buffer,this.Ths=this.Nhs[0].offset,this.jhs=0,this.Ehs=this.currentView.byteLength-4,this.Fhs=this.currentView.byteLength-2,this._hs=this.currentView.byteLength-8},Mn.prototype.Jts=function(){for(var t=this.currentView.byteLength-this.jhs,i=this.Rhs+1;i<this.Nhs.length;i++){if(this.Nhs[i])t+=this.Nhs[i].lvi.byteLength}return t},Mn.prototype.read=function(){return this.jhs<this.currentView.byteLength||(this.Rhs++,this.currentView=this.Nhs[this.Rhs].lvi,this.xhs=this.Nhs[this.Rhs].buffer,this.Ths=this.Nhs[this.Rhs].offset,this.jhs=0,this.Ehs=this.currentView.byteLength-4,this.Fhs=this.currentView.byteLength-2,this._hs=this.currentView.byteLength-8),this.xhs[this.Ths+this.jhs++]},Mn.prototype.getCurrentPosition=function(){return this.Ihs[this.Rhs]+this.jhs},Mn.prototype.setPosition=function(t){for(var i=0,s=0;t>i+this.Nhs[s].lvi.byteLength;)i+=this.Nhs[s].lvi.byteLength,s++;this.Rhs=s,this.currentView=this.Nhs[this.Rhs].lvi,this.xhs=this.Nhs[this.Rhs].buffer,this.Ths=this.Nhs[this.Rhs].offset,this.jhs=t-i,this.Ehs=this.currentView.byteLength-4,this.Fhs=this.currentView.byteLength-2,this._hs=this.currentView.byteLength-8};var yn=new Uint8Array(8),On=new Int32Array(yn.buffer),pn=new Uint32Array(yn.buffer),kn=new Int16Array(yn.buffer),Sn=new Uint16Array(yn.buffer),gn=new Float32Array(yn.buffer),jn=new Float64Array(yn.buffer);Mn.prototype.readDouble=function(t){return t?(yn[7]=this.read(),yn[6]=this.read(),yn[5]=this.read(),yn[4]=this.read(),yn[3]=this.read(),yn[2]=this.read(),yn[1]=this.read(),yn[0]=this.read()):(yn[0]=this.read(),yn[1]=this.read(),yn[2]=this.read(),yn[3]=this.read(),yn[4]=this.read(),yn[5]=this.read(),yn[6]=this.read(),yn[7]=this.read()),jn[0]},Mn.prototype.Dhs=function(t){return t?(yn[3]=this.read(),yn[2]=this.read(),yn[1]=this.read(),yn[0]=this.read()):(yn[0]=this.read(),yn[1]=this.read(),yn[2]=this.read(),yn[3]=this.read()),gn[0]};var In=new Float32Array(1),Nn=new Uint8Array(In.buffer);Mn.prototype.readFloat=function(t){if(this.jhs<this.Ehs){var i=this.Ths+this.jhs;return this.jhs+=4,t?(Nn[3]=this.xhs[i],Nn[2]=this.xhs[i+1],Nn[1]=this.xhs[i+2],Nn[0]=this.xhs[i+3]):(Nn[0]=this.xhs[i],Nn[1]=this.xhs[i+1],Nn[2]=this.xhs[i+2],Nn[3]=this.xhs[i+3]),In[0]}return this.Dhs(t)},Mn.prototype.Chs=function(t){return t?(yn[3]=this.read(),yn[2]=this.read(),yn[1]=this.read(),yn[0]=this.read()):(yn[0]=this.read(),yn[1]=this.read(),yn[2]=this.read(),yn[3]=this.read()),On[0]},Mn.prototype.Ghs=function(t){return t?(yn[3]=this.read(),yn[2]=this.read(),yn[1]=this.read(),yn[0]=this.read()):(yn[0]=this.read(),yn[1]=this.read(),yn[2]=this.read(),yn[3]=this.read()),pn[0]},Mn.prototype.nts=function(t){if(this.jhs<this.Ehs){var i=this.Ths+this.jhs;this.jhs+=4;var s=this.xhs[i],r=this.xhs[i+1],n=this.xhs[i+2],h=this.xhs[i+3];return t?(s<<24)+(r<<16)+(n<<8)+h:(h<<24)+(n<<16)+(r<<8)+s}return this.Chs(t)},Mn.prototype.Tis=function(t){if(this.jhs<this.Ehs){var i=this.currentView.getUint32(this.jhs,!t);return this.jhs+=4,i}return this.Ghs(t)},Mn.prototype.ris=function(t){if(this.jhs<this.Ehs){var i=this.currentView.getUint32(this.jhs,!t);return this.jhs+=4,i}return this.Ghs(t)},Mn.prototype.Lhs=function(t){return t?(yn[0]=this.read(),yn[1]=this.read()):(yn[1]=this.read(),yn[0]=this.read()),Sn[0]},Mn.prototype.Vhs=function(t){return t?(yn[0]=this.read(),yn[1]=this.read()):(yn[1]=this.read(),yn[0]=this.read()),kn[0]},Mn.prototype.Zts=function(t){if(this.jhs<this.Fhs){var i=this.Ths+this.jhs;return this.jhs+=2,this.xhs[i]<<8&65280|255&this.xhs[i+1]}return this.Lhs(t)},Mn.prototype.ess=function(t){if(this.jhs<this.Fhs){var i=this.Ths+this.jhs;this.jhs+=2;var s=this.xhs[i],r=this.xhs[i+1];if(t){var n=(127&s)<<8|r;return n-=(128&s)<<8}n=(127&r)<<8|s;return n-=(128&r)<<8}return this.Vhs(t)},Mn.prototype.jis=function(t,i,s){var r=2*t;if(this.jhs+2*t<this.currentView.byteLength){var n=new Uint8Array(i.buffer),h=this.Ths+this.jhs;if(s)for(var e=0;e<t;++e)n[2*e+1]=this.xhs[h+2*e],n[2*e]=this.xhs[h+2*e+1];else for(e=0;e<r;++e)n[e]=this.xhs[h+e];this.jhs+=r}else for(e=0;e<t;++e)i[e]=this.ess(s)},Mn.prototype.Fis=function(t,i,s){if(this.jhs+3*i<this.currentView.byteLength){for(var r=0;r<i;++r){var n=this.Ths+this.jhs;s[r+t]=this.xhs[n+3*r]<<16&16711680|this.xhs[n+3*r+1]<<8&65280|255&this.xhs[n+3*r+2]}this.jhs+=3*i}else for(r=0;r<i;++r)s[r+t]=this.read()<<16&16711680|this.read()<<8&65280|255&this.read()},Mn.prototype.Iis=function(t,i,s,r){if(this.jhs+2*i<this.currentView.byteLength){if(this.conversion)for(var n=0;n<i;++n){var h=(127&(e=this.xhs[2*n]))<<8|this.xhs[2*n+1];s[t+n]=h-((128&e)<<8)}else for(n=0;n<i;++n){var e;h=(127&(e=this.xhs[2*n]))<<8|this.xhs[2*n+1];s[t+n]=h-((128&e)<<8)}this.jhs+=2*i}else for(n=0;n<i;++n)s[t+n]=this.ess(r)},Mn.prototype.Bhs=function(t,i,s){if(this.jhs+i<this.currentView.byteLength){for(var r=this.Ths+this.jhs,n=0;n<i;++n)s[t+n]=this.xhs[r+n];this.jhs+=i}else for(n=0;n<i;++n)s[t+n]=this.read()},Mn.prototype.pis=function(t,i,s){if(this.jhs+i<this.currentView.byteLength){for(var r=this.Ths+this.jhs,n=0;n<i;++n)s[t+n]=this.xhs[r+n];this.jhs+=i}else for(n=0;n<i;++n)s[t+n]=this.read()},Mn.prototype.Mis=function(t,i){if(this.jhs+t<this.currentView.byteLength){var s=new Uint8Array(this.xhs.buffer,this.Ths+this.jhs,t);return this.jhs+=t,s}for(var r=0;r<t;++r)i[r]=this.read();return i},Mn.prototype.ois=function(t,i,s,r){if(this.jhs+2*i<this.currentView.byteLength){var n=this.Ths+this.jhs;if(r)for(h=0;h<i;++h)yn[0]=this.xhs[n+2*h],yn[1]=this.xhs[n+2*h+1],s[t+h]=Sn[0];else for(var h=0;h<i;++h)yn[1]=this.xhs[n+2*h],yn[0]=this.xhs[n+2*h+1],s[t+h]=Sn[0];this.jhs+=2*i}else for(h=0;h<i;++h)s[t+h]=this.Zts(r)},Mn.prototype.uis=function(t,i,s){if(this.jhs+2*t<this.currentView.byteLength){var r=new Uint8Array(i.buffer),n=2*t,h=this.Ths+this.jhs;if(s){for(var e=0;e<t;++e)r[2*e+1]=this.xhs[h+2*e],r[2*e]=this.xhs[h+2*e+1];this.jhs+=4*t}else{for(e=0;e<n;++e)r[e]=this.xhs[h+e];this.jhs+=n}}else for(e=0;e<t;++e)i[e]=this.Zts(s)},Mn.prototype.fis=function(t,i,s){if(this.jhs+4*t<this.currentView.byteLength){var r=new Uint8Array(i.buffer),n=4*t,h=this.Ths+this.jhs;if(s){for(var e=0;e<t;++e)r[4*e+3]=this.xhs[h+4*e],r[4*e+2]=this.xhs[h+4*e+1],r[4*e+1]=this.xhs[h+4*e+2],r[4*e]=this.xhs[h+4*e+3];this.jhs+=4*t}else{for(e=0;e<n;++e)r[e]=this.xhs[h+e];this.jhs+=n}}else for(e=0;e<t;++e)i[e]=this.readFloat(s)},Mn.prototype.readFloatArray=function(t,i,s,r){if(this.jhs+4*i<this.currentView.byteLength)for(var n=this.jhs+4*i,h=t;this.jhs<n;)s[h++]=this.readFloat(r);else for(var e=0;e<i;++e)s[t+e]=this.readFloat(r)};var xn=function(){var t=[],i=[];this.remove=function(i){t.splice(i,1)},this.add=function(i){var s=t.length;return t[s]=i,s},this.Dns=function(i,s){t[s]=i},this.Uns=function(i){return i<t.length},this.get=function(i){return t[i]},this.getArray=function(){return t},this.Ess=function(t){return void 0!==i[t]},this.Dss=function(t,s){if(void 0!==i[t]){for(var r=0;r<i[t].length;r++)if(i[t][r].zhs===s)return!0;return!1}return!1},this.Fss=function(t,s){i[t]=s},this.Vss=function(t,s,r){void 0!==i[t]?i[t].push({index:s,zhs:r}):i[t]=[{index:s,zhs:r}]},this.getIndex=function(t){return i[t]},this.Gss=function(t,s){for(var r=i[t],n=0;n<r.length;n++)if(r[n].zhs===s)return r[n].index;return null}};return function(i,w,b,d,A,m,M,y,O,p,k,S,g,j){bn=O&&O.sag2D?O.sag2D:0,O&&O.sag3D?O.sag3D:0;this.Hhs=!0,this.Yhs=!1,!i||i instanceof byteArrayReader?(o=g,this.expand=w,this.H6e=d,d,c=m,a=M,f=y,this.uint32Index=A,v=p,u=j):(this.expand=i.expand,this.H6e=i.withSG,this.H6e,c=i.Xhs,a=i.sag,f=i.E5e,this.uint32Index=i.Jhs,v=i.Whs,o=i.j6e,u=i.GR),r=S,h=b,e=k;var I=null,N=i,x=null,T=null,R=null;this.qhs=function(t){N=new byteArrayReader(t),{file:"",id:-1},null,wn=[],dn=1,!1,this.Hhs=!0,I=null,x=null,T=null,R=null};this.addChild=function(t){var i=t.node;if(t.children)for(var s=t.children.length,r=0;r<s;r++){0;var n=t.children[r].node;i.children.push(n),n.type&&(n.parent=i,this.addChild(t.children[r]))}};var E=function(t,i,s){this.cgmId=t||0,this.matrix=i||null,this.boundingSphere=s||null};this.Khs=function(t){var i=new E(t.node.cgmId,t.node.matrix,t.node.boundingSphere);if(void 0!==t.node.rep?i.rep=t.node.rep:i.children=[],t.children)for(var s=t.children.length,r=0;r<s;r++){var n=this.Khs(t.children[r]);i.children.push(n)}return i},this.Zhs=function(t,i){var s,r=t.node;i.offset>i.size&&(i.size*=2,s=new ArrayBuffer(i.size),i.result.push(s),i.view32F=new Float32Array(s),i.view32UInt=new Uint32Array(s),i.view8UInt=new Uint8Array(s));if(i.view32UInt[i.offset++]=r.cgmId,i.view8UInt[4*i.offset]=r.type,i.view8UInt[4*i.offset+1]=r.solid,i.offset++,t.children){var n,h=t.children.length;for(i.view32UInt[i.offset++]=h,e=0;e<h;e++)n=t.children[e].node,r.children.push(n),n.parent=r,this.Zhs(t.children[e],i)}if(r.primitives){var e,a,f,o,u;h=r.primitives.length;for(i.view32UInt[i.offset++]=h,e=0;e<h;e++){if(o=!!(a=r.primitives[e]).boundingSphere,u=!!a.decoration&&a.decoration[0],i.view32UInt[i.offset++]=a.cgmId,i.view8UInt[4*i.offset]=a.type,i.view8UInt[4*i.offset+1]=o,i.view8UInt[4*i.offset+2]=u,i.offset++,i.view32UInt[i.offset++]=a.count,i.view32UInt[i.offset++]=a.start,a.group.primitives instanceof Array?(f=i.Qhs++,a.group.primitives=f):f=a.group.primitives,i.view32UInt[i.offset++]=f,u){var c,v=a.decoration.length,l=4*i.offset;for(c=0;c<v;c++)i.view8UInt[l+c]=a.decoration[c];i.offset+=1+(v/4>>0)}o&&(i.view32F[i.offset++]=a.boundingSphere.center[0],i.view32F[i.offset++]=a.boundingSphere.center[1],i.view32F[i.offset++]=a.boundingSphere.center[2],i.view32F[i.offset++]=a.boundingSphere.radius)}}},this.$hs=function(i,r){for(var n=0;n<i.length;n++){if(!!i[n].globalMatrix&&!i[n].globalMatrix.isIdentity()){var h=new s.Matrix4;if(h.extractRotation(i[n].globalMatrix),t.tes(i[n],i[n].globalMatrix,r,h),h.isIdentity()){var e=new s.Vector3(i[n].AABB.min[0],i[n].AABB.min[1],i[n].AABB.min[2]).Fm(i[n].globalMatrix),a=new s.Vector3(i[n].AABB.max[0],i[n].AABB.max[1],i[n].AABB.max[2]).Fm(i[n].globalMatrix);i[n].AABB.min[0]=e.x,i[n].AABB.min[1]=e.y,i[n].AABB.min[2]=e.z,i[n].AABB.max[0]=a.x,i[n].AABB.max[1]=a.y,i[n].AABB.max[2]=a.z}else t.ses(i[n])}}},this.nes=function(i,r){for(var n=0;n<i.length;n++){if(!!i[n].globalMatrix&&!i[n].globalMatrix.isIdentity()){var h=new s.Matrix4;if(h.extractRotation(i[n].globalMatrix),t.tes(i[n],i[n].globalMatrix,r,h),h.isIdentity()){var e=new s.Vector3(i[n].AABB.min[0],i[n].AABB.min[1],i[n].AABB.min[2]).Fm(i[n].globalMatrix),a=new s.Vector3(i[n].AABB.max[0],i[n].AABB.max[1],i[n].AABB.max[2]).Fm(i[n].globalMatrix);i[n].AABB.min[0]=e.x,i[n].AABB.min[1]=e.y,i[n].AABB.min[2]=e.z,i[n].AABB.max[0]=a.x,i[n].AABB.max[1]=a.y,i[n].AABB.max[2]=a.z}else t.ses(i[n])}}},this.hes=function(t){for(var i=null,r=new s.Matrix4,n=new s.Vector3,h=new s.Vector3,e=new s.Vector3,a=new s.Vector3,f=0;f<t.length;f++){i=t[f].axis,!!t[f].globalMatrix&&!t[f].globalMatrix.isIdentity()&&(n.set(i.origin[0],i.origin[1],i.origin[2]),h.set(i.VJi[0],i.VJi[1],i.VJi[2]),e.set(i.OJi[0],i.OJi[1],i.OJi[2]),a.set(i.UJi[0],i.UJi[1],i.UJi[2]),r.makeBasis(h,e,a),r.setPosition(n),r.multiply(t[f].globalMatrix),i.origin=[r.elements[12],r.elements[13],r.elements[14]],i.VJi=[r.elements[0],r.elements[1],r.elements[2]],i.OJi=[r.elements[4],r.elements[5],r.elements[6]],i.UJi=[r.elements[8],r.elements[9],r.elements[10]]),t[f]=i}},this.ees=function(t){for(var i=new s.Matrix4,r=new s.Vector3,n=new s.Vector3,h=new s.Vector3,e=new s.Vector3,a=0;a<t.length;a++){for(var f=[],o=t[a].refPlanes,u=0;u<o.length;u++){var c=o[u];!!t[a].globalMatrix&&!t[a].globalMatrix.isIdentity()&&(r.set(c.origin[0],c.origin[1],c.origin[2]),n.set(c.VJi[0],c.VJi[1],c.VJi[2]),h.set(c.OJi[0],c.OJi[1],c.OJi[2]),e.crossVectors(n,h),i.makeBasis(n,h,e),i.setPosition(r),i.multiply(t[a].globalMatrix),c.origin=[i.elements[12],i.elements[13],i.elements[14]],c.VJi=[i.elements[0],i.elements[1],i.elements[2]],c.OJi=[i.elements[4],i.elements[5],i.elements[6]]),f.push(c)}t[a]=f}},this.aes=function(t){if(h)for(var i=0;i<t.length;i++)for(var s=t[i],r=s.vertexPositionArray,n=s.vertexIndexArray,e=0;e<s.drawingGroups.length;e++){var a=s.drawingGroups[e];if(0!==a.glType)for(var f=0;f<a.tEi.length;f++){var o=a.tEi[f];if(!o.boundingSphere){for(var u=[Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE],c=[-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE],v=o.start;v<o.start+o.count;v++){var l=n[v];r[3*l]<u[0]&&(u[0]=r[3*l]),r[3*l+1]<u[1]&&(u[1]=r[3*l+1]),r[3*l+2]<u[2]&&(u[2]=r[3*l+2]),r[3*l]>c[0]&&(c[0]=r[3*l]),r[3*l+1]>c[1]&&(c[1]=r[3*l+1]),r[3*l+2]>c[2]&&(c[2]=r[3*l+2])}var w=(u[0]-c[0])*(u[0]-c[0]);w+=(u[1]-c[1])*(u[1]-c[1]),w+=(u[2]-c[2])*(u[2]-c[2]),w=.5*Math.sqrt(w);var b={center:[.5*(u[0]+c[0]),.5*(u[1]+c[1]),.5*(u[2]+c[2])],radius:w};o.boundingSphere=b}}}},this.fes=function(t,i,r){var n=[],h=t.length,f=new s.Vector3,o=3;e&&(o+=4),a&&(o+=1);for(var u=0;u<h;u++){var v=[],l=t[u].getArray();if(1&u||8&u)this.aes(l),this.nes(l,i),this.oes(l,v,i);else{this.aes(l),this.$hs(l,i);for(var w=0;w<l.length;w++){var b=l[w],d=b.AABB.min,A=b.AABB.max;f.x=A[0]-d[0],f.y=A[1]-d[1],f.z=A[2]-d[2],e&&(r[o*b.rep+o-4]=.5*f.length(),r[o*b.rep+o-3]=.5*d[0]+.5*A[0],r[o*b.rep+o-2]=.5*d[1]+.5*A[1],r[o*b.rep+o-1]=.5*d[2]+.5*A[2]),c&&(l[w].Xhi=.5*f.length())}this.batch(l,v,i)}n.push(v)}return n},this.batch=function(i,s,r){var n=function(t,i){t.min[0]>i.min[0]&&(t.min[0]=i.min[0]),t.min[1]>i.min[1]&&(t.min[1]=i.min[1]),t.min[2]>i.min[2]&&(t.min[2]=i.min[2]),t.max[0]<i.max[0]&&(t.max[0]=i.max[0]),t.max[1]<i.max[1]&&(t.max[1]=i.max[1]),t.max[2]<i.max[2]&&(t.max[2]=i.max[2])},e={ues:!1,P5e:a,ces:h},f=[],o=null,u=0,v=65535;this.uint32Index&&(v=524287);for(var l=0;l<i.length;l++)if(i[l].vertexPositionArray&&(this.Yhs||!i[l].noShow)){if(o?n(o,i[l].AABB):o=i[l].AABB,u+i[l].vertexPositionArray.length/3>=v){if(0==u){for(var w=t.divideRep(i[l],!0,e),b=0;b<w.length;b++)s.push(w[b]);o=null;continue}(d=t.ves(f,!0,c,e,r)).AABB={min:o.min,max:o.max},o=null,s.push(d),u=0,f=[]}if(i[l].vertexPositionArray.length/3>=v){for(w=t.divideRep(i[l],!0,e),b=0;b<w.length;b++)s.push(w[b]);o=null}else f.push(i[l]),u+=i[l].vertexPositionArray.length/3}for(l=0;l<i.length;l++)if(i[l].vertexPositionArray&&!this.Yhs&&i[l].noShow&&this.H6e){if(e.ues=!0,u+i[l].vertexPositionArray.length/3>=v){if(0==u){for(w=t.divideRep(i[l],!0,e),b=0;b<w.length;b++)s.push(w[b]);o=null;continue}var d;o||(o={min:[0,0,0],max:[0,0,0]}),(d=t.ves(f,!0,c,e,r)).AABB={min:o.min,max:o.max},o=null,s.push(d),u=0,f=[]}if(i[l].vertexPositionArray.length/3>=v){for(w=t.divideRep(i[l],!0,e),b=0;b<w.length;b++)s.push(w[b]);o=null}else f.push(i[l]),u+=i[l].vertexPositionArray.length/3}f.length>0&&(o||(o={min:[0,0,0],max:[0,0,0]}),(d=t.ves(f,!0,c,e,r)).AABB={min:o.min,max:o.max},d.AABB.min[0]==d.AABB.max[0]&&d.AABB.min[1]==d.AABB.max[1]&&d.AABB.min[2]==d.AABB.max[2]&&(d.AABB.min[0]-=.1,d.AABB.min[1]-=.1,d.AABB.max[0]+=.1,d.AABB.max[1]+=.1),s.push(d))},this.oes=function(i,s,r){for(var n=function(t,i){for(var s=0;s<16;s++)if(t.elements[s]!=i.elements[s])return!1;return!0},e=[],f=0;f<i.length;f++){for(var o=!1,u=i[f],c=0;c<e.length;c++)if(n(u.sYi,e[c].sYi)){e[c].reps.push(u),o=!0;break}if(!o){var v=[u];e.push({sYi:u.sYi,reps:v})}}for(f=0;f<e.length;f++){var l=t.ves(e[f].reps,!1,!1,{ues:!1,P5e:a,ces:h},r),w=[];l.AABB.min[0]==l.AABB.max[0]&&l.AABB.min[1]==l.AABB.max[1]&&l.AABB.min[2]==l.AABB.max[2]&&(l.AABB.min[0]-=.1,l.AABB.min[1]-=.1,l.AABB.max[0]+=.1,l.AABB.max[1]+=.1),w.push(l),s.push({tab:w,globalMatrix:e[f].sYi})}},this.les=function(i){var s=[],r=i.axisSystems,n=i.refPlanes,h=i.$xe;if(!this.expand){this.hes(r),this.ees(n);var e=this.fes(i.reps,i.materials,i.sgRep),a=null;return this.H6e&&i.rep&&(this.addChild(i.rep),a=i.rep.node),this.H6e&&i.rep,{reps:e,sceneGraph:a,resource:i.resource,material:i.materials,sgRep:i.sgRep,decorations:i.decorations,curvedPipes:i.curvedPipes,canonicals:i.canonicals,axisSystems:r,refPlanes:n,$xe:h}}var f=I.reps[H].getArray(),o=[],u=[];a=null;rep&&(a=this.Khs(rep));for(var c=0;c<f.length;c++)if(f[c].vertexPositionArray)if(f[c].vertexPositionArray.length/3>=65535){for(var v=t.divideRep(f[c],!0),l=(s=[],0);l<v.length;l++)s.push(v[l]);u.push(s)}else{s=[];o.push(f[c]);var w=t.ves(o);s.push(w),u.push(s),o=[]}return f=[],I.wes=[],{mesh:u,resource:I.textures.getArray(),material:I.materials.getArray(),rep:a}},this.init=function(){var t=(I=new lt(N.clone())).UAt(6),i=I.UAt(2);if(x=i[0],"V5_CFV"!=t)return this.Hhs=!1,{mesh:[],resource:[],material:[],bes:[]};dn=3==x?0:1,I.conversion=!0;var s=I.ris(!0),r=I.ris(!0);I.skip(8),I.skip(32);I.ris(!0);if(I.skip(4),dn&&!I.Qts(s))return{error:"file corrupted"};i=I.UAt(16),I.tis(),I.Zts(!0),I.Zts(!0),I.Zts(!0);var n=I.Zts(!0);I.Zts(!0),I.ris(!0);if(I.skip(33),dn)T=new At(I,n);else{var h=new Uint8Array(384+r);I.pis(384,h);var e=new Uint8Array(r);I.Qts(s),I.pis(r,e),h.set(e,384);var a=new lt(new byteArrayReader(h));a.conversion=!0,T=new At(a,n)}return I.conversion=!1,!0},this.des=function(t,i){var s=0,r=0,n={},h=!1;if(i){if((e=this.Shs()).phs(),e.header.version>=210042400&&(h=!0),dn){if(h)s=e.header.version,r=e.header.conversion;else s=(a=e.Ohs("SceneGraph")).header.version,r=a.header.conversion}else{if(!(v=e.Ohs("MAIN")).header){l=this.Aes(v.Mhs);if(v.khs(l))return null}s=v.header.version,r=v.header.conversion}}else{this.init();var e;(new Date).getTime();if((e=this.Shs()).phs(),e.header.version>=210042400&&(h=!0),dn){var a;if(h)s=e.header.version,r=e.header.conversion;else(a=e.Ohs("SceneGraph")).phs(),s=a.header.version,r=a.header.conversion}else{for(var f=this.Aes(e.Mhs),o=(f.ris(!1),f.ris(!1),f.ris(!1)),u=0;u<o;u++){f.ris(!1),f.ris(!1),f.Zts(!1);var c=f.ris(!1);this.name=f.Kts(c/2)}var v=e.Ohs("MAIN"),l=this.Aes(v.Mhs);v.khs(l),s=v.header.version,r=v.header.conversion}}var w=e.Ohs("Applicative Containers");if(!w)return null;var b=w.Ohs(t);if(!b)return null;var d=b.Ohs("MainDataStream");if(!d)return null;var A=this.mes(d.Mhs);if(0==A.length)return null;switch(t){case"V4V5_FDT":var m=this.Aes(d.Mhs);dn||(m.kts=1,m.Sts=1,m.jts=1),m.xts=this.expand,m.version=s,m.conversion=r;var M=m.qts(),y=m.qts();if(n.oldSize=M,n.compressed=y,n.offset=m.getCurrentPosition(),m.skip(y),m.Jts()){m.qts();n.oldSize=m.qts(),n.compressed=m.qts(),n.offset=m.getCurrentPosition()}}(new Date).getTime();return{buffer:A,options:n}},this.open=function(t){var i=this.init();if(i&&i.error)return i;if(t&&(dn=0),!this.Hhs)return{error:"cgr version not supported or corrupted file"};l=!1;(new Date).getTime();var s=this.Shs();if(s.phs(),L=0,B=0,z=0,V=!1,ri={x:0,y:0,z:0},ni={x:0,y:0,z:0},n=!!r,An=!1,s.header.version>=210042400){An=!0;s.header.ris(),s.header.ris();var h=s.header.ris();if(s.header.skip(h),s.header.version>=210042410){if(s.header.Ais())switch(s.header.tis()){case F:break;case _:var e=s.header.tis();e&P&&(L=P),e&U&&(L=U),s.header.version>=210042415&&(e&D&&(B=D),e&C&&(z=C),e&G&&(z=G)),n=!0===r,!1===r&&(n=!1)}mn=(new ti).gss(s.header)}}var a=s.Ohs("Skeleton"),f=null,o=null;if(!dn&&a){var u=this.Aes(s.Mhs);u.conversion=!0;u.ris(!1),u.ris(!1);for(var c=u.ris(!1),v=0;v<c;v++){u.ris(!1),u.ris(!1),u.Zts(!1);var w=u.ris(!1);this.name=u.Kts(w/2)}u.conversion=!1;var b=s.Ohs("MAIN"),d=this.Aes(b.Mhs);if(y=b.khs(d))return y;var A=s.Ohs("Options"),m=this.Aes(A.Mhs);if(m.wis(s),m.tis()>=5)m.tis();if(!a)return null;(o=this.Aes(a.Mhs)).wis(s),o.version=b.header.version,o.conversion=b.header.conversion,o.kts=1,o.Sts=1,o.jts=1,o.xts=this.expand;var M=o.$ts();f=o.iis(M).gss(o)}else{var y,O=s,p="SceneGraph";if(An||(O=s.Ohs("SceneGraph"),p="MainDataStream"),y=O.phs("SceneGraph"))return y;(o=O.grs(p,An)).xts=this.expand;M=o.$ts();f=o.iis(M).gss(o)}return o.check(),this.les({axisSystems:o.axisSystems.getArray(),refPlanes:o.refPlanes.getArray(),curvedPipes:o.curvedPipes.getArray(),canonicals:o.canonicals.getArray(),$xe:o.$xe.getArray(),resource:o.textures.getArray(),materials:o.materials.getArray(),sgRep:o.sgRep,decorations:o.decorations.Mes(),reps:o.reps,rep:f})},this.Oes=function(t,i,s){this.Yhs=!0,l=!0,s&&(f=s.E5e,o=s.pes);var r=new Mn;r.Uhs(t);var n=new lt(r);n.version=1101410;n.pis(12,[]);var h=n.tis();n.conversion=!h,n.version=n.qts();var e=n.$ts(),a=n.iis(e).gss(n);if(n.error&&i)return i(n.error),{reps:[],sceneGraph:null,resource:[],material:[],axisSystems:[],refPlanes:[],$xe:[]};n.check();var u=this.les({axisSystems:n.axisSystems.getArray(),curvedPipes:n.curvedPipes.getArray(),canonicals:n.canonicals.getArray(),refPlanes:n.refPlanes.getArray(),$xe:n.$xe.getArray(),resource:n.textures.getArray(),materials:n.materials.getArray(),sgRep:n.sgRep,decorations:n.decorations.Mes(),reps:n.reps,rep:a});return a.node.noShow&&this.H6e&&(u.sceneGraph.noShow=!0),this.H6e?u:{mesh:u.reps[0],resource:u.resource,material:u.material,axisSystems:u.axisSystems,curvedPipes:u.curvedPipes,canonicals:u.canonicals,refPlanes:u.refPlanes,$xe:u.$xe,bes:u.reps[2]}},this.kes=function(t){nt=t},this.mes=function(t){for(var i=0,s=t.mhs.Ass,r=0;r<s.length;++r)i+=s[r].length;var n=new Uint8Array(i),h=0;for(r=0;r<s.length;++r)for(var e=s[r],a=0;a<e.length;++a)n[h]=N.buffer[e.offset+a],h++;return n},this.Shs=function(){return R||((R=new ln(this,T.mss())).name="MAIN",R)},this.yhs=function(t,i){var s=T.Oss(t,i);if(null==s)return null;for(var r=new Mn(N.clone()),n=0;n<s.mhs.Ass.length;++n)r.Phs(s.mhs.Ass[n]);var h=new lt(r);return h.name=i,h},this.Aes=function(t){for(var i=new Mn(N.clone()),s=0;s<t.mhs.Ass.length;++s)i.Phs(t.mhs.Ass[s]);return new lt(i)},this.Ohs=function(t,i){var s=T.Oss(t,i);if(s)return new ln(this,s)}}})),define("Formats/CGRFile",["DS/Formats/CGRFile","DS/DSMigration/DSMigration"],(function(t,i){return i.mH("Formats/CGRFile"),t}));