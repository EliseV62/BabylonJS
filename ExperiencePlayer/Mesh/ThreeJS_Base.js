define("DS/Mesh/ThreeJS_Base",[],(function(){"use strict";var t=t||{REVISION:"57"};t.extend=function(t,i){if(Object.keys)for(var n=Object.keys(i),s=0,h=n.length;s<h;s++){var r=n[s];Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(i,r))}else{var e={}.hasOwnProperty;for(var r in i)e.call(i,r)&&(t[r]=i[r])}return t},String.prototype.hashCode=function(){var t,i=0;if(0===this.length)return i;for(t=0;t<this.length;t++)i=(i<<5)-i+this.charCodeAt(t),i|=0;return i},String.prototype.includes||(String.prototype.includes=function(t,i){return"number"!=typeof i&&(i=0),!(i+t.length>this.length)&&-1!==this.indexOf(t,i)}),Uint32Array.prototype.slice||Object.defineProperty(Uint32Array.prototype,"slice",{value:function(t,i){return new Uint32Array(Array.prototype.slice.call(this,t,i))}}),Float32Array.prototype.slice||Object.defineProperty(Float32Array.prototype,"slice",{value:function(t,i){return new Float32Array(Array.prototype.slice.call(this,t,i))}}),"function"!=typeof Object.values&&Object.defineProperty(Object,"values",{value:function(t){var i=[];for(var n in t)t.hasOwnProperty(n)&&i.push(t[n]);return i},writable:!0,configurable:!0}),"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(t,i){if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var n=Object(t),s=1;s<arguments.length;s++){var h=arguments[s];if(null!=h)for(var r in h)Object.prototype.hasOwnProperty.call(h,r)&&(n[r]=h[r])}return n},writable:!0,configurable:!0}),Array.prototype.fill||Object.defineProperty(Array.prototype,"fill",{value:function(t){if(null==this)throw new TypeError("this is null or not defined");for(var i=Object(this),n=i.length>>>0,s=arguments[1],h=s>>0,r=h<0?Math.max(n+h,0):Math.min(h,n),e=arguments[2],a=void 0===e?n:e>>0,o=a<0?Math.max(n+a,0):Math.min(a,n);r<o;)i[r]=t,r++;return i}}),Float32Array.prototype.fill||(Float32Array.prototype.fill=Array.prototype.fill),Uint32Array.prototype.fill||(Uint32Array.prototype.fill=Array.prototype.fill),t.tYn=424,t.getWebVisualizationLevel=function(){return t.tYn},t.GeomTypeEnum={EDGE:1,WIRE_EDGE:2,BOUNDARY_EDGE:4,SHARP_EDGE:8,SMOOTH_EDGE:16,HIDDEN_SEAM_EDGE:32,BOUNDARY_POINT:64,SHARP_POINT:128,SMOOTH_POINT:256,SURFACIC_POINT:512,FREE_POINT:1024,HIDDEN_SEAM_POINT:2048,INFINITE_FACE:4096,FACE:8192,UNKNOWN:16384,_OUTLINE:32768,_SECTION_LINE:65536,AXIS_SYSTEM:1<<17,UNKNOWN_2D:1<<18,UNKNOWN_1D:1<<19,UNKNOWN_0D:1<<20},t.iYn=2097151,t.FixedSizeFiltering={Include:0,Exclude:1,CenterOnly:2},t.PolygonOffsetForceStatus={DEFAULT:0,ENABLED:1,DISABLED:2},t.TextureBlendOperations={DECAL:0,MODULATE:1,BLEND:2,REPLACE:3,IGNORE:4,KEEP_DEFAULT:5},t.MappingType={DISABLED:-1,NONE:0,PLANAR:1,SPHERICAL:2,CUBIC:3,FINITE_CYLINDRICAL:4,INFINITE_CYLINDRICAL:5,SPHERICAL_NORMALIZED:6,INFINITE_CYLINDRICAL_NORMALIZED:7,INFINITE_CYLINDRICAL_NORM_ANGLE_PRES:8},t.nYn={DEFAULT:1,sYn:2,hYn:3},t._BinaryPrimitives=!1,t.IsIE11=null!=new RegExp("Trident/.*rv:([0-9]{1,}[.0-9]{0,})").exec(navigator.userAgent),t.St=function(){return/iPad|iPhone|iPod/.test(navigator.userAgent)||"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1},t.Dt=function(){return navigator.userAgent.match(/(Android)/i)},t.isMacOS=function(){return!t.St()&&navigator.platform.toUpperCase().indexOf("MAC")>=0},t.isAppleDevice=function(){return t.St()||t.isMacOS()},t._d=function(){return t.St()||t.Dt()},t.__unrolledHighlight=function(){return t.isAppleDevice()};var i=["LARGE_SCALE","NON_UNIFORM_SCALE","OIT","COMPRESSED_VERTICES","COMPRESSED_UVS","COMPRESSED_COLORS","COMPRESSED_NORMALS","FIXED_SIZE","FIXED_SIZE_CENTER","BILLBOARD","LIGHT_MAP","POLITE_HIGHLIGHT","PRIMITIVE_HIGHLIGHT","ADJACENCE_HIGHLIGHT","NOZ_OBJECT","DECALS","MAPPING_OPERATOR","MAPPING_OPERATOR_VERTEX","SKIP_TRANSPAR"];if(i.length>25)throw"too many program ids";for(var n,s,h,r,e,a=new Object,o=0;o<i.length;o++)a[i[o]]=1<<o+5;t.ProgramIDs=a,t.AssetSource={MANUAL:0,MATERIAL_MANAGER:1},t.setValuesToObject=function(i,n){if(n)for(var s in n){var h=n[s];if(void 0!==h&&s in i){var r=i[s];r instanceof t.Color&&h instanceof t.Color?r.copy(h):r instanceof t.Color?r.set(h):r instanceof t.Vector3&&h instanceof t.Vector3||r instanceof t.Vector2&&h instanceof t.Vector2?r.copy(h):r instanceof Float32Array&&h instanceof Float32Array?i[s]=new Float32Array(h):i[s]=h}}},t.DataTypes={float16:{base:"float16",components:1,normalized:!1,native:void 0},rYn:{base:"float16",components:2,normalized:!1,native:void 0},eYn:{base:"float16",components:3,normalized:!1,native:void 0},aYn:{base:"float16",components:4,normalized:!1,native:void 0},float32:{base:"float32",components:1,normalized:!1,native:void 0},oYn:{base:"float32",components:2,normalized:!1,native:void 0},float32x3:{base:"float32",components:3,normalized:!1,native:void 0},uYn:{base:"float32",components:4,normalized:!1,native:void 0},sint8:{base:"sint8",components:1,normalized:!1,native:void 0},cYn:{base:"sint8",components:2,normalized:!1,native:void 0},fYn:{base:"sint8",components:3,normalized:!1,native:void 0},lYn:{base:"sint8",components:4,normalized:!1,native:void 0},sint16:{base:"sint16",components:1,normalized:!1,native:void 0},vYn:{base:"sint16",components:2,normalized:!1,native:void 0},dYn:{base:"sint16",components:3,normalized:!1,native:void 0},mYn:{base:"sint16",components:4,normalized:!1,native:void 0},sint32:{base:"sint32",components:1,normalized:!1,native:void 0},MYn:{base:"sint32",components:2,normalized:!1,native:void 0},pYn:{base:"sint32",components:3,normalized:!1,native:void 0},gYn:{base:"sint32",components:4,normalized:!1,native:void 0},bYn:{base:"sint8",components:1,normalized:!0,native:void 0},yYn:{base:"sint8",components:2,normalized:!0,native:void 0},wYn:{base:"sint8",components:3,normalized:!0,native:void 0},AYn:{base:"sint8",components:4,normalized:!0,native:void 0},EYn:{base:"sint16",components:1,normalized:!0,native:void 0},IYn:{base:"sint16",components:2,normalized:!0,native:void 0},xYn:{base:"sint16",components:3,normalized:!0,native:void 0},SYn:{base:"sint16",components:4,normalized:!0,native:void 0},uint8:{base:"uint8",components:1,normalized:!1,native:void 0},OYn:{base:"uint8",components:2,normalized:!1,native:void 0},NYn:{base:"uint8",components:3,normalized:!1,native:void 0},TYn:{base:"uint8",components:4,normalized:!1,native:void 0},uint16:{base:"uint16",components:1,normalized:!1,native:void 0},_Yn:{base:"uint16",components:2,normalized:!1,native:void 0},RYn:{base:"uint16",components:3,normalized:!1,native:void 0},kYn:{base:"uint16",components:4,normalized:!1,native:void 0},uint32:{base:"uint32",components:1,normalized:!1,native:void 0},LYn:{base:"uint32",components:2,normalized:!1,native:void 0},PYn:{base:"uint32",components:3,normalized:!1,native:void 0},zYn:{base:"uint32",components:4,normalized:!1,native:void 0},unorm8:{base:"uint8",components:1,normalized:!0,native:void 0},FYn:{base:"uint8",components:2,normalized:!0,native:void 0},unorm8x3:{base:"uint8",components:3,normalized:!0,native:void 0},CYn:{base:"uint8",components:4,normalized:!0,native:void 0},DYn:{base:"uint16",components:1,normalized:!0,native:void 0},YYn:{base:"uint16",components:2,normalized:!0,native:void 0},XYn:{base:"uint16",components:3,normalized:!0,native:void 0},ZYn:{base:"uint16",components:4,normalized:!0,native:void 0}},t.EventDispatcher=function(){var t={};this.addEventListener=function(i,n){void 0===t[i]&&(t[i]=[]),-1===t[i].indexOf(n)&&t[i].push(n)},this.removeEventListener=function(i,n){var s=t[i].indexOf(n);-1!==s&&(t[i][s]=null)},this.dispatchEvent=function(i){var n=t[i.type];if(void 0!==n){i.target=this;for(var s=!1,h=0,r=n.length;h<r;h++)n[h]?n[h].call(this,i):s=!0;if(s){var e=[];for(h=0,r=n.length;h<r;h++)n[h]&&e.push(n[h]);t[i.type]=e}}}},t.VisualizationTraces={HYn:[],info:function(t){var i=new Error,n=t+" - "+(i.stack?i.stack.split("\n")[2]:"");this.HYn.push(n)},jYn:function(){}},t.Quaternion=function(t,i,n,s){this.x=t||0,this.y=i||0,this.z=n||0,this.w=void 0!==s?s:1},t.Quaternion.prototype={constructor:t.Quaternion,set:function(t,i,n,s){return this.x=t,this.y=i,this.z=n,this.w=s,this},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w,this},PN:function(){return{x:this.x,y:this.y,z:this.z,w:this.w}},My:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w,this},setFromEuler:function(t,i){var n=Math.cos(t.x/2),s=Math.cos(t.y/2),h=Math.cos(t.z/2),r=Math.sin(t.x/2),e=Math.sin(t.y/2),a=Math.sin(t.z/2);return void 0===i||"XYZ"===i?(this.x=r*s*h+n*e*a,this.y=n*e*h-r*s*a,this.z=n*s*a+r*e*h,this.w=n*s*h-r*e*a):"YXZ"===i?(this.x=r*s*h+n*e*a,this.y=n*e*h-r*s*a,this.z=n*s*a-r*e*h,this.w=n*s*h+r*e*a):"ZXY"===i?(this.x=r*s*h-n*e*a,this.y=n*e*h+r*s*a,this.z=n*s*a+r*e*h,this.w=n*s*h-r*e*a):"ZYX"===i?(this.x=r*s*h-n*e*a,this.y=n*e*h+r*s*a,this.z=n*s*a-r*e*h,this.w=n*s*h+r*e*a):"YZX"===i?(this.x=r*s*h+n*e*a,this.y=n*e*h+r*s*a,this.z=n*s*a-r*e*h,this.w=n*s*h-r*e*a):"XZY"===i&&(this.x=r*s*h-n*e*a,this.y=n*e*h-r*s*a,this.z=n*s*a+r*e*h,this.w=n*s*h+r*e*a),this},setFromAxisAngle:function(t,i){var n=i/2,s=Math.sin(n);return this.x=t.x*s,this.y=t.y*s,this.z=t.z*s,this.w=Math.cos(n),this},toEuler:function(){var i=new t.Vector3;return i.x=Math.atan2(2*(this.w*this.x+this.y*this.z),1-2*(this.x*this.x+this.y*this.y)),i.y=Math.asin(2*(this.w*this.y-this.z*this.x)),i.z=Math.atan2(2*(this.w*this.z+this.x*this.y),1-2*(this.y*this.y+this.z*this.z)),i},setFromRotationMatrix:function(t){var i,n=t.elements,s=n[0],h=n[4],r=n[8],e=n[1],a=n[5],o=n[9],u=n[2],c=n[6],f=n[10],l=s+a+f;return l>0?(i=.5/Math.sqrt(l+1),this.w=.25/i,this.x=(c-o)*i,this.y=(r-u)*i,this.z=(e-h)*i):s>a&&s>f?(i=2*Math.sqrt(1+s-a-f),this.w=(c-o)/i,this.x=.25*i,this.y=(h+e)/i,this.z=(r+u)/i):a>f?(i=2*Math.sqrt(1+a-s-f),this.w=(r-u)/i,this.x=(h+e)/i,this.y=.25*i,this.z=(o+c)/i):(i=2*Math.sqrt(1+f-s-a),this.w=(e-h)/i,this.x=(r+u)/i,this.y=(o+c)/i,this.z=.25*i),this},GYn:function(){var i=2*this.x,n=2*this.y,s=2*this.z,h=i*this.w,r=n*this.w,e=(this.w,i*this.x),a=(this.x,s*this.x),o=n*this.y,u=s*this.y;this.z,(new t.Matrix3).elements;return new t.Vector3(a-r,u+h,1-(e+o))},inverse:function(){return this.conjugate().normalize(),this},conjugate:function(){return this.x*=-1,this.y*=-1,this.z*=-1,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},normalize:function(){var t=this.length();return 0===t?(this.x=0,this.y=0,this.z=0,this.w=1):(t=1/t,this.x=this.x*t,this.y=this.y*t,this.z=this.z*t,this.w=this.w*t),this},add:function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this},sub:function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this},multiply:function(t,i){return void 0!==i?this.multiplyQuaternions(t,i):this.multiplyQuaternions(this,t)},multiplyQuaternions:function(t,i){var n=t.x,s=t.y,h=t.z,r=t.w,e=i.x,a=i.y,o=i.z,u=i.w;return this.x=n*u+r*e+s*o-h*a,this.y=s*u+r*a+h*e-n*o,this.z=h*u+r*o+n*a-s*e,this.w=r*u-n*e-s*a-h*o,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},multiplyVector3:function(t){return t.applyQuaternion(this)},log:function(){if(Math.abs(this.w)>=1)return this.w=0,this;var t=Math.acos(this.w),i=Math.sin(t);if(this.w=0,Math.abs(i)<.001)return this;var n=t/i;return this.x*=n,this.y*=n,this.z*=n,this},exp:function(){var t=this.length();this.w=Math.cos(t);var i=Math.sin(t);if(Math.abs(t)<.001)return this;var n=i/t;return this.x*=n,this.y*=n,this.z*=n,this},slerp:function(t,i){var n=this.x,s=this.y,h=this.z,r=this.w,e=r*t.w+n*t.x+s*t.y+h*t.z;if(e<0?(this.w=-t.w,this.x=-t.x,this.y=-t.y,this.z=-t.z,e=-e):this.copy(t),e>=1)return this.w=r,this.x=n,this.y=s,this.z=h,this;var a=Math.acos(e),o=Math.sqrt(1-e*e);if(Math.abs(o)<.001)return this.w=.5*(r+this.w),this.x=.5*(n+this.x),this.y=.5*(s+this.y),this.z=.5*(h+this.z),this;var u=Math.sin((1-i)*a)/o,c=Math.sin(i*a)/o;return this.w=r*u+this.w*c,this.x=n*u+this.x*c,this.y=s*u+this.y*c,this.z=h*u+this.z*c,this},VYn:function(i,h,r){return n||(n=new t.Quaternion),s||(s=new t.Quaternion),n.copy(h).inverse().multiply(i).log(),s.copy(h).inverse().multiply(r).log(),n.add(s).multiplyScalar(-.25),this.copy(h).multiply(n.exp()),this.normalize(),this},squad:function(i,n,s,h,r){this.copy(i).slerp(h,r,!1),this.normalize();var e=(new t.Quaternion).copy(n).slerp(s,r);return e.normalize(),this.slerp(e,2*r*(1-r)).normalize()},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w},clone:function(){return new t.Quaternion(this.x,this.y,this.z,this.w)}},t.Quaternion.slerp=function(t,i,n,s){return n.copy(t).slerp(i,s)},t.Curve=function(){},t.Curve.prototype.getPoint=function(t){return null},t.Curve.prototype.wfn=function(t,i){var n=this.getUtoTmapping(t,i);return this.getPoint(n)},t.Curve.prototype.Zon=function(t){t||(t=5);var i,n=[];for(i=0;i<=t;i++)n.push(this.getPoint(i/t));return n},t.Curve.prototype.Gfn=function(t){t||(t=5);var i,n=[];for(i=0;i<=t;i++)n.push(this.wfn(i/t));return n},t.Curve.prototype.getLength=function(t){var i=this.qYn();if(void 0!==t){var n=t*(i.length-1),s=Math.floor(n),h=n-s;return s+1>=i.length?i[s]:(1-h)*i[s]+h*i[s+1]}return i[i.length-1]},t.Curve.prototype.qYn=function(t){if(t||(t=this.UYn?this.UYn:200),this.BYn&&this.BYn.length==t+1&&!this.$C)return this.BYn;this.$C=!1;var i,n,s=[],h=this.getPoint(0),r=0;for(s.push(0),n=1;n<=t;n++)r+=(i=this.getPoint(n/t)).distanceTo(h),s.push(r),h=i;return this.BYn=s,s},t.Curve.prototype.JYn=function(){this.$C=!0,this.qYn()},t.Curve.prototype.getUtoTmapping=function(t,i){var n,s=this.qYn(),h=0,r=s.length;n=i||t*s[r-1];for(var e,a=0,o=r-1;a<=o;)if((e=s[h=Math.floor(a+(o-a)/2)]-n)<0)a=h+1;else{if(!(e>0)){o=h;break}o=h-1}if(s[h=o]==n)return h/(r-1);var u=s[h];return(h+(n-u)/(s[h+1]-u))/(r-1)},t.Curve.prototype.Cfn=function(t){var i=t-1e-4,n=t+1e-4;i<0&&(i=0),n>1&&(n=1);var s=this.getPoint(i);return this.getPoint(n).clone().sub(s).normalize()},t.Curve.prototype.$Yn=function(t){var i=this.getUtoTmapping(t);return this.Cfn(i)},t.WYn=function(t){this.KYn=[],this.QYn=[],this.tZn(t)},t.WYn.prototype={constructor:t.WYn,tZn:function(t){this.KYn=t,t&&this.iZn()},clear:function(){this.KYn=[],this.QYn=[]},nZn:function(){return this.KYn.length},Xon:function(t){this.KYn.push(t),this.iZn()},sZn:function(t,i){return!(t<0||t>this.KYn.length)&&(this.KYn.splice(t,0,i),this.iZn(),!0)},hZn:function(t,i){return!(t<0||t>=this.KYn.length)&&(this.KYn[t]=i,this.iZn(),!0)},rZn:function(t){return!(t<0||t>=this.KYn.length)&&(this.KYn.splice(t,1),this.iZn(),!0)},_fn:function(t){var i=t*(this.KYn.length-1),n=Math.floor(i);return this.eZn(n,i-n)},eZn:function(i,n){return i===this.KYn.length-1||0===n?this.KYn[i]:1===n?this.KYn[i+1]:(new t.Quaternion).squad(this.KYn[i],this.QYn[i],this.QYn[i+1],this.KYn[i+1],n)},iZn:function(){var i=this.KYn.length;if(!(i<2)){this.KYn[i-1].normalize();for(var n=i-1;n>0;n--)this.KYn[n-1].normalize(),this.KYn[n-1].dot(this.KYn[n])<=0&&this.KYn[n-1].multiplyScalar(-1);var s=this.KYn[0].equals(this.KYn[i-1]);for(n=0;n<i;++n){var h,r,e=this.KYn[n];n?n===i-1?(h=this.KYn[n-1],r=s?this.KYn[1]:e):(h=this.KYn[n-1],r=this.KYn[n+1]):(r=this.KYn[1],h=s?this.KYn[i-2]:e),this.QYn[n]||(this.QYn[n]=new t.Quaternion),this.QYn[n].VYn(h,e,r)}}}},t.aZn=function(t){this.KYn=[],t&&this.tZn(t)},t.aZn.prototype={constructor:t.aZn,wfn:t.Curve.prototype.wfn,getLength:t.Curve.prototype.getLength,qYn:t.Curve.prototype.qYn,JYn:t.Curve.prototype.JYn,getUtoTmapping:t.Curve.prototype.getUtoTmapping,getPoint:function(t){var i=t*(this.KYn.length-1),n=Math.floor(i);return this.eZn(n,i-n)},nZn:function(){return this.KYn.length},tZn:function(t){this.KYn=t,this.oZn()},clear:function(){this.KYn=[],this.oZn()},Xon:function(t){this.KYn.push(t),this.oZn()},sZn:function(t,i){return!(t<0||t>this.KYn.length)&&(this.KYn.splice(t,0,i),this.oZn(),!0)},hZn:function(t,i){return!(t<0||t>=this.KYn.length)&&(this.KYn[t]=i,this.oZn(),!0)},rZn:function(t){return!(t<0||t>=this.KYn.length)&&(this.KYn.splice(t,1),this.oZn(),!0)},oZn:function(){this.JYn()},eZn:function(i,n){var s=this.KYn.length;if(s<2)return null;if(i===s-1)return this.KYn[i];if(0===n)return this.KYn[i];if(1===n)return this.KYn[i+1];var h,r,e,a=this.KYn[0].equals(this.KYn[s-1]),o=this.KYn[i];a?(h=i?this.KYn[i-1]:this.KYn[s-2],r=i>s-2?this.KYn[1]:this.KYn[i+1],e=i===s-1?this.KYn[2]:i===s-2?this.KYn[1]:this.KYn[i+2]):(h=i?this.KYn[i-1]:o,r=i>s-2?o:this.KYn[i+1],e=i>s-3?r:this.KYn[i+2]);var u=void 0!==this.KYn[0].w,c=u?new t.Vector4:new t.Vector3;return c.x=this.uZn(h.x,o.x,r.x,e.x,n),c.y=this.uZn(h.y,o.y,r.y,e.y,n),c.z=this.uZn(h.z,o.z,r.z,e.z,n),u&&(c.w=this.uZn(h.w,o.w,r.w,e.w,n)),c},uZn:function(t,i,n,s,h){var r=.5*(n-t),e=.5*(s-i),a=h*h;return(2*i-2*n+r+e)*(h*a)+(-3*i+3*n-2*r-e)*a+r*h+i}},t.Vector2=function(t,i){this.x=t||0,this.y=i||0},t.Vector2.prototype={constructor:t.Vector2,set:function(t,i){return this.x=t,this.y=i,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setComponent:function(t,i){switch(t){case 0:this.x=i;break;case 1:this.y=i;break;default:throw new Error("index is out of range: "+t)}},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}},copy:function(t){return this.x=t.x,this.y=t.y,this},add:function(t,i){return void 0!==i?this.addVectors(t,i):(this.x+=t.x,this.y+=t.y,this)},addVectors:function(t,i){return this.x=t.x+i.x,this.y=t.y+i.y,this},addScalar:function(t){return this.x+=t,this.y+=t,this},sub:function(t,i){return void 0!==i?this.subVectors(t,i):(this.x-=t.x,this.y-=t.y,this)},subVectors:function(t,i){return this.x=t.x-i.x,this.y=t.y-i.y,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this},divideScalar:function(t){return 0!==t?(this.x/=t,this.y/=t):this.set(0,0),this},min:function(t){return this.x>t.x&&(this.x=t.x),this.y>t.y&&(this.y=t.y),this},max:function(t){return this.x<t.x&&(this.x=t.x),this.y<t.y&&(this.y=t.y),this},clamp:function(t,i){return this.x<t.x?this.x=t.x:this.x>i.x&&(this.x=i.x),this.y<t.y?this.y=t.y:this.y>i.y&&(this.y=i.y),this},negate:function(){return this.multiplyScalar(-1)},dot:function(t){return this.x*t.x+this.y*t.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var i=this.x-t.x,n=this.y-t.y;return i*i+n*n},setLength:function(t){var i=this.length();return 0!==i&&t!==i&&this.multiplyScalar(t/i),this},lerp:function(t,i){return this.x+=(t.x-this.x)*i,this.y+=(t.y-this.y)*i,this},equals:function(t){return t.x===this.x&&t.y===this.y},toArray:function(){return[this.x,this.y]},clone:function(){return new t.Vector2(this.x,this.y)}},t.Vector3=function(t,i,n){this.x=t||0,this.y=i||0,this.z=n||0},t.Vector3.prototype={constructor:t.Vector3,set:function(t,i,n){return this.x=t,this.y=i,this.z=n,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},barycentricCoordinates:function(i,n,s){var h=(new t.Vector3).subVectors(i,this),r=(new t.Vector3).subVectors(n,this),e=(new t.Vector3).subVectors(s,this),a=(new t.Vector3).subVectors(i,n),o=(new t.Vector3).subVectors(i,s),u=1/(new t.Vector3).crossVectors(a,o).length();return{alpha:(new t.Vector3).crossVectors(r,e).length(),beta:(new t.Vector3).crossVectors(e,h).length(),gamma:(new t.Vector3).crossVectors(h,r).length(),normalisationFactor:u}},My:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},PN:function(){return{x:this.x,y:this.y,z:this.z}},setComponent:function(t,i){switch(t){case 0:this.x=i;break;case 1:this.y=i;break;case 2:this.z=i;break;default:throw new Error("index is out of range: "+t)}},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},getMaxAxis:function(){var t=0,i=this.x;return this.y>i&&(t=1,i=this.y),this.z>i&&(t=2,i=this.z),t},add:function(t,i){return void 0!==i?this.addVectors(t,i):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this},addVectors:function(t,i){return this.x=t.x+i.x,this.y=t.y+i.y,this.z=t.z+i.z,this},sub:function(t,i){return void 0!==i?this.subVectors(t,i):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)},subVectors:function(t,i){return this.x=t.x-i.x,this.y=t.y-i.y,this.z=t.z-i.z,this},multiply:function(t,i){return void 0!==i?this.cZn(t,i):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this},cZn:function(t,i){return this.x=t.x*i.x,this.y=t.y*i.y,this.z=t.z*i.z,this},applyMatrix3:function(t){var i=this.x,n=this.y,s=this.z,h=t.elements;return this.x=h[0]*i+h[3]*n+h[6]*s,this.y=h[1]*i+h[4]*n+h[7]*s,this.z=h[2]*i+h[5]*n+h[8]*s,this},Fm:function(t){if(!t)return this;var i=this.x,n=this.y,s=this.z,h=t.elements;return this.x=h[0]*i+h[4]*n+h[8]*s+h[12],this.y=h[1]*i+h[5]*n+h[9]*s+h[13],this.z=h[2]*i+h[6]*n+h[10]*s+h[14],this},fZn:function(t){if(!t)return this;var i=this.x,n=this.y,s=this.z,h=t.elements;return this.x=h[0]*i+h[4]*n+h[8]*s,this.y=h[1]*i+h[5]*n+h[9]*s,this.z=h[2]*i+h[6]*n+h[10]*s,this},applyProjection:function(t){var i=this.x,n=this.y,s=this.z,h=t.elements,r=1/(h[3]*i+h[7]*n+h[11]*s+h[15]);return this.x=(h[0]*i+h[4]*n+h[8]*s+h[12])*r,this.y=(h[1]*i+h[5]*n+h[9]*s+h[13])*r,this.z=(h[2]*i+h[6]*n+h[10]*s+h[14])*r,this},applyQuaternion:function(t){var i=this.x,n=this.y,s=this.z,h=t.x,r=t.y,e=t.z,a=t.w,o=a*i+r*s-e*n,u=a*n+e*i-h*s,c=a*s+h*n-r*i,f=-h*i-r*n-e*s;return this.x=o*a+f*-h+u*-e-c*-r,this.y=u*a+f*-r+c*-h-o*-e,this.z=c*a+f*-e+o*-r-u*-h,this},transformDirection:function(t){var i=this.x,n=this.y,s=this.z,h=t.elements;return this.x=h[0]*i+h[4]*n+h[8]*s,this.y=h[1]*i+h[5]*n+h[9]*s,this.z=h[2]*i+h[6]*n+h[10]*s,this.normalize(),this},lZn:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this},divideScalar:function(t){return 0!==t?(this.x/=t,this.y/=t,this.z/=t):(this.x=0,this.y=0,this.z=0),this},min:function(t){return this.x>t.x&&(this.x=t.x),this.y>t.y&&(this.y=t.y),this.z>t.z&&(this.z=t.z),this},max:function(t){return this.x<t.x&&(this.x=t.x),this.y<t.y&&(this.y=t.y),this.z<t.z&&(this.z=t.z),this},clamp:function(t,i){return this.x<t.x?this.x=t.x:this.x>i.x&&(this.x=i.x),this.y<t.y?this.y=t.y:this.y>i.y&&(this.y=i.y),this.z<t.z?this.z=t.z:this.z>i.z&&(this.z=i.z),this},negate:function(){return this.multiplyScalar(-1)},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},vZn:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length())},setLength:function(t){var i=this.length();return 0!==i&&t!==i&&this.multiplyScalar(t/i),this},lerp:function(t,i){return this.x+=(t.x-this.x)*i,this.y+=(t.y-this.y)*i,this.z+=(t.z-this.z)*i,this},cross:function(t,i){if(void 0!==i)return this.crossVectors(t,i);var n=this.x,s=this.y,h=this.z;return this.x=s*t.z-h*t.y,this.y=h*t.x-n*t.z,this.z=n*t.y-s*t.x,this},crossVectors:function(t,i){return this.x=t.y*i.z-t.z*i.y,this.y=t.z*i.x-t.x*i.z,this.z=t.x*i.y-t.y*i.x,this},applyAxisAngle:function(i,n){return void 0===e&&(e=new t.Quaternion),this.applyQuaternion(e.setFromAxisAngle(i,n)),this},projectOnVector:function(i){return void 0===h&&(h=new t.Vector3),h.copy(i).normalize(),r=this.dot(h),this.copy(h).multiplyScalar(r)},projectOnPlane:function(){var i;return function(n){return void 0===i&&(i=new t.Vector3),i.copy(this).projectOnVector(n),this.sub(i)}}(),reflect:function(){var i;return function(n){return void 0===i&&(i=new t.Vector3),this.sub(i.copy(n).multiplyScalar(2*this.dot(n)))}}(),angleTo:function(i){var n=this.dot(i)/(this.length()*i.length());return Math.acos(t.Math.clamp(n,-1,1))},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var i=this.x-t.x,n=this.y-t.y,s=this.z-t.z;return i*i+n*n+s*s},getPositionFromMatrix:function(t){return this.x=t.elements[12],this.y=t.elements[13],this.z=t.elements[14],this},getColumnFromMatrix:function(t,i){var n=4*t,s=i.elements;return this.x=s[n],this.y=s[n+1],this.z=s[n+2],this},setEulerFromRotationMatrix:function(t,i){function n(t){return Math.min(Math.max(t,-1),1)}var s=t.elements,h=s[0],r=s[4],e=s[8],a=s[1],o=s[5],u=s[9],c=s[2],f=s[6],l=s[10];return void 0===i||"XYZ"===i?(this.y=Math.asin(n(e)),Math.abs(e)<.99999?(this.x=Math.atan2(-u,l),this.z=Math.atan2(-r,h)):(this.x=Math.atan2(f,o),this.z=0)):"YXZ"===i?(this.x=Math.asin(-n(u)),Math.abs(u)<.99999?(this.y=Math.atan2(e,l),this.z=Math.atan2(a,o)):(this.y=Math.atan2(-c,h),this.z=0)):"ZXY"===i?(this.x=Math.asin(n(f)),Math.abs(f)<.99999?(this.y=Math.atan2(-c,l),this.z=Math.atan2(-r,o)):(this.y=0,this.z=Math.atan2(a,h))):"ZYX"===i?(this.y=Math.asin(-n(c)),Math.abs(c)<.99999?(this.x=Math.atan2(f,l),this.z=Math.atan2(a,h)):(this.x=0,this.z=Math.atan2(-r,o))):"YZX"===i?(this.z=Math.asin(n(a)),Math.abs(a)<.99999?(this.x=Math.atan2(-u,o),this.y=Math.atan2(-c,h)):(this.x=0,this.y=Math.atan2(e,l))):"XZY"===i&&(this.z=Math.asin(-n(r)),Math.abs(r)<.99999?(this.x=Math.atan2(f,o),this.y=Math.atan2(e,h)):(this.x=Math.atan2(-u,l),this.y=0)),this},dZn:function(t,i){function n(t){return Math.min(Math.max(t,-1),1)}var s=t.x*t.x,h=t.y*t.y,r=t.z*t.z,e=t.w*t.w;return void 0===i||"XYZ"===i?(this.x=Math.atan2(2*(t.x*t.w-t.y*t.z),e-s-h+r),this.y=Math.asin(n(2*(t.x*t.z+t.y*t.w))),this.z=Math.atan2(2*(t.z*t.w-t.x*t.y),e+s-h-r)):"YXZ"===i?(this.x=Math.asin(n(2*(t.x*t.w-t.y*t.z))),this.y=Math.atan2(2*(t.x*t.z+t.y*t.w),e-s-h+r),this.z=Math.atan2(2*(t.x*t.y+t.z*t.w),e-s+h-r)):"ZXY"===i?(this.x=Math.asin(n(2*(t.x*t.w+t.y*t.z))),this.y=Math.atan2(2*(t.y*t.w-t.z*t.x),e-s-h+r),this.z=Math.atan2(2*(t.z*t.w-t.x*t.y),e-s+h-r)):"ZYX"===i?(this.x=Math.atan2(2*(t.x*t.w+t.z*t.y),e-s-h+r),this.y=Math.asin(n(2*(t.y*t.w-t.x*t.z))),this.z=Math.atan2(2*(t.x*t.y+t.z*t.w),e+s-h-r)):"YZX"===i?(this.x=Math.atan2(2*(t.x*t.w-t.z*t.y),e-s+h-r),this.y=Math.atan2(2*(t.y*t.w-t.x*t.z),e+s-h-r),this.z=Math.asin(n(2*(t.x*t.y+t.z*t.w)))):"XZY"===i&&(this.x=Math.atan2(2*(t.x*t.w+t.y*t.z),e-s+h-r),this.y=Math.atan2(2*(t.x*t.z+t.y*t.w),e+s-h-r),this.z=Math.asin(n(2*(t.z*t.w-t.x*t.y)))),this},getScaleFromMatrix:function(t){var i=this.set(t.elements[0],t.elements[1],t.elements[2]).length(),n=this.set(t.elements[4],t.elements[5],t.elements[6]).length(),s=this.set(t.elements[8],t.elements[9],t.elements[10]).length();return this.x=i,this.y=n,this.z=s,this},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z},toArray:function(){return[this.x,this.y,this.z]},clone:function(){return new t.Vector3(this.x,this.y,this.z)},isNaN:function(){return!(isFinite(this.x)&&isFinite(this.y)&&isFinite(this.z))}},t.Vector4=function(t,i,n,s){this.x=t||0,this.y=i||0,this.z=n||0,this.w=void 0!==s?s:1},t.Vector4.prototype={constructor:t.Vector4,set:function(t,i,n,s){return this.x=t,this.y=i,this.z=n,this.w=s,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},mZn:function(t){return this.w=t,this},setComponent:function(t,i){switch(t){case 0:this.x=i;break;case 1:this.y=i;break;case 2:this.z=i;break;case 3:this.w=i;break;default:throw new Error("index is out of range: "+t)}},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=void 0!==t.w?t.w:1,this},add:function(t,i){return void 0!==i?this.addVectors(t,i):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this},addVectors:function(t,i){return this.x=t.x+i.x,this.y=t.y+i.y,this.z=t.z+i.z,this.w=t.w+i.w,this},sub:function(t,i){return void 0!==i?this.subVectors(t,i):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this)},subVectors:function(t,i){return this.x=t.x-i.x,this.y=t.y-i.y,this.z=t.z-i.z,this.w=t.w-i.w,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},Fm:function(t){if(!t)return this;var i=this.x,n=this.y,s=this.z,h=this.w,r=t.elements;return this.x=r[0]*i+r[4]*n+r[8]*s+r[12]*h,this.y=r[1]*i+r[5]*n+r[9]*s+r[13]*h,this.z=r[2]*i+r[6]*n+r[10]*s+r[14]*h,this.w=r[3]*i+r[7]*n+r[11]*s+r[15]*h,this},divideScalar:function(t){return 0!==t?(this.x/=t,this.y/=t,this.z/=t,this.w/=t):(this.x=0,this.y=0,this.z=0,this.w=1),this},MZn:function(t){this.w=2*Math.acos(t.w);var i=Math.sqrt(1-t.w*t.w);return i<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t.x/i,this.y=t.y/i,this.z=t.z/i),this},pZn:function(t){var i,n,s,h,r=t.elements,e=r[0],a=r[4],o=r[8],u=r[1],c=r[5],f=r[9],l=r[2],v=r[6],d=r[10];if(Math.abs(a-u)<.01&&Math.abs(o-l)<.01&&Math.abs(f-v)<.01){if(Math.abs(a+u)<.1&&Math.abs(o+l)<.1&&Math.abs(f+v)<.1&&Math.abs(e+c+d-3)<.1)return this.set(1,0,0,0),this;i=Math.PI;var m=(e+1)/2,M=(c+1)/2,p=(d+1)/2,g=(a+u)/4,b=(o+l)/4,y=(f+v)/4;return m>M&&m>p?m<.01?(n=0,s=.707106781,h=.707106781):(s=g/(n=Math.sqrt(m)),h=b/n):M>p?M<.01?(n=.707106781,s=0,h=.707106781):(n=g/(s=Math.sqrt(M)),h=y/s):p<.01?(n=.707106781,s=.707106781,h=0):(n=b/(h=Math.sqrt(p)),s=y/h),this.set(n,s,h,i),this}var w=Math.sqrt((v-f)*(v-f)+(o-l)*(o-l)+(u-a)*(u-a));return Math.abs(w)<.001&&(w=1),this.x=(v-f)/w,this.y=(o-l)/w,this.z=(u-a)/w,this.w=Math.acos((e+c+d-1)/2),this},getColumnFromMatrix:function(t,i){var n=4*t,s=i.elements;return this.x=s[n],this.y=s[n+1],this.z=s[n+2],this.w=1,this},min:function(t){return this.x>t.x&&(this.x=t.x),this.y>t.y&&(this.y=t.y),this.z>t.z&&(this.z=t.z),this.w>t.w&&(this.w=t.w),this},max:function(t){return this.x<t.x&&(this.x=t.x),this.y<t.y&&(this.y=t.y),this.z<t.z&&(this.z=t.z),this.w<t.w&&(this.w=t.w),this},clamp:function(t,i){return this.x<t.x?this.x=t.x:this.x>i.x&&(this.x=i.x),this.y<t.y?this.y=t.y:this.y>i.y&&(this.y=i.y),this.z<t.z?this.z=t.z:this.z>i.z&&(this.z=i.z),this.w<t.w?this.w=t.w:this.w>i.w&&(this.w=i.w),this},negate:function(){return this.multiplyScalar(-1)},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},vZn:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(t,i){return Math.sqrt(this.distanceToSquared(t,i))},distanceToSquared:function(t,i){var n=this.x-t.x,s=this.y-t.y,h=this.z-t.z,r=n*n+s*s+h*h;return i&&(r+=this.w-t.w),r},setLength:function(t){var i=this.length();return 0!==i&&t!==i&&this.multiplyScalar(t/i),this},lerp:function(t,i){return this.x+=(t.x-this.x)*i,this.y+=(t.y-this.y)*i,this.z+=(t.z-this.z)*i,this.w+=(t.w-this.w)*i,this},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w},toArray:function(){return[this.x,this.y,this.z,this.w]},clone:function(){return new t.Vector4(this.x,this.y,this.z,this.w)}},t.Matrix3=function(t,i,n,s,h,r,e,a,o){this.elements=new Float32Array(9),this.set(void 0!==t?t:1,i||0,n||0,s||0,void 0!==h?h:1,r||0,e||0,a||0,void 0!==o?o:1)},t.Matrix3.prototype={constructor:t.Matrix3,set:function(t,i,n,s,h,r,e,a,o){var u=this.elements;return u[0]=t,u[3]=i,u[6]=n,u[1]=s,u[4]=h,u[7]=r,u[2]=e,u[5]=a,u[8]=o,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},isIdentity:function(){var t=this.elements;return 1===t[0]&&0===t[1]&&0===t[2]&&0===t[3]&&1===t[4]&&0===t[5]&&0===t[6]&&0===t[7]&&1===t[8]},copy:function(t){var i=t.elements;return this.set(i[0],i[3],i[6],i[1],i[4],i[7],i[2],i[5],i[8]),this},multiplyVector3:function(t){return t.applyMatrix3(this)},gZn:function(){var i=new t.Vector3;return function(t){for(var n=0,s=t.length;n<s;n+=3)i.x=t[n],i.y=t[n+1],i.z=t[n+2],i.applyMatrix3(this),t[n]=i.x,t[n+1]=i.y,t[n+2]=i.z;return t}}(),multiplyScalar:function(t){var i=this.elements;return i[0]*=t,i[3]*=t,i[6]*=t,i[1]*=t,i[4]*=t,i[7]*=t,i[2]*=t,i[5]*=t,i[8]*=t,this},multiplyMatrices:function(t,i){if(!i)return this.copy(t),this;var n=t.elements,s=i.elements,h=this.elements,r=n[0],e=n[3],a=n[6],o=n[1],u=n[4],c=n[7],f=n[2],l=n[5],v=n[8],d=s[0],m=s[3],M=s[6],p=s[1],g=s[4],b=s[7],y=s[2],w=s[5],A=s[8];return h[0]=r*d+e*p+a*y,h[3]=r*m+e*g+a*w,h[6]=r*M+e*b+a*A,h[1]=o*d+u*p+c*y,h[4]=o*m+u*g+c*w,h[7]=o*M+u*b+c*A,h[2]=f*d+l*p+v*y,h[5]=f*m+l*g+v*w,h[8]=f*M+l*b+v*A,this},determinant:function(){var t=this.elements,i=t[0],n=t[1],s=t[2],h=t[3],r=t[4],e=t[5],a=t[6],o=t[7],u=t[8];return i*r*u-i*e*o-n*h*u+n*e*a+s*h*o-s*r*a},getInverse:function(t,i){var n=t.elements,s=this.elements;s[0]=n[10]*n[5]-n[6]*n[9],s[1]=-n[10]*n[1]+n[2]*n[9],s[2]=n[6]*n[1]-n[2]*n[5],s[3]=-n[10]*n[4]+n[6]*n[8],s[4]=n[10]*n[0]-n[2]*n[8],s[5]=-n[6]*n[0]+n[2]*n[4],s[6]=n[9]*n[4]-n[5]*n[8],s[7]=-n[9]*n[0]+n[1]*n[8],s[8]=n[5]*n[0]-n[1]*n[4];var h=n[0]*s[0]+n[1]*s[3]+n[2]*s[6];if(0===h){if(i)throw new Error("Matrix3.getInverse(): can't invert matrix, determinant is 0");return this.identity(),this}return this.multiplyScalar(1/h),this},transpose:function(){var t,i=this.elements;return t=i[1],i[1]=i[3],i[3]=t,t=i[2],i[2]=i[6],i[6]=t,t=i[5],i[5]=i[7],i[7]=t,this},bZn:function(t){return this.getInverse(t).transpose(),this},yZn:function(t){var i=this.elements;return t[0]=i[0],t[1]=i[3],t[2]=i[6],t[3]=i[1],t[4]=i[4],t[5]=i[7],t[6]=i[2],t[7]=i[5],t[8]=i[8],this},clone:function(){var i=this.elements;return new t.Matrix3(i[0],i[3],i[6],i[1],i[4],i[7],i[2],i[5],i[8])},flattenToArray:function(t){var i=this.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],t},scale:function(t){var i=this.elements,n=t.x,s=t.y;return i[0]*=n,i[3]*=s,i[1]*=n,i[4]*=s,i[2]*=n,i[5]*=s,this},wZn:function(){var t=this.elements;return new Matrix4(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1)}},t._Float32Matrix4=function(t,i,n,s,h,r,e,a,o,u,c,f,l,v,d,m){this.elements=new Float32Array(16)},t._Float32Matrix4.prototype={constructor:t._Float32Matrix4,set:function(t,i,n,s,h,r,e,a,o,u,c,f,l,v,d,m){var M=this.elements;return M[0]=t,M[4]=i,M[8]=n,M[12]=s,M[1]=h,M[5]=r,M[9]=e,M[13]=a,M[2]=o,M[6]=u,M[10]=c,M[14]=f,M[3]=l,M[7]=v,M[11]=d,M[15]=m,this},_fromMatrix4WithLowPartTranslation(t){this.elements.set(t.elements);var i=t.AZn();return this.elements[3]=i.x,this.elements[7]=i.y,this.elements[11]=i.z,this},isIdentity:function(){var t=this.elements;return 1===t[0]&&0===t[1]&&0===t[2]&&0===t[3]&&0===t[4]&&1===t[5]&&0===t[6]&&0===t[7]&&0===t[8]&&0===t[9]&&1===t[10]&&0===t[11]&&0===t[12]&&0===t[13]&&0===t[14]&&1===t[15]},_multiplyMatricesMV:function(t,i){var n=t.elements,s=i.elements,h=this.elements,r=n[0],e=n[4],a=n[8],o=n[12],u=n[1],c=n[5],f=n[9],l=n[13],v=n[2],d=n[6],m=n[10],M=n[14],p=s[0],g=s[4],b=s[8],y=s[12],w=s[1],A=s[5],E=s[9],I=s[13],x=s[2],S=s[6],O=s[10],N=s[14];return h[0]=r*p+e*w+a*x,h[4]=r*g+e*A+a*S,h[8]=r*b+e*E+a*O,h[12]=r*y+e*I+a*N+o,h[1]=u*p+c*w+f*x,h[5]=u*g+c*A+f*S,h[9]=u*b+c*E+f*O,h[13]=u*y+c*I+f*N+l,h[2]=v*p+d*w+m*x,h[6]=v*g+d*A+m*S,h[10]=v*b+d*E+m*O,h[14]=v*y+d*I+m*N+M,h[3]=0,h[7]=0,h[11]=0,h[15]=1,this},multiplyMatricesAndInverse:function(i,n){var s=(new t.Matrix4).multiplyMatrices(i,n);return this.getInverse(s)},transpose:function(){var t,i=this.elements;return t=i[1],i[1]=i[4],i[4]=t,t=i[2],i[2]=i[8],i[8]=t,t=i[6],i[6]=i[9],i[9]=t,t=i[3],i[3]=i[12],i[12]=t,t=i[7],i[7]=i[13],i[13]=t,t=i[11],i[11]=i[14],i[14]=t,this},getInverse:function(t,i){var n=this.elements,s=t.elements,h=s[0],r=s[4],e=s[8],a=s[12],o=s[1],u=s[5],c=s[9],f=s[13],l=s[2],v=s[6],d=s[10],m=s[14],M=s[3],p=s[7],g=s[11],b=s[15];n[0]=c*m*p-f*d*p+f*v*g-u*m*g-c*v*b+u*d*b,n[4]=a*d*p-e*m*p-a*v*g+r*m*g+e*v*b-r*d*b,n[8]=e*f*p-a*c*p+a*u*g-r*f*g-e*u*b+r*c*b,n[12]=a*c*v-e*f*v-a*u*d+r*f*d+e*u*m-r*c*m,n[1]=f*d*M-c*m*M-f*l*g+o*m*g+c*l*b-o*d*b,n[5]=e*m*M-a*d*M+a*l*g-h*m*g-e*l*b+h*d*b,n[9]=a*c*M-e*f*M-a*o*g+h*f*g+e*o*b-h*c*b,n[13]=e*f*l-a*c*l+a*o*d-h*f*d-e*o*m+h*c*m,n[2]=u*m*M-f*v*M+f*l*p-o*m*p-u*l*b+o*v*b,n[6]=a*v*M-r*m*M-a*l*p+h*m*p+r*l*b-h*v*b,n[10]=r*f*M-a*u*M+a*o*p-h*f*p-r*o*b+h*u*b,n[14]=a*u*l-r*f*l-a*o*v+h*f*v+r*o*m-h*u*m,n[3]=c*v*M-u*d*M-c*l*p+o*d*p+u*l*g-o*v*g,n[7]=r*d*M-e*v*M+e*l*p-h*d*p-r*l*g+h*v*g,n[11]=e*u*M-r*c*M-e*o*p+h*c*p+r*o*g-h*u*g,n[15]=r*c*l-e*u*l+e*o*v-h*c*v-r*o*d+h*u*d;var y=s[0]*n[0]+s[1]*n[4]+s[2]*n[8]+s[3]*n[12];if(0==y){if(i)throw new Error("Matrix4.getInverse(): can't invert matrix, determinant is 0");return this.identity(),this}return this.multiplyScalar(1/y),this},multiplyScalar:function(t){var i=this.elements;return i[0]*=t,i[4]*=t,i[8]*=t,i[12]*=t,i[1]*=t,i[5]*=t,i[9]*=t,i[13]*=t,i[2]*=t,i[6]*=t,i[10]*=t,i[14]*=t,i[3]*=t,i[7]*=t,i[11]*=t,i[15]*=t,this}};var u=new Float32Array(1);t.SplitFloat32=function(t){u[0]=t;var i=u[0];return{low:t-i,high:i}},t._SplitFloat32PositiveError=function(t){u[0]=t;var i=u[0],n=t-i;return n<0&&(i-=2*(n=-n)),{low:n,high:i}};var c,f,l,v,d,m;return t.Matrix4=function(t,i,n,s,h,r,e,a,o,u,c,f,l,v,d,m){this.elements=void 0!==t?[t,h,o,l,i,r,u,v,n,e,c,d,s,a,f,m]:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},t.Matrix4.prototype={constructor:t.Matrix4,AZn:function(){var i=t.SplitFloat32(this.elements[12]),n=t.SplitFloat32(this.elements[13]),s=t.SplitFloat32(this.elements[14]),h=new t.Vector3;return h.x=i.low,h.y=n.low,h.z=s.low,h},set:function(t,i,n,s,h,r,e,a,o,u,c,f,l,v,d,m){var M=this.elements;return M[0]=t,M[4]=i,M[8]=n,M[12]=s,M[1]=h,M[5]=r,M[9]=e,M[13]=a,M[2]=o,M[6]=u,M[10]=c,M[14]=f,M[3]=l,M[7]=v,M[11]=d,M[15]=m,this},getValue:function(t,i){return this.elements[4*(i-1)+t-1]},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},isIdentity:function(){var t=this.elements;return 1===t[0]&&0===t[1]&&0===t[2]&&0===t[3]&&0===t[4]&&1===t[5]&&0===t[6]&&0===t[7]&&0===t[8]&&0===t[9]&&1===t[10]&&0===t[11]&&0===t[12]&&0===t[13]&&0===t[14]&&1===t[15]},copy:function(t){var i=t.elements;return this.set(i[0],i[4],i[8],i[12],i[1],i[5],i[9],i[13],i[2],i[6],i[10],i[14],i[3],i[7],i[11],i[15]),this},PN:function(){if(this.isIdentity())return"identity";var t,i=[],n=this.elements;if(1===n[0]&&0===n[1]&&0===n[2]&&0===n[3]&&0===n[4]&&1===n[5]&&0===n[6]&&0===n[7]&&0===n[8]&&0===n[9]&&1===n[10]&&0===n[11]&&1===n[15])i.push(n[12]),i.push(n[13]),i.push(n[14]);else for(t=0;t<16;t++)i.push(this.elements[t]);return i},My:function(t){if("identity"===t)this.identity();else if(3===t.length)this.identity(),this.elements[12]=t[0],this.elements[13]=t[1],this.elements[14]=t[2];else{var i;for(i=0;i<16;i++)this.elements[i]=t[i]}return this},setRotationFromEuler:function(t,i){var n=this.elements,s=t.x,h=t.y,r=t.z,e=Math.cos(s),a=Math.sin(s),o=Math.cos(h),u=Math.sin(h),c=Math.cos(r),f=Math.sin(r);if(void 0===i||"XYZ"===i){var l=e*c,v=e*f,d=a*c,m=a*f;n[0]=o*c,n[4]=-o*f,n[8]=u,n[1]=v+d*u,n[5]=l-m*u,n[9]=-a*o,n[2]=m-l*u,n[6]=d+v*u,n[10]=e*o}else if("YXZ"===i){var M=o*c,p=o*f,g=u*c,b=u*f;n[0]=M+b*a,n[4]=g*a-p,n[8]=e*u,n[1]=e*f,n[5]=e*c,n[9]=-a,n[2]=p*a-g,n[6]=b+M*a,n[10]=e*o}else if("ZXY"===i){M=o*c,p=o*f,g=u*c,b=u*f;n[0]=M-b*a,n[4]=-e*f,n[8]=g+p*a,n[1]=p+g*a,n[5]=e*c,n[9]=b-M*a,n[2]=-e*u,n[6]=a,n[10]=e*o}else if("ZYX"===i){l=e*c,v=e*f,d=a*c,m=a*f;n[0]=o*c,n[4]=d*u-v,n[8]=l*u+m,n[1]=o*f,n[5]=m*u+l,n[9]=v*u-d,n[2]=-u,n[6]=a*o,n[10]=e*o}else if("YZX"===i){var y=e*o,w=e*u,A=a*o,E=a*u;n[0]=o*c,n[4]=E-y*f,n[8]=A*f+w,n[1]=f,n[5]=e*c,n[9]=-a*c,n[2]=-u*c,n[6]=w*f+A,n[10]=y-E*f}else if("XZY"===i){y=e*o,w=e*u,A=a*o,E=a*u;n[0]=o*c,n[4]=-f,n[8]=u*c,n[1]=y*f+E,n[5]=e*c,n[9]=w*f-A,n[2]=A*f-w,n[6]=a*c,n[10]=E*f+y}return this},setRotationFromQuaternion:function(t){var i=this.elements,n=t.x,s=t.y,h=t.z,r=t.w,e=n+n,a=s+s,o=h+h,u=n*e,c=n*a,f=n*o,l=s*a,v=s*o,d=h*o,m=r*e,M=r*a,p=r*o;return i[0]=1-(l+d),i[4]=c-p,i[8]=f+M,i[1]=c+p,i[5]=1-(u+d),i[9]=v-m,i[2]=f-M,i[6]=v+m,i[10]=1-(u+l),this},makeRotationFromQuaternion:function(t){var i=this.elements,n=t.x,s=t.y,h=t.z,r=t.w,e=n+n,a=s+s,o=h+h,u=n*e,c=n*a,f=n*o,l=s*a,v=s*o,d=h*o,m=r*e,M=r*a,p=r*o;return i[0]=1-(l+d),i[4]=c-p,i[8]=f+M,i[1]=c+p,i[5]=1-(u+d),i[9]=v-m,i[2]=f-M,i[6]=v+m,i[10]=1-(u+l),i[3]=0,i[7]=0,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,this},lookAt:(c=new t.Vector3,f=new t.Vector3,l=new t.Vector3,function(t,i,n){var s=this.elements;return l.subVectors(t,i).normalize(),0===l.length()&&(l.z=1),c.crossVectors(n,l).normalize(),0===c.length()&&(l.x+=1e-4,c.crossVectors(n,l).normalize()),f.crossVectors(l,c),s[0]=c.x,s[4]=f.x,s[8]=l.x,s[1]=c.y,s[5]=f.y,s[9]=l.y,s[2]=c.z,s[6]=f.z,s[10]=l.z,this}),multiply:function(t,i){return void 0!==i?this.multiplyMatrices(t,i):this.multiplyMatrices(this,t)},multiplyMatrices:function(t,i){if(!i)return this.copy(t),this;var n=t.elements,s=i.elements,h=this.elements,r=n[0],e=n[4],a=n[8],o=n[12],u=n[1],c=n[5],f=n[9],l=n[13],v=n[2],d=n[6],m=n[10],M=n[14],p=n[3],g=n[7],b=n[11],y=n[15],w=s[0],A=s[4],E=s[8],I=s[12],x=s[1],S=s[5],O=s[9],N=s[13],T=s[2],_=s[6],R=s[10],k=s[14],L=s[3],P=s[7],z=s[11],F=s[15];return h[0]=r*w+e*x+a*T+o*L,h[4]=r*A+e*S+a*_+o*P,h[8]=r*E+e*O+a*R+o*z,h[12]=r*I+e*N+a*k+o*F,h[1]=u*w+c*x+f*T+l*L,h[5]=u*A+c*S+f*_+l*P,h[9]=u*E+c*O+f*R+l*z,h[13]=u*I+c*N+f*k+l*F,h[2]=v*w+d*x+m*T+M*L,h[6]=v*A+d*S+m*_+M*P,h[10]=v*E+d*O+m*R+M*z,h[14]=v*I+d*N+m*k+M*F,h[3]=p*w+g*x+b*T+y*L,h[7]=p*A+g*S+b*_+y*P,h[11]=p*E+g*O+b*R+y*z,h[15]=p*I+g*N+b*k+y*F,this},EZn:function(t,i,n){var s=this.elements;return this.multiplyMatrices(t,i),n[0]=s[0],n[1]=s[1],n[2]=s[2],n[3]=s[3],n[4]=s[4],n[5]=s[5],n[6]=s[6],n[7]=s[7],n[8]=s[8],n[9]=s[9],n[10]=s[10],n[11]=s[11],n[12]=s[12],n[13]=s[13],n[14]=s[14],n[15]=s[15],this},multiplyScalar:function(t){var i=this.elements;return i[0]*=t,i[4]*=t,i[8]*=t,i[12]*=t,i[1]*=t,i[5]*=t,i[9]*=t,i[13]*=t,i[2]*=t,i[6]*=t,i[10]*=t,i[14]*=t,i[3]*=t,i[7]*=t,i[11]*=t,i[15]*=t,this},multiplyVector3:function(t){return t.applyProjection(this)},IZn:function(t){return t.Fm(this)},gZn:function(){var i=new t.Vector3;return function(t){for(var n=0,s=t.length;n<s;n+=3)i.x=t[n],i.y=t[n+1],i.z=t[n+2],i.applyProjection(this),t[n]=i.x,t[n+1]=i.y,t[n+2]=i.z;return t}}(),xZn:function(t){t.transformDirection(this)},crossVector:function(i){var n=this.elements,s=new t.Vector4;return s.x=n[0]*i.x+n[4]*i.y+n[8]*i.z+n[12]*i.w,s.y=n[1]*i.x+n[5]*i.y+n[9]*i.z+n[13]*i.w,s.z=n[2]*i.x+n[6]*i.y+n[10]*i.z+n[14]*i.w,s.w=i.w?n[3]*i.x+n[7]*i.y+n[11]*i.z+n[15]*i.w:1,s},determinant:function(){var t=this.elements,i=t[0],n=t[4],s=t[8],h=t[12],r=t[1],e=t[5],a=t[9],o=t[13],u=t[2],c=t[6],f=t[10],l=t[14];return t[3]*(+h*a*c-s*o*c-h*e*f+n*o*f+s*e*l-n*a*l)+t[7]*(+i*a*l-i*o*f+h*r*f-s*r*l+s*o*u-h*a*u)+t[11]*(+i*o*c-i*e*l-h*r*c+n*r*l+h*e*u-n*o*u)+t[15]*(-s*e*u-i*a*c+i*e*f+s*r*c-n*r*f+n*a*u)},transpose:function(){var t,i=this.elements;return t=i[1],i[1]=i[4],i[4]=t,t=i[2],i[2]=i[8],i[8]=t,t=i[6],i[6]=i[9],i[9]=t,t=i[3],i[3]=i[12],i[12]=t,t=i[7],i[7]=i[13],i[13]=t,t=i[11],i[11]=i[14],i[14]=t,this},flattenToArray:function(t){var i=this.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],t[9]=i[9],t[10]=i[10],t[11]=i[11],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15],t},setFromArray:function(t){var i=this.elements;return i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3],i[4]=t[4],i[5]=t[5],i[6]=t[6],i[7]=t[7],i[8]=t[8],i[9]=t[9],i[10]=t[10],i[11]=t[11],i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15],this},flattenToArrayOffset:function(t,i){var n=this.elements;return t[i]=n[0],t[i+1]=n[1],t[i+2]=n[2],t[i+3]=n[3],t[i+4]=n[4],t[i+5]=n[5],t[i+6]=n[6],t[i+7]=n[7],t[i+8]=n[8],t[i+9]=n[9],t[i+10]=n[10],t[i+11]=n[11],t[i+12]=n[12],t[i+13]=n[13],t[i+14]=n[14],t[i+15]=n[15],t},getPosition:function(){var i=new t.Vector3;return function(){var t=this.elements;return i.set(t[12],t[13],t[14])}}(),setPosition:function(t){var i=this.elements;return i[12]=t.x,i[13]=t.y,i[14]=t.z,this},getInverse:function(t,i){var n=this.elements,s=t.elements,h=s[0],r=s[4],e=s[8],a=s[12],o=s[1],u=s[5],c=s[9],f=s[13],l=s[2],v=s[6],d=s[10],m=s[14],M=s[3],p=s[7],g=s[11],b=s[15];n[0]=c*m*p-f*d*p+f*v*g-u*m*g-c*v*b+u*d*b,n[4]=a*d*p-e*m*p-a*v*g+r*m*g+e*v*b-r*d*b,n[8]=e*f*p-a*c*p+a*u*g-r*f*g-e*u*b+r*c*b,n[12]=a*c*v-e*f*v-a*u*d+r*f*d+e*u*m-r*c*m,n[1]=f*d*M-c*m*M-f*l*g+o*m*g+c*l*b-o*d*b,n[5]=e*m*M-a*d*M+a*l*g-h*m*g-e*l*b+h*d*b,n[9]=a*c*M-e*f*M-a*o*g+h*f*g+e*o*b-h*c*b,n[13]=e*f*l-a*c*l+a*o*d-h*f*d-e*o*m+h*c*m,n[2]=u*m*M-f*v*M+f*l*p-o*m*p-u*l*b+o*v*b,n[6]=a*v*M-r*m*M-a*l*p+h*m*p+r*l*b-h*v*b,n[10]=r*f*M-a*u*M+a*o*p-h*f*p-r*o*b+h*u*b,n[14]=a*u*l-r*f*l-a*o*v+h*f*v+r*o*m-h*u*m,n[3]=c*v*M-u*d*M-c*l*p+o*d*p+u*l*g-o*v*g,n[7]=r*d*M-e*v*M+e*l*p-h*d*p-r*l*g+h*v*g,n[11]=e*u*M-r*c*M-e*o*p+h*c*p+r*o*g-h*u*g,n[15]=r*c*l-e*u*l+e*o*v-h*c*v-r*o*d+h*u*d;var y=s[0]*n[0]+s[1]*n[4]+s[2]*n[8]+s[3]*n[12];if(0==y){if(i)throw new Error("Matrix4.getInverse(): can't invert matrix, determinant is 0");return this.identity(),this}return this.multiplyScalar(1/y),this},extractBasis:function(t,i,n){var s=this.elements;return t.set(s[0],s[1],s[2]),i.set(s[4],s[5],s[6]),n.set(s[8],s[9],s[10]),this},makeBasis:function(t,i,n){return this.set(t.x,i.x,n.x,0,t.y,i.y,n.y,0,t.z,i.z,n.z,0,0,0,0,1),this},SZn:function(t){var i=this.elements,n=t.elements;return i[12]=n[12],i[13]=n[13],i[14]=n[14],this},extractRotation:function(i){var n=new t.Vector3;return function(t){var i=this.elements,s=t.elements,h=1/n.set(s[0],s[1],s[2]).length(),r=1/n.set(s[4],s[5],s[6]).length(),e=1/n.set(s[8],s[9],s[10]).length();return i[0]=s[0]*h,i[1]=s[1]*h,i[2]=s[2]*h,i[4]=s[4]*r,i[5]=s[5]*r,i[6]=s[6]*r,i[8]=s[8]*e,i[9]=s[9]*e,i[10]=s[10]*e,this}}(),extractMatrix3:function(i){new t.Vector3;return function(t){var i=this.elements,n=t.elements;return i[0]=n[0],i[1]=n[1],i[2]=n[2],i[4]=n[4],i[5]=n[5],i[6]=n[6],i[8]=n[8],i[9]=n[9],i[10]=n[10],this}}(),translate:function(t){var i=this.elements,n=t.x,s=t.y,h=t.z;return i[12]=i[0]*n+i[4]*s+i[8]*h+i[12],i[13]=i[1]*n+i[5]*s+i[9]*h+i[13],i[14]=i[2]*n+i[6]*s+i[10]*h+i[14],i[15]=i[3]*n+i[7]*s+i[11]*h+i[15],this},rotateX:function(t){var i=this.elements,n=i[4],s=i[5],h=i[6],r=i[7],e=i[8],a=i[9],o=i[10],u=i[11],c=Math.cos(t),f=Math.sin(t);return i[4]=c*n+f*e,i[5]=c*s+f*a,i[6]=c*h+f*o,i[7]=c*r+f*u,i[8]=c*e-f*n,i[9]=c*a-f*s,i[10]=c*o-f*h,i[11]=c*u-f*r,this},rotateY:function(t){var i=this.elements,n=i[0],s=i[1],h=i[2],r=i[3],e=i[8],a=i[9],o=i[10],u=i[11],c=Math.cos(t),f=Math.sin(t);return i[0]=c*n-f*e,i[1]=c*s-f*a,i[2]=c*h-f*o,i[3]=c*r-f*u,i[8]=c*e+f*n,i[9]=c*a+f*s,i[10]=c*o+f*h,i[11]=c*u+f*r,this},rotateZ:function(t){var i=this.elements,n=i[0],s=i[1],h=i[2],r=i[3],e=i[4],a=i[5],o=i[6],u=i[7],c=Math.cos(t),f=Math.sin(t);return i[0]=c*n+f*e,i[1]=c*s+f*a,i[2]=c*h+f*o,i[3]=c*r+f*u,i[4]=c*e-f*n,i[5]=c*a-f*s,i[6]=c*o-f*h,i[7]=c*u-f*r,this},rotateByAxis:function(t,i){var n=this.elements;if(1===t.x&&0===t.y&&0===t.z)return this.rotateX(i);if(0===t.x&&1===t.y&&0===t.z)return this.rotateY(i);if(0===t.x&&0===t.y&&1===t.z)return this.rotateZ(i);var s=t.x,h=t.y,r=t.z,e=Math.sqrt(s*s+h*h+r*r),a=(s/=e)*s,o=(h/=e)*h,u=(r/=e)*r,c=Math.cos(i),f=Math.sin(i),l=1-c,v=s*h*l,d=s*r*l,m=h*r*l,M=s*f,p=h*f,g=r*f,b=a+(1-a)*c,y=v+g,w=d-p,A=v-g,E=o+(1-o)*c,I=m+M,x=d+p,S=m-M,O=u+(1-u)*c,N=n[0],T=n[1],_=n[2],R=n[3],k=n[4],L=n[5],P=n[6],z=n[7],F=n[8],C=n[9],D=n[10],Y=n[11];return n[0]=b*N+y*k+w*F,n[1]=b*T+y*L+w*C,n[2]=b*_+y*P+w*D,n[3]=b*R+y*z+w*Y,n[4]=A*N+E*k+I*F,n[5]=A*T+E*L+I*C,n[6]=A*_+E*P+I*D,n[7]=A*R+E*z+I*Y,n[8]=x*N+S*k+O*F,n[9]=x*T+S*L+O*C,n[10]=x*_+S*P+O*D,n[11]=x*R+S*z+O*Y,this},scale:function(t){var i=this.elements,n=t.x,s=t.y,h=t.z;return i[0]*=n,i[4]*=s,i[8]*=h,i[1]*=n,i[5]*=s,i[9]*=h,i[2]*=n,i[6]*=s,i[10]*=h,i[3]*=n,i[7]*=s,i[11]*=h,this},getMaxScaleOnAxis:function(){var t=this.elements,i=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],n=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],s=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(i,Math.max(n,s)))},getScaleOnAxisX:function(){var t=this.elements,i=t[0]*t[0]+t[1]*t[1]+t[2]*t[2];return Math.sqrt(i)},getScaleOnAxisY:function(){var t=this.elements,i=t[4]*t[4]+t[5]*t[5]+t[6]*t[6];return Math.sqrt(i)},OZn:function(){var t=this.elements,i=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(i)},makeTranslation:function(t,i,n){return this.set(1,0,0,t,0,1,0,i,0,0,1,n,0,0,0,1),this},makeRotationX:function(t){var i=Math.cos(t),n=Math.sin(t);return this.set(1,0,0,0,0,i,-n,0,0,n,i,0,0,0,0,1),this},makeRotationY:function(t){var i=Math.cos(t),n=Math.sin(t);return this.set(i,0,n,0,0,1,0,0,-n,0,i,0,0,0,0,1),this},makeRotationZ:function(t){var i=Math.cos(t),n=Math.sin(t);return this.set(i,-n,0,0,n,i,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(t,i){var n=Math.cos(i),s=Math.sin(i),h=1-n,r=t.x,e=t.y,a=t.z,o=h*r,u=h*e;return this.set(o*r+n,o*e-s*a,o*a+s*e,0,o*e+s*a,u*e+n,u*a-s*r,0,o*a-s*e,u*a+s*r,h*a*a+n,0,0,0,0,1),this},makeScale:function(t,i,n){return this.set(t,0,0,0,0,i,0,0,0,0,n,0,0,0,0,1),this},makeFrustum:function(t,i,n,s,h,r){var e=this.elements,a=2*h/(i-t),o=2*h/(s-n),u=(i+t)/(i-t),c=(s+n)/(s-n),f=-(r+h)/(r-h),l=-2*r*h/(r-h);return e[0]=a,e[4]=0,e[8]=u,e[12]=0,e[1]=0,e[5]=o,e[9]=c,e[13]=0,e[2]=0,e[6]=0,e[10]=f,e[14]=l,e[3]=0,e[7]=0,e[11]=-1,e[15]=0,this},makePerspective:function(i,n,s,h,r,e){var a=s*Math.tan(t.Math.degToRad(.5*i)),o=-a,u=o*n,c=a*n;return r&&(u+=r*=Math.abs(c-u),c+=r),e&&(o+=e*=Math.abs(a-o),a+=e),this.makeFrustum(u,c,o,a,s,h)},makeOrthographic:function(t,i,n,s,h,r){var e=this.elements,a=i-t,o=n-s,u=r-h,c=(i+t)/a,f=(n+s)/o,l=(r+h)/u;return e[0]=2/a,e[4]=0,e[8]=0,e[12]=-c,e[1]=0,e[5]=2/o,e[9]=0,e[13]=-f,e[2]=0,e[6]=0,e[10]=-2/u,e[14]=-l,e[3]=0,e[7]=0,e[11]=0,e[15]=1,this},clone:function(){var i=this.elements;return new t.Matrix4(i[0],i[4],i[8],i[12],i[1],i[5],i[9],i[13],i[2],i[6],i[10],i[14],i[3],i[7],i[11],i[15])},setRotation:function(t){var i=this.elements;return i[0]=t[0],i[4]=t[1],i[8]=t[2],i[1]=t[3],i[5]=t[4],i[9]=t[5],i[2]=t[6],i[6]=t[7],i[10]=t[8],this},equals:function(t,i){var n=this.elements,s=t.elements;if(void 0===i){for(var h=0;h<16;h++)if(n[h]!==s[h])return!1}else for(h=0;h<16;h++)if(Math.abs(n[h]-s[h])>i)return!1;return!0}},t.IdentityMatrix=new t.Matrix4,t.extend(t.Matrix4.prototype,{compose:(v=new t.Matrix4,d=new t.Matrix4,function(t,i,n){var s=this.elements;return v.identity(),v.setRotationFromQuaternion(i),d.makeScale(n.x,n.y,n.z),this.multiplyMatrices(v,d),s[12]=t.x,s[13]=t.y,s[14]=t.z,this}),decompose:function(){var i=new t.Vector3,n=new t.Vector3,s=new t.Vector3,h=new t.Matrix4;return function(r,e,a){var o=this.elements;return i.set(o[0],o[1],o[2]),n.set(o[4],o[5],o[6]),s.set(o[8],o[9],o[10]),r=r instanceof t.Vector3?r:new t.Vector3,e=e instanceof t.Quaternion?e:new t.Quaternion,(a=a instanceof t.Vector3?a:new t.Vector3).x=i.length(),a.y=n.length(),a.z=s.length(),r.x=o[12],r.y=o[13],r.z=o[14],h.copy(this),h.elements[0]/=a.x,h.elements[1]/=a.x,h.elements[2]/=a.x,h.elements[4]/=a.y,h.elements[5]/=a.y,h.elements[6]/=a.y,h.elements[8]/=a.z,h.elements[9]/=a.z,h.elements[10]/=a.z,e.setFromRotationMatrix(h),[r,e,a]}}()}),t.Color=function(t){return void 0!==t&&this.set(t),this},t.Color.prototype={constructor:t.Color,r:1,g:1,b:1,set:function(t){switch(typeof t){case"number":this.Vb(t);break;case"string":this.setStyle(t);break;case"object":this.copy(t)}return this},Vb:function(t){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,this},eMi:function(t,i,n){return this.r=t,this.g=i,this.b=n,this},NZn:function(t,i,n){return this.setHSL(t,i*n/((t=(2-i)*n)<1?t:2-t),t/2)},setHSL:function(t,i,n){if(0===i)this.r=this.g=this.b=n;else{var s=function(t,i,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+6*(i-t)*n:n<.5?i:n<2/3?t+6*(i-t)*(2/3-n):t},h=n<=.5?n*(1+i):n+i-n*i,r=2*n-h;this.r=s(r,h,t+1/3),this.g=s(r,h,t),this.b=s(r,h,t-1/3)}return this},setStyle:function(i){if(/^rgb\((\d+),(\d+),(\d+)\)$/i.test(i)){var n=/^rgb\((\d+),(\d+),(\d+)\)$/i.exec(i);return this.r=Math.min(255,parseInt(n[1],10))/255,this.g=Math.min(255,parseInt(n[2],10))/255,this.b=Math.min(255,parseInt(n[3],10))/255,this}if(/^rgb\((\d+)\%,(\d+)\%,(\d+)\%\)$/i.test(i)){n=/^rgb\((\d+)\%,(\d+)\%,(\d+)\%\)$/i.exec(i);return this.r=Math.min(100,parseInt(n[1],10))/100,this.g=Math.min(100,parseInt(n[2],10))/100,this.b=Math.min(100,parseInt(n[3],10))/100,this}if(/^\#([0-9a-f]{6})$/i.test(i)){n=/^\#([0-9a-f]{6})$/i.exec(i);return this.Vb(parseInt(n[1],16)),this}if(/^\#([0-9a-f])([0-9a-f])([0-9a-f])$/i.test(i)){n=/^\#([0-9a-f])([0-9a-f])([0-9a-f])$/i.exec(i);return this.Vb(parseInt(n[1]+n[1]+n[2]+n[2]+n[3]+n[3],16)),this}if(/^(\w+)$/i.test(i))return this.Vb(t.TZn[i]),this},copy:function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this},copyToLinear:function(t,i){return i?(this.r=t.r*t.r,this.g=t.g*t.g,this.b=t.b*t.b):(this.r=t.r<.04045?t.r/12.92:Math.pow((t.r+.055)/1.055,2.4),this.g=t.g<.04045?t.g/12.92:Math.pow((t.g+.055)/1.055,2.4),this.b=t.b<.04045?t.b/12.92:Math.pow((t.b+.055)/1.055,2.4)),this},_Zn:function(t){return this.r=t.r*t.r,this.g=t.g*t.g,this.b=t.b*t.b,this},RZn:function(t){return this.r=Math.sqrt(t.r),this.g=Math.sqrt(t.g),this.b=Math.sqrt(t.b),this},kZn:function(){var t=this.r,i=this.g,n=this.b;return this.r=t*t,this.g=i*i,this.b=n*n,this},LZn:function(){return this.r=Math.sqrt(this.r),this.g=Math.sqrt(this.g),this.b=Math.sqrt(this.b),this},zEi:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},AQi:function(){return("000000"+this.zEi().toString(16)).slice(-6)},getHSL:(m={h:0,s:0,l:0},function(){var t,i,n=this.r,s=this.g,h=this.b,r=Math.max(n,s,h),e=Math.min(n,s,h),a=(e+r)/2;if(e===r)t=0,i=0;else{var o=r-e;switch(i=a<=.5?o/(r+e):o/(2-r-e),r){case n:t=(s-h)/o+(s<h?6:0);break;case s:t=(h-n)/o+2;break;case h:t=(n-s)/o+4}t/=6}return m.h=t,m.s=i,m.l=a,m}),getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},PZn:function(t,i,n){var s=this.getHSL();return s.h+=t,s.s+=i,s.l+=n,this.setHSL(s.h,s.s,s.l),this},add:function(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this},zZn:function(t,i){return this.r=t.r+i.r,this.g=t.g+i.g,this.b=t.b+i.b,this},addScalar:function(t){return this.r+=t,this.g+=t,this.b+=t,this},multiply:function(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this},multiplyScalar:function(t){return this.r*=t,this.g*=t,this.b*=t,this},desaturate:function(t){var i=.587*this.g+.299*this.r+.114*this.b,n=Math.min(Math.max(1-t,1e-5),1);return this.r=this.r*n+t*i,this.g=this.g*n+t*i,this.b=this.b*n+t*i,this},saturate:function(t){var i=.587*this.g+.299*this.r+.114*this.b,n=1/Math.min(Math.max(1-t,1e-5),1);return this.r=(this.r-t*i)*n,this.g=(this.g-t*i)*n,this.b=(this.b-t*i)*n,this},alphaBlend:function(t,i){var n=1-(i=Math.min(Math.max(i,0),.99999));return this.r=t.r*i+this.r*n,this.g=t.g*i+this.g*n,this.b=t.b*i+this.b*n,this},negative:function(){return this.r=1-this.r,this.g=1-this.g,this.b=1-this.b,this},lerp:function(t,i){return this.r+=(t.r-this.r)*i,this.g+=(t.g-this.g)*i,this.b+=(t.b-this.b)*i,this},equals:function(t){return t.r===this.r&&t.g===this.g&&t.b===this.b},clone:function(){return(new t.Color).eMi(this.r,this.g,this.b)},toArray:function(){return[this.r,this.g,this.b]}},t.TZn={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},t})),define("Mesh/ThreeJS_Base",["DS/Mesh/ThreeJS_Base","DS/DSMigration/DSMigration"],(function(t,i){return i.mH("Mesh/ThreeJS_Base"),t}));