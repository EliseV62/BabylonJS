var multiTabDecorations=function(){var t=null,i=[],r=0,n=0;this.Brs=function(e){t||(t=new Uint8Array(2048),i=[t]);var s=r;if(n+e.length>2048){var o=2048-n,u=n+e.length-2048;this.ttr(e,0,o),n=0,t=new Uint8Array(2048),i.push(t),this.ttr(e,o,u)}else this.ttr(e,0,e.length);return r+=e.length,s+1},this.ttr=function(i,r,e){for(var s=0;s<e;s++)t[n++]=i[r+s]},this.Mes=function(){if(0==r)return null;for(var t=new Uint8Array(r),n=0,e=0;e<i.length;e++)for(var s=0;s<2048;s++)t[n++]=i[e][s];return t}};define("DS/Mesh/Mesh",["DS/Mesh/ThreeJS_Base"],(function(t){"use strict";var i=-2,r=r||{REVISION:"1"},n=new Set,e=null!=new RegExp("Trident/.*rv:([0-9]{1,}[.0-9]{0,})").exec(navigator.userAgent),s=new RegExp("Edge","i").test(navigator.userAgent);r.VertexComponentEnum={POSITION:0,NORMAL:1,DIFFUSE_COLOR:2,TEX_COORD_0:3,TEX_COORD_1:4,TEX_COORD_2:5,TEX_COORD_3:6,itr:7,rtr:8,ntr:9,etr:10,otr:11},r.DataTypeEnum={Xns:0,Jns:1,UINT:2,Yns:3,SHORT:4,INT:5,FLOAT:6,Wns:7},r.GeomTypeString={},function(){var i,n,e=["EDGE","WIRE_EDGE","BOUNDARY_EDGE","SHARP_EDGE","SMOOTH_EDGE","HIDDEN_SEAM_EDGE","BOUNDARY_POINT","SHARP_POINT","SMOOTH_POINT","HIDDEN_SEAM_POINT","SURFACIC_POINT","FREE_POINT","INFINITE_FACE","FACE","UNKNOWN","AXIS_SYSTEM"];for(i=0;i<e.length;i++)n=e[i],r.GeomTypeString[t.GeomTypeEnum[n]]=n}(),r.utr=function(t){switch(t){case r.DataTypeEnum.FLOAT:case r.DataTypeEnum.INT:case r.DataTypeEnum.UINT:return 4;case r.DataTypeEnum.Yns:case r.DataTypeEnum.Xns:return 1;case r.DataTypeEnum.SHORT:case r.DataTypeEnum.Jns:return 2;case r.DataTypeEnum.Wns:return 8;default:return 0}},r.ConnectivityTypeEnum={TRIANGLES:0,TRIANGLE_FAN:1,TRIANGLE_STRIP:2,LINES:3,LINE_STRIP:4,LINE_LOOP:5,POINTS:6},r.$1e={CROSS:0,PLUS:1,CONCENTRIC:2,COINCIDENT:3,FULLCIRCLE:4,FULLSQUARE:5,STAR:6,DOT:7,SMALLDOT:8},r.LinePatternEnum={UNKNOWN:0,SOLID:1,DOTTED:2,DASHED:3,DOTDASHED:4,PHANTOM:5,SMALLDOTTED:6,JISAXIS:7},r.NOPICKABLE=0,r.PICKABLE=1,r.NODRAWHL=2,r.INVISIBLE=2,r.htr=0,r.atr=1,r.ftr=2,r.ltr=3,r.Color=function(t,i,r,n){this.r=t||0,this.g=i||0,this.b=r||0,this.a=null==n?1:n},r.Color.prototype={constructor:r.Color,ctr:function(t,i,r,n){this.r=t,this.g=i,this.b=r,this.a=n},copy:function(t){this.r=t.r,this.g=t.g,this.b=t.b,this.a=t.a},isEqual:function(t){return this.r===t.r&&this.g===t.g&&this.b===t.b&&this.a===t.a},clone:function(){return new r.Color(this.r,this.g,this.b,this.a)}},r.FillAttributes=function(t,i,n){this.color=t||new r.Color,this.solid=i||this.solid||0,this.basic=n||this.basic||!1},r.FillAttributes.prototype={constructor:r.FillAttributes,isEqual:function(t){return null!==t&&this.color.isEqual(t.color)&&this.solid===t.solid&&this.basic===t.basic},clone:function(){return new r.FillAttributes(this.color.clone(),this.solid)}},r.LineAttributes=function(t,i,n){this.color=t||new r.Color,this.thickness=Math.round(i)>1?Math.round(i):1,this.pattern=n||r.LinePatternEnum.SOLID,this.forceMaterial=!1},r.LineAttributes.prototype={constructor:r.LineAttributes,isEqual:function(t){return null!==t&&this.color.isEqual(t.color)&&this.thickness===t.thickness&&this.pattern===t.pattern&&this.forceMaterial===t.forceMaterial&&(this.forceLineWidth===t.forceLineWidth||1==this.thickness)},clone:function(){return new r.LineAttributes(this.color.clone(),this.thickness,this.pattern)}},r.PointAttributes=function(t,i,n){this.color=t||new r.Color,this.size=i||1,this.symbol=n||r.$1e.CROSS,this.forceMaterial=!1},r.PointAttributes.prototype={constructor:r.PointAttributes,isEqual:function(t){return null!==t&&this.color.isEqual(t.color)&&this.size===t.size&&this.forceMaterial===t.forceMaterial&&this.symbol===t.symbol},clone:function(){return new r.PointAttributes(this.color.clone(),this.size,this.symbol)}};var o=new r.FillAttributes,u=new r.LineAttributes,h=new r.PointAttributes;r.PrimitiveGroup=function(t){this.identifier=0,this.nbPrimitives=0,this.primitives=[],this.vtr=0,this.buffers=[],this.material=null,this.fillAttr=o,this.lineAttr=u,this.pointAttr=h,this.noz=!1,this.editable=!1,t&&(void 0!==t.fillGAS&&(this.fillAttr=t.fillGAS),void 0!==t.lineGAS&&(this.lineAttr=t.lineGAS),void 0!==t.pointGAS&&(this.pointAttr=t.pointGAS),void 0!==t.identifier&&(this.identifier=t.identifier),void 0!==t.editable&&(this.editable=t.editable),void 0!==t.noz&&(this.noz=t.noz))},r.PrimitiveGroup.prototype={constructor:r.PrimitiveGroup,Shi:function(t){return this.primitives.push(t),this.nbPrimitives++,this},dhi:function(t,i){return this.buffers[t]=i,this.vtr++,this},G0e:function(t){this.buffers[t]=null,this.vtr--},N0i:function(t){var i;for(i in this.buffers){var r=this.buffers[i];if(r.component===t)return r}return null},Kns:function(t){var i=this.buffers[t];return void 0!==i?i:null}},r.Buffer=function(t){this.indexBuffer=!1,this.size=0,this.component=r.VertexComponentEnum.POSITION,this.format=r.DataTypeEnum.FLOAT,this.dimension=3,this.data=null,t&&(t.indexBuffer&&(this.indexBuffer=!0),void 0!==t.component&&(this.component=t.component),void 0!==t.format&&(this.format=t.format),t.dimension&&(this.dimension=t.dimension),t.data&&(this.data=t.data))},r.Primitive=function(t){this.identifier=0,this.nbIndices=0,this.connectivity=r.ConnectivityTypeEnum.TRIANGLES,this.wtr=0,this.geomType=null,this.vertexComponents=[],this.ghi=null,this.material=null,t&&(void 0!==t.nbIndices&&(this.nbIndices=t.nbIndices),void 0!==t.connectivity&&(this.connectivity=t.connectivity),void 0!==t.geomType&&(this.geomType=t.geomType),void 0!==t.identifier&&(this.identifier=t.identifier),(t.fillGAS||t.lineGAS||t.pointGAS)&&(this.ghi||(this.ghi={fill:o,line:u,point:h}),t.fillGAS&&(this.ghi.fill=t.fillGAS),t.lineGAS&&(this.ghi.line=t.lineGAS),t.pointGAS&&(this.ghi.point=t.pointGAS)))},r.Primitive.prototype={constructor:r.Primitive,addVertexComponent:function(t){return this.vertexComponents.push(t),this.wtr++,this},Qns:function(){for(var t=0;t<this.vertexComponents.length;t++)if(2==this.vertexComponents[t].component)return this.vertexComponents[t];return!1}},r.VertexComponent=function(t){this.component=r.VertexComponentEnum.POSITION,this.mhi=0,this.nbValuesPerVertex=0,this.format=r.DataTypeEnum.FLOAT,this.cardinality=0,this.bufferId="",this.offset=0,this.indices=null,t&&(void 0!==t.mhi&&(this.mhi=t.mhi),void 0!==t.cardinality&&(this.cardinality=t.cardinality),void 0!==t.bufferId&&(this.bufferId=t.bufferId),void 0!==t.indices&&(this.indices=t.indices),void 0!==t.offset&&(this.offset=t.offset))},r.IndexArray=function(t){this.format=r.DataTypeEnum.UINT,this.bufferId="",this.offset=0,t&&(void 0!==t.bufferId&&(this.bufferId=t.bufferId),void 0!==t.offset&&(this.offset=t.offset))},r.Material=function(){this.type="material",this.identifier=0,this.colorAmbient=[],this.colorDiffuse=[],this.colorSpecular=[],this.shininess=0,this.ambientCoef=0,this.diffuseCoef=0,this.specularCoef=0,this.transparent=0,this.reflectivityCoef=0,this.textureId=-1,this.textureImageNumberComposante=0,this.DAi=t.TextureBlendOperations.BLEND,this.magFilter=0,this.minFilter=0,this.mappingFunction=0,this.textureWrapS=0,this.textureWrapT=0,this.addedComposantInTexEnv=0,this.shaderMaterial=null},r.Material.prototype={constructor:r.Material,clone:function(){return new r.Material}},r.dtr=function(t){this.type=0,this.e1t=null,t?(this.cgmId=void 0!==t.cgmId?t.cgmId:-1,void 0!==t.parent?this.QC=[t.parent]:void 0!==t.QC?this.QC=t.QC.slice():this.QC=[],this.solid=void 0!==t.solid&&t.solid):(this.cgmId=-1,this.QC=[],this.solid=!1)},r.dtr.prototype={constructor:r.dtr,ZL:function(){return this.e1t},YU:function(t){this.e1t=t},V5t:function(){return this.e1t},v9e:function(t){this.e1t=t}},Object.defineProperty(r.dtr.prototype,"parent",{get:function(){return this.QC.length?this.QC[0]:null},set:function(t){this.QC[0]=t}}),r.SGBag=function(t){r.dtr.call(this,t),t=t||{},this.type=1,this.matrix=void 0!==t.matrix?t.matrix:null,this.children=void 0!==t.children?t.children:[],this.namingContext=void 0!==t.namingContext?t.namingContext:0,this.uuid_1=void 0!==t.uuid_1?t.uuid_1:null,this.uuid_2=void 0!==t.uuid_2?t.uuid_2:null,this.uuid_3=void 0!==t.uuid_3?t.uuid_3:null,this.uuid_4=void 0!==t.uuid_4?t.uuid_4:null,this.noShow=void 0!==t.noShow&&t.noShow},r.SGBag.prototype=Object.create(r.dtr.prototype),r.SGBag.prototype.constructor=r.SGBag,r.SGBag.prototype.gns=function(){var t=new Array;for(var i in this.children)t[i]="object"==typeof this.children[i]?this.children[i].clone():this.children[i];return t},r.SGBag.prototype.clone=function(){return new r.SGBag({cgmId:this.cgmId,type:this.type,children:this.gns(),matrix:null!==this.matrix?this.matrix.clone():null,QC:this.QC,solid:this.solid,uuid_1:this.uuid_1,uuid_2:this.uuid_2,uuid_3:this.uuid_3,uuid_4:this.uuid_4,noShow:this.noShow})},r.SGBag.prototype.copyNoChildren=function(t){this.cgmId=t.cgmId,this.matrix=t.matrix,this.QC=t.QC.slice(),this.solid=t.solid,this.namingContext=t.namingContext,this.noShow=t.noShow,t.uuid_1&&(this.uuid_1=t.uuid_1,this.uuid_2=t.uuid_2,this.uuid_3=t.uuid_3,this.uuid_4=t.uuid_4)},r.SGBag.prototype.computeBoundingSphere=function(i){var r,n=new t.Sphere;for((i=i||new t.Sphere).reset(),r=0;r<this.children.length;r++)this.children[r].computeBoundingSphere(n),n._k(i,i);return i},r.SGBag.prototype.KQe=function(i,r,n,e,s){for(var o,u=new t.Box3,h=0;h<this.children.length;h++){(o=this.children[h].KQe(i,r,n,e,s))&&(u=u.union(o))}return u},r.UUID=function(){this.uuid_1=0,this.uuid_2=0,this.uuid_3=0,this.uuid_4=0},r.UUID.prototype={constructor:r.UUID,setFromUint32:function(t,i,r,n){this.uuid_1=t,this.uuid_2=i,this.uuid_3=r,this.uuid_4=n},toString:function(){return this.uuid_1.toString(16)+"_"+this.uuid_2.toString(16)+"_"+this.uuid_3.toString(16)+"_"+this.uuid_4.toString(16)},isEqual:function(t){return this.uuid_1===t.uuid_1&&this.uuid_2===t.uuid_2&&this.uuid_3===t.uuid_3&&this.uuid_4===t.uuid_4},clone:function(){var t=new r.UUID;return t.uuid_1=this.uuid_1,t.uuid_2=this.uuid_2,t.uuid_3=this.uuid_3,t.uuid_4=this.uuid_4,t}},r.SGRep=function(t){r.dtr.call(this,t),this.type=2,t?(this.matrix=void 0!==t.matrix?t.matrix:null,this.tEi=void 0!==t.primitives?t.primitives:[],this.boundingSphere=void 0!==t.boundingSphere?t.boundingSphere:null,this.sag=void 0!==t.sag?t.sag:null,this.namingContext=void 0!==t.namingContext?t.namingContext:0):(this.matrix=null,this.tEi=[],this.boundingSphere=null,this.sag=null,this.namingContext=0),this._binary=!1},r.SGRep.prototype=Object.create(r.dtr.prototype),Object.assign(r.SGRep.prototype,{constructor:r.SGRep,gtr:function(){for(var t=[],i=0;i<this.tEi.length;i++){var r=this.tEi[i];r.clone?t.push(r.clone()):t.push(r)}return t},clone:function(){var t=new r.SGRep({cgmId:this.cgmId,type:this.type,primitives:this.gtr(),matrix:this.matrix?this.matrix.clone():null,parent:this.parent,solid:this.solid,sag:this.sag,boundingSphere:this.boundingSphere?{radius:this.boundingSphere.radius,center:[this.boundingSphere.center[0],this.boundingSphere.center[1],this.boundingSphere.center[2]]}:null});return t._binary=this._binary,t},mtr:function(t){var i={ind:-1,Atr:-1};if(!this._binary)return i.ind=t,i;for(var r=0,n=0;n<this.tEi.length;n++){var e=this.tEi[n];if(t<r+e.count){i.ind=n,i.Atr=t-r+e.start;break}r+=e.count}return i},getPrimitiveCgmId:function(t){var i=this.mtr(t),r=this.tEi[i.ind];return-1!==i.Atr?r.binary.getPrimitiveCgmId(i.Atr):r.cgmId},Itr:function(t,i){var r=this.mtr(i),n=this.tEi[r.ind];-1===r.Atr?n.cgmId=t:n.binary.Itr(t,r.Atr)},getPrimitiveType:function(t){var i=this.mtr(t),r=this.tEi[i.ind];return-1!==i.Atr?r.binary.getPrimitiveType(i.Atr):r.type},ytr:function(t){var i=this.mtr(t),r=this.tEi[i.ind];return-1!==i.Atr?r.binary.ytr(i.Atr):r.clone()},Otr:function(t){var i=this.mtr(t),r=this.tEi[i.ind];return-1!==i.Atr?r.binary.Otr(i.Atr):r.internalNode},Etr:function(t,i){var r=this.mtr(i),n=this.tEi[r.ind];-1===r.Atr?n.internalNode=t:n.binary.Etr(t,r.Atr)},getPrimitiveRep:function(t){var i=this.mtr(t),r=this.tEi[i.ind];return-1!==i.Atr?r.binary.getPrimitiveRep(i.Atr):r.rep},_setPrimitiveStart:function(t,i){var r=this.mtr(i),n=this.tEi[r.ind];-1===r.Atr?n.start=t:n.binary._setPrimitiveStart(t,r.Atr)},_setPrimitiveCount:function(t,i){var r=this.mtr(i),n=this.tEi[r.ind];-1===r.Atr?n.count=t:n.binary._setPrimitiveCount(t,r.Atr)},getPrimitiveStart:function(t){var i=this.mtr(t),r=this.tEi[i.ind];return-1!==i.Atr?r.binary.getPrimitiveStart(i.Atr):r.start},getPrimitiveCount:function(t){var i=this.mtr(t),r=this.tEi[i.ind];return-1!==i.Atr?r.binary.getPrimitiveCount(i.Atr):r.count},getPrimitiveGroup:function(t){var i=this.mtr(t),r=this.tEi[i.ind];return-1!==i.Atr?r.binary.getPrimitiveGroup(i.Atr):r.group},getPrimitiveDecoration:function(t){var i=this.mtr(t),r=this.tEi[i.ind];return-1!==i.Atr?r.binary.getPrimitiveDecoration(i.Atr):r.decoration},Mtr:function(t){var i=this.mtr(t),r=this.tEi[i.ind];return-1!==i.Atr?r.binary.Mtr(i.Atr):r.boundingSphere},Ptr:function(t,i){var r=this.mtr(t),n=this.tEi[r.ind];-1===r.Atr?n.boundingSphere=i:n.binary.Ptr(r.Atr,i)},getPrimitivesCount:function(){if(!this._binary)return this.tEi.length;for(var t=0,i=0;i<this.tEi.length;i++){t+=this.tEi[i].count}return t},_tr:function(t){var i=this.mtr(t),r=this.tEi[i.ind];return-1!==i.Atr?r.binary._tr(i.Atr):r.btr},Str:function(t,i){var r=this.mtr(i),n=this.tEi[r.ind];-1!==r.Atr&&n.binary.Str(t,r.Atr),n.btr=t},Ntr:function(t){var i=this.mtr(t),r=this.tEi[i.ind];return-1!==i.Atr?r.binary.Ntr(i.Atr):r.computeBoundingSphere()},qQe:function(){return!0},JQe:function(){return!0},computeBoundingSphere:function(i){if(!this.boundingSphere){this.boundingSphere=new t.Sphere;var r,n,e,s=new t.Sphere;for(r=0;r<this.tEi.length;r++)if(this._binary)for(e=(n=this.tEi[r]).start;e<n.start+n.count;e++)n.binary.Ntr(e,s),s._k(this.boundingSphere,this.boundingSphere);else this.tEi[r].computeBoundingSphere(s),s._k(this.boundingSphere,this.boundingSphere)}return i?(i.copy(this.boundingSphere),i):this.boundingSphere},KQe:function(i,r,n,e,s){var o,u,h,a,f=new t.Box3;for(o=0;o<this.tEi.length;o++)if(a=this.tEi[o],this._binary)for(u=a.start;u<a.start+a.count;u++)null!==(h=a.binary.Ftr(u,i,r,n,e,s))&&(f=f.union(h));else null!==(h=a.KQe(i,r,n,e,s))&&(f=f.union(h));return f},Ftr:function(t,i,r,n,e,s){var o=this.mtr(t),u=this.tEi[o.ind];return-1!==o.Atr?u.binary.Ftr(o.Atr,i,r,n,e,s):u.KQe(i,r,n,e,s)}});var a=0;Object.defineProperty(r.SGRep.prototype,"primitives",{get:function(){if(a<10){var t=new Error,i="#PrimApi - SGRep.GetPrimitives - "+(t.stack?t.stack.split("\n")[1]+" - "+t.stack.split("\n")[2]:"");n.has(i.hashCode())||(n.add(i.hashCode()),a++)}return this.tEi},set:function(){throw"NO"}}),r.BinarySGPrimitiveArray=function(t,i,r,n,e){this.data=t,this.size=e,this.sgRep=r,this.dg=i,this.Ttr=n||null,this.btr=[],this.Ctr=[]},r.BinarySGPrimitiveArray.prototype.constructor=r.BinarySGPrimitiveArray,r.BinarySGPrimitiveArray.prototype.clone=function(){return new r.BinarySGPrimitiveArray(this.data.slice(),this.dg,this.sgRep,this.Ttr?this.Ttr.slice():null,this.size)},r.BinarySGPrimitiveArray.prototype.INi=function(){var t=this.btr;this.btr=new Array(t.length);for(var i=0;i<t.length;i++)this.btr[i]=t[i];var r=this.Ctr;this.Ctr=new Array(r.length);for(i=0;i<r.length;i++)this.Ctr[i]=r[i]},r.BinarySGPrimitiveArray.prototype.ytr=function(t){var i=this.size*t,n=this.data,e=n[i]-1,s=this.getPrimitiveRep(t),o=n[i+2],u=n[i+3],h=n[i+4],a=this.Mtr(t),f=new r.SGPrimitive;return f.decoration=h,f.group=this.dg,f.rep=s,f.count=u,f.start=o,f.cgmId=e,f.boundingSphere=a,f},r.BinarySGPrimitiveArray.prototype.getPrimitiveCgmId=function(t){var i=this.size*t;return this.data[i]-1},r.BinarySGPrimitiveArray.prototype.Itr=function(t,i){if("number"!=typeof t)throw"Cgmid must be a number";var r=this.size*i;this.data[r]=t+1},r.BinarySGPrimitiveArray.prototype.getPrimitiveType=function(t){return 3},r.BinarySGPrimitiveArray.prototype.Otr=function(t){return this.Ctr[t]},r.BinarySGPrimitiveArray.prototype.Etr=function(t,i){0===this.Ctr.length&&(this.Ctr=new Array(this.getPrimitivesCount())),this.Ctr[i]=t},r.BinarySGPrimitiveArray.prototype.getPrimitiveRep=function(t){var i=this.data[this.size*t+1];return this.sgRep[i]},r.BinarySGPrimitiveArray.prototype.getPrimitiveStart=function(t){var i=this.size*t;return this.data[i+2]},r.BinarySGPrimitiveArray.prototype.getPrimitiveGroup=function(t){return this.dg},r.BinarySGPrimitiveArray.prototype._setPrimitiveStart=function(t,i){var r=this.size*i;this.data[r+2]=t},r.BinarySGPrimitiveArray.prototype.getPrimitiveCount=function(t){var i=this.size*t;return this.data[i+3]},r.BinarySGPrimitiveArray.prototype._setPrimitiveCount=function(t,i){var r=this.size*i;this.data[r+3]=t},r.BinarySGPrimitiveArray.prototype.getPrimitiveDecoration=function(t){var i=this.size*t;return this.data[i+4]},r.BinarySGPrimitiveArray.prototype.Mtr=function(i){if(null!==this.Ttr){var r=new t.Sphere;return r.Uwi(this.Ttr[4*i],this.Ttr[4*i+1],this.Ttr[4*i+2],this.Ttr[4*i+3]),r.radius>=0?r:null}return null},r.BinarySGPrimitiveArray.prototype.Ftr=function(t,i,r,n,e,s){return this.dg.KQe(i,r,n,e,s,this.getPrimitiveStart(t),this.getPrimitiveCount(t))},r.BinarySGPrimitiveArray.prototype.Ptr=function(t,i){null===this.Ttr&&(this.Ttr=new Float32Array(4*this.getPrimitivesCount()),this.Ttr.fill(-1)),null===i?(this.Ttr[4*t]=-1,this.Ttr[4*t+1]=-1,this.Ttr[4*t+2]=-1,this.Ttr[4*t+3]=-1):(this.Ttr[4*t]=i.center.x,this.Ttr[4*t+1]=i.center.y,this.Ttr[4*t+2]=i.center.z,this.Ttr[4*t+3]=i.radius)},r.BinarySGPrimitiveArray.prototype.getPrimitivesCount=function(){return this.data.length/this.size},r.BinarySGPrimitiveArray.prototype._tr=function(t){return this.btr[t]},r.BinarySGPrimitiveArray.prototype.Str=function(t,i){0===this.btr.length&&(this.btr=new Array(this.getPrimitivesCount())),this.btr[i]=t},r.BinarySGPrimitiveArray.prototype.Ntr=function(i,r){var n=this.getPrimitiveStart(i),e=this.getPrimitiveCount(i);if(0!=e){var s=this.dg.geometry,o=0,u=(i=s.vertexIndexArray[n],new t.Vector3);s.Awi(i,u);for(var h=u.x,a=u.y,f=u.z,l=h,c=a,v=f,w=1;w<e;++w){i=s.vertexIndexArray[n+w],s.Awi(i,u),(A=u.x)<h?h=A:A>l&&(l=A),(I=u.y)<a?a=I:I>c&&(c=I),(p=u.z)<f?f=p:p>v&&(v=p)}var d=(h+l)/2,g=(a+c)/2,m=(f+v)/2;for(o=0,w=0;w<e;++w){i=s.vertexIndexArray[n+w],s.Awi(i,u);var p,A=u.x,I=u.y,y=((p=u.z)-m)*(p-m)+(I-g)*(I-g)+(A-d)*(A-d);y>o&&(o=y)}return o=Math.sqrt(o),(r=r||new t.Sphere).Uwi(d,g,m,o),r}},r.SGPrimitive=function(t){this.type=3,this.btr=null,this.internalNode=null,t?(this.cgmId=void 0!==t.cgmId?t.cgmId:-1,this.rep=void 0!==t.rep?t.rep:null,this.group=void 0!==t.group?t.group:null,this.start=void 0!==t.start?t.start:0,this.count=void 0!==t.count?t.count:0,this.boundingSphere=void 0!==t.boundingSphere?t.boundingSphere:void 0,this.decoration=void 0!==t.decoration?t.decoration:0):(this.cgmId=-1,this.rep=null,this.group=null,this.start=0,this.count=0,this.boundingSphere=void 0,this.decoration=0)},r.SGPrimitive.prototype={constructor:r.SGPrimitive,V5t:function(){return this.btr},v9e:function(t){this.btr=t},isEqual:function(t){return this.getGroup()===t.getGroup()&&this.getRep()===t.getRep()&&this.getStart()===t.getStart()&&this.getCount()===t.getCount()&&this.getCgmId()===t.getCgmId()},computeBoundingSphere:function(i){i=i||new t.Sphere;var r=this.start,n=this.count;if(0!=n){var e=this.group.geometry,s=e.vertexIndexArray,o=0,u=s[r],h=new t.Vector3;e.Awi(u,h);for(var a=h.x,f=h.y,l=h.z,c=a,v=f,w=l,d=1;d<n;++d){u=s[r+d],e.Awi(u,h),(I=h.x)<a?a=I:I>c&&(c=I),(y=h.y)<f?f=y:y>v&&(v=y),(A=h.z)<l?l=A:A>w&&(w=A)}var g=(a+c)/2,m=(f+v)/2,p=(l+w)/2;for(o=0,d=0;d<n;++d){u=s[r+d],e.Awi(u,h);var A,I=h.x,y=h.y,O=((A=h.z)-p)*(A-p)+(y-m)*(y-m)+(I-g)*(I-g);O>o&&(o=O)}return o=Math.sqrt(o),i.Uwi(g,m,p,o),i}},KQe:function(t,i,r,n,e){return this.group.KQe(t,i,r,n,e,this.start,this.count)},getCgmId:function(){return this.cgmId},Dtr:function(t){this.cgmId=t},getType:function(){return this.type},_getInternalNode:function(){return this.internalNode},_setInternalNode:function(t){this.internalNode=t},getRep:function(){return this.rep},getStart:function(){return this.start},getCount:function(){return this.count},getGroup:function(){return this.group},Rtr:function(){return this.decoration},getBoundingSphere:function(){return this.boundingSphere},qQe:function(){return this.group.qQe()},JQe:function(){return this.group.JQe()},Btr:function(t){this.cgmId=t.cgmId,this.rep=t.rep,this.group=t.group,this.start=t.start,this.count=t.count,this.boundingSphere=t.boundingSphere?{radius:t.boundingSphere.radius,center:[t.boundingSphere.center[0],t.boundingSphere.center[1],t.boundingSphere.center[2]]}:void 0,this.decoration=t.decoration},clone:function(){var t=new r.SGPrimitive;return t.Btr(this),t}},r.SGPrimitiveHelper=function(){this.container=null,this.index=-1},r.SGPrimitiveHelper.prototype={constructor:r.SGPrimitiveHelper,clone:function(){var t=new r.SGPrimitiveHelper;return t.set(this.container,this.index),t},set:function(t,i){if(!t instanceof r.DrawingGroup||!t instanceof r.SGRep)throw"Error: container must be a Mesh.DrawingGroup or Mesh.SGRep";this.container=t,this.index=i},isEqual:function(t){return this.getGroup()===t.getGroup()&&this.getRep()===t.getRep()&&this.getStart()===t.getStart()&&this.getCount()===t.getCount()&&this.getCgmId()===t.getCgmId()},getCgmId:function(){return this.container.getPrimitiveCgmId(this.index)},Dtr:function(t){this.container.Itr(t,this.index)},getType:function(){return this.container.getPrimitiveType(this.index)},ytr:function(){return this.container.ytr(this.index)},_getInternalNode:function(){return this.container.Otr(this.index)},_setInternalNode:function(t){this.container.Etr(t,this.index)},getRep:function(){return this.container.getPrimitiveRep(this.index)},getStart:function(){return this.container.getPrimitiveStart(this.index)},getCount:function(){return this.container.getPrimitiveCount(this.index)},getGroup:function(){return this.container.getPrimitiveGroup(this.index)},Rtr:function(){return this.container.getPrimitiveDecoration(this.index)},getBoundingSphere:function(){return this.container.Mtr(this.index)},MV:function(t){this.container.Ptr(this.index,t)},V5t:function(){return this.container._tr(this.index)},v9e:function(t){this.container.Str(t,this.index)},computeBoundingSphere:function(t){return this.container.Ntr(this.index,t)},KQe:function(t,i,r,n,e){return this.container.Ftr(this.index,t,i,r,n,e)},qQe:function(){return this.container.qQe()},JQe:function(){return this.container.JQe()}};var f=0;Object.defineProperty(r.SGPrimitiveHelper.prototype,"start",{get:function(){if(f<25){var t=new Error,i="#PrimApi - helper.GetStart - "+(t.stack?t.stack.split("\n")[1]+" - "+t.stack.split("\n")[2]:"");n.has(i.hashCode())||n.add(i.hashCode()),f++}return this.getStart()},set:function(){throw"NO"}}),Object.defineProperty(r.SGPrimitiveHelper.prototype,"count",{get:function(){if(f<25){var t=new Error,i="#PrimApi - helper.GetCount - "+(t.stack?t.stack.split("\n")[1]+" - "+t.stack.split("\n")[2]:"");n.has(i.hashCode())||n.add(i.hashCode()),f++}return this.getCount()},set:function(){throw"NO"}}),Object.defineProperty(r.SGPrimitiveHelper.prototype,"cgmId",{get:function(){if(f<25){var t=new Error,i="#PrimApi - helper.GetCgmId - "+(t.stack?t.stack.split("\n")[1]+" - "+t.stack.split("\n")[2]:"");n.has(i.hashCode())||n.add(i.hashCode()),f++}return this.getCgmId()},set:function(t){if(f<25){var i=new Error,r="#PrimApi - helper.SetCgmId - "+(i.stack?i.stack.split("\n")[1]+" - "+i.stack.split("\n")[2]:"");n.has(r.hashCode())||n.add(r.hashCode()),f++}this.Dtr(t)}}),Object.defineProperty(r.SGPrimitiveHelper.prototype,"rep",{get:function(){if(f<25){var t=new Error,i="#PrimApi - helper.GetRep - "+(t.stack?t.stack.split("\n")[1]+" - "+t.stack.split("\n")[2]:"");n.has(i.hashCode())||n.add(i.hashCode()),f++}return this.getRep()},set:function(){throw"NO"}}),Object.defineProperty(r.SGPrimitiveHelper.prototype,"boundingSphere",{get:function(){if(f<25){var t=new Error,i="#PrimApi - helper.GetBS - "+(t.stack?t.stack.split("\n")[1]+" - "+t.stack.split("\n")[2]:"");n.has(i.hashCode())||n.add(i.hashCode()),f++}return this.getBoundingSphere()},set:function(){throw"NO"}}),Object.defineProperty(r.SGPrimitiveHelper.prototype,"type",{get:function(){if(f<25){var t=new Error,i="#PrimApi - helper.GetType - "+(t.stack?t.stack.split("\n")[1]+" - "+t.stack.split("\n")[2]:"");n.has(i.hashCode())||n.add(i.hashCode()),f++}return this.getType()},set:function(){throw"NO"}}),Object.defineProperty(r.SGPrimitiveHelper.prototype,"group",{get:function(){if(f<25){var t=new Error,i="#PrimApi - helper.GetGroup - "+(t.stack?t.stack.split("\n")[1]+" - "+t.stack.split("\n")[2]:"");n.has(i.hashCode())||n.add(i.hashCode()),f++}return this.getGroup()},set:function(){throw"NO"}}),Object.defineProperty(r.SGPrimitiveHelper.prototype,"decoration",{get:function(){if(f<25){var t=new Error,i="#PrimApi - helper.GetDeco - "+(t.stack?t.stack.split("\n")[1]+" - "+t.stack.split("\n")[2]:"");n.has(i.hashCode())||n.add(i.hashCode()),f++}return this.Rtr()},set:function(){throw"NO"}});var l={EDGE:1,WIRE_EDGE:2,BOUNDARY_EDGE:3,SHARP_EDGE:4,SMOOTH_EDGE:5,BOUNDARY_POINT:6,SHARP_POINT:7,SMOOTH_POINT:8,SURFACIC_POINT:9,FREE_POINT:10,INFINITE_FACE:11,FACE:12,UNKNOWN:13};r.getConvertedVec3=function(i,r){var n=[i[r],i[r+1],i[r+2]];return new t.Vector3(n[0],n[1],n[2])},r.Utr=function(t,i){return null==t&&null==i||!(null==t&&null!=i||null!=t&&null==i)&&(t.fill.isEqual(i.fill)&&t.line.isEqual(i.line)&&t.point.isEqual(i.point))},r.Pns=function(t,i){return null==t&&null==i||!(null==t&&null!=i||null!=t&&null==i)&&(t.id==i.id&&t.file==i.file)},r.Gtr=function(i,r){if(null==i)return null;var n=null,e=1,s=null;switch(r){case 0:e=null==i.point.color.a?1:i.point.color.a,s=new t.Color,i.point.color&&(s.eMi(i.point.color.r,i.point.color.g,i.point.color.b),n={color:s,opacity:e,symbol:i.point.symbol,ktr:i.point.size},i.point.forceMaterial&&(n.forceMaterial=!0));break;case 1:e=null==i.line.color.a?1:i.line.color.a,s=new t.Color,i.line.color&&(s.eMi(i.line.color.r,i.line.color.g,i.line.color.b),n={color:s,opacity:e,lineWidth:i.line.thickness,pattern:i.line.pattern},i.line.forceMaterial&&(n.forceMaterial=!0));break;case 2:e=null==i.fill.color.a?1:i.fill.color.a,s=new t.Color,i.fill.color&&(s.eMi(i.fill.color.r,i.fill.color.g,i.fill.color.b),n={color:s,opacity:e,solid:i.fill.solid,basic:i.fill.basic})}return n},r.areEqualGraphicProperties=function(t,i){return null!=t.color&&null!=i.color&&(t.color.r==i.color.r&&t.color.g==i.color.g&&t.color.b==i.color.b&&((!t.thickness||!i.thickness||t.thickness==i.thickness)&&((!t.ktr||!i.ktr||t.ktr==i.ktr)&&t.opacity==i.opacity)))},r.validatePrimitiveGroup=function(t){var i,n;for(i=0;i<t.buffers.length;i++){(o=t.buffers[i])&&(o.size=o.data.byteLength/r.utr(o.format),o.indexBuffer&&(o.format=r.DataTypeEnum.UINT,o.dimension=1))}for(i=0;i<t.primitives.length;i++){var e=t.primitives[i];for(e.ghi||(e.ghi={fill:t.fillAttr,line:t.lineAttr,point:t.pointAttr}),n=0;n<e.wtr;n++){var s=e.vertexComponents[n],o=t.Kns(s.bufferId);s.component=o.component,s.nbValuesPerVertex=o.dimension,s.format=o.format}}},r.checkMeshOptimizable=function(t){for(var i=null,n=[],e=0;e<t.buffers.length;e++){var s=t.buffers[e];if(s)if(s.indexBuffer){if(i)return!1;i=s}else{if(n[s.component])return!1;n[s.component]=s}}for(var o=0;o<t.primitives.length;o++){var u=t.primitives[o];if(u.connectivity===r.ConnectivityTypeEnum.TRIANGLE_STRIP||u.connectivity===r.ConnectivityTypeEnum.TRIANGLE_FAN||u.connectivity===r.ConnectivityTypeEnum.LINE_STRIP)return!1}return!0},r.createGeometryOptimized=function(i,n){var e=new r.Mesh;e.rep=n;for(var s=0;s<i.buffers.length;s++){var o=i.buffers[s],u=o.component,h=o.data;if(o.indexBuffer)e.vertexIndexArray=h;else switch(u){case r.VertexComponentEnum.POSITION:e.vertexPositionArray=h;break;case r.VertexComponentEnum.NORMAL:e.vertexNormalArray=h;break;case r.VertexComponentEnum.DIFFUSE_COLOR:e.vertexColorArray=h;break;case r.VertexComponentEnum.TEX_COORD_0:e.vertexUvArray=h;break;case r.VertexComponentEnum.TEX_COORD_1:e.vertexUv2Array=h;break;case r.VertexComponentEnum.TEX_COORD_2:e.vertexTangentArray=h;break;case r.VertexComponentEnum.TEX_COORD_3:e.vertexBinormalArray=h}}var a=[],f=[],c=i.nbPrimitives;for(s=0;s<c;s++){var v=i.primitives[s],w=!!v.vertexComponents[0].indices,d=0,g=a.length;if(w){for(d=0;d<g;d++){var m=a[d];if(m.connectivity==v.connectivity&&m.geomType==v.geomType&&r.Utr(m.gas,v.ghi)&&(null==m.material&&null==v.material||m.material.id==v.material.id&&m.material.file==v.material.file)){m.set.push(v),m.nbIndices+=v.nbIndices;break}}if(d===a.length){var p={connectivity:v.connectivity,geomType:v.geomType,gas:v.ghi,material:v.material,nbIndices:v.nbIndices,set:[v]};a.push(p)}}else f.push(v)}a.sort((function(t,i){if(t.connectivity<i.connectivity)return-1;if(t.connectivity>i.connectivity)return 1;if(t.geomType&&i.geomType){var r=l[t.geomType],n=l[i.geomType];if(r&&n)return r-n}return 0}));for(s=0;s<a.length;s++)a[s].set.sort((function(t,i){var r=t.vertexComponents[0].indices,n=i.vertexComponents[0].indices;return r&&n?r.offset-n.offset:0}));for(s=0;s<a.length;s++)for(var A=a[s],I=[],y=A.set[0].vertexComponents[0].indices.offset,O=A.set[0].vertexComponents[0].indices.offset,E=0,M=0;M<A.set.length;)for(d=M;d<A.set.length;d++){var P=A.set[d];if(!P.vertexComponents[0].indices||P.vertexComponents[0].indices.offset!==O||d===A.set.length-1){d===A.set.length-1?(I.push(P),E+=P.nbIndices,M=d+1):M=d;var _=4===(F=A.connectivity===r.ConnectivityTypeEnum.TRIANGLES?4:A.connectivity===r.ConnectivityTypeEnum.LINES?1:0)?2:F;(T=new r.DrawingGroup(r.Gtr(A.gas,_),A.material,F,y,E,void 0,void 0,t.GeomTypeEnum[A.geomType]))._geomType=A.geomType?t.GeomTypeEnum[A.geomType]:0,e.drawingGroups.push(T);for(var b=0;b<I.length;b++){var S=I[b],N=new r.SGPrimitive({cgmId:S.identifier,rep:e.rep,group:T,start:S.vertexComponents[0].indices.offset,count:S.nbIndices});T.tEi.push(N),e.rep.tEi.push(N)}y=P.vertexComponents[0].indices.offset,O=P.vertexComponents[0].indices.offset,E=0,I.length=0;break}I.push(P),O+=P.nbIndices,E+=P.nbIndices}for(s=0;s<f.length;s++){var F,T;_=4===(F=(S=f[s]).connectivity===r.ConnectivityTypeEnum.TRIANGLES?4:S.connectivity===r.ConnectivityTypeEnum.LINES?1:0)?2:F;(T=new r.DrawingGroup(r.Gtr(S.ghi,_),S.material,F,S.vertexComponents[0].offset,S.nbIndices,void 0,void 0,t.GeomTypeEnum[S.geomType]))._geomType=S.geomType?t.GeomTypeEnum[S.geomType]:0,T.nonIndexed=!0,e.drawingGroups.push(T);N=new r.SGPrimitive({cgmId:S.identifier,rep:e.rep,group:T,start:S.vertexComponents[0].offset,count:S.nbIndices});T.tEi.push(N),e.rep.tEi.push(N)}var C=new t.Color,D=new t.Color,R=new t.Color;i.fillAttr.color&&C.eMi(i.fillAttr.color.r,i.fillAttr.color.g,i.fillAttr.color.b),i.lineAttr.color&&D.eMi(i.lineAttr.color.r,i.lineAttr.color.g,i.lineAttr.color.b),e.gas.fill={color:C,opacity:null==i.fillAttr.color.a?1:i.fillAttr.color.a,solid:i.fillAttr.solid},e.gas.line={color:D,opacity:null==i.lineAttr.color.a?1:i.lineAttr.color.a,lineWidth:i.lineAttr.thickness,pattern:i.lineAttr.pattern||1},i.pointAttr&&(i.pointAttr.color&&R.eMi(i.pointAttr.color.r,i.pointAttr.color.g,i.pointAttr.color.b),e.gas.point={color:R,opacity:null==i.pointAttr.color.a?1:i.pointAttr.color.a,ktr:i.pointAttr.size});var B=[0,0,0],U=[0,0,0];if(e.vertexPositionArray){var G=e.vertexPositionArray.length;if(G>=3){B=[e.vertexPositionArray[0],e.vertexPositionArray[1],e.vertexPositionArray[2]],U=[e.vertexPositionArray[0],e.vertexPositionArray[1],e.vertexPositionArray[2]];for(var k=0;k<G;k+=3)e.vertexPositionArray[k]<B[0]&&(B[0]=e.vertexPositionArray[k]),e.vertexPositionArray[k+1]<B[1]&&(B[1]=e.vertexPositionArray[k+1]),e.vertexPositionArray[k+2]<B[2]&&(B[2]=e.vertexPositionArray[k+2]),e.vertexPositionArray[k]>U[0]&&(U[0]=e.vertexPositionArray[k]),e.vertexPositionArray[k+1]>U[1]&&(U[1]=e.vertexPositionArray[k+1]),e.vertexPositionArray[k+2]>U[2]&&(U[2]=e.vertexPositionArray[k+2])}}return e.AABB={min:B,max:U},e},r.convertToGeometry3js=function(i,n,e,s,o,u,h){var a=s,f=[],c=0,v=0,w=i.nbPrimitives,d=r.Utr;u&&(d=function(t,i){return t.set==i.set&&t.rgba==i.rgba});for(var g=0;g<w;g++){var m=i.primitives[g],p=0,A=f.length;for(p=0;p<A;p++){var I=f[p];if(I.connectivity==m.connectivity&&I.geomType==m.geomType&&d(I.gas,m.ghi)&&(null==I.material&&null==m.material||I.material.id==m.material.id&&I.material.file==m.material.file)){switch(c+=m.nbIndices,I.connectivity){case r.ConnectivityTypeEnum.TRIANGLE_STRIP:case r.ConnectivityTypeEnum.TRIANGLE_FAN:v+=2*(m.nbIndices-3),I.Ens+=2*(m.nbIndices-3);break;case r.ConnectivityTypeEnum.LINE_STRIP:v+=m.nbIndices-2,I.Ens+=m.nbIndices-2}I.set.push(m),I.nbIndices+=m.nbIndices;break}}if(p==f.length)switch((O={}).connectivity=m.connectivity,O.geomType=m.geomType,O.gas=m.ghi,O.material=m.material,O.nbIndices=m.nbIndices,O.Ens=0,O.set=[],O.set.push(m),f.push(O),c+=m.nbIndices,f[p].connectivity){case r.ConnectivityTypeEnum.TRIANGLE_STRIP:case r.ConnectivityTypeEnum.TRIANGLE_FAN:v+=2*(m.nbIndices-3),O.Ens=2*(m.nbIndices-3);break;case r.ConnectivityTypeEnum.LINE_STRIP:v+=m.nbIndices-2,O.Ens=m.nbIndices-2}}f.sort((function(t,i){if(t.connectivity<i.connectivity)return-1;if(t.connectivity>i.connectivity)return 1;if(t.geomType&&i.geomType){var r=l[t.geomType],n=l[i.geomType];if(r&&n)return r-n}return 0}));var y=[];for(p=0;p<f.length;p++){var O=f[p];for(g=0;g<O.set.length;g++)y.push(O.set[g])}var E=null;E=null==o||"multi"==o?void 0!==n?r.jtr(y,i.buffers,n,e):r.jtr(y,i.buffers):void 0!==n?r.xtr(y,i.buffers,n,e):r.xtr(y,i.buffers);var M=new r.Mesh;M.vertexPositionArray=E.VB[0],M.vertexNormalArray=E.VB[1],M.vertexColorArray=E.VB[2],M.vertexUvArray=E.VB[3],M.vertexUv2Array=E.VB[4],M.vertexTangentArray=E.VB[5],M.vertexBinormalArray=E.VB[6];for(var P=new Uint32Array(c+v),_=0,b=0,S=0;S<f.length;S++){var N,F=null==(O=f[S]).material?i.material:O.material;switch(O.connectivity){case r.ConnectivityTypeEnum.TRIANGLES:(B=O.gas)&&!B.set&&(B=r.Gtr(O.gas,2)),(N=new r.DrawingGroup(B,F,4,b,O.nbIndices,void 0,void 0,t.GeomTypeEnum[O.geomType],void 0,h))._geomType=O.geomType?t.GeomTypeEnum[O.geomType]:0,M.drawingGroups.push(N);for(g=0;g<O.set.length;g++){m=O.set[g];var T=new r.wns(m.identifier,N,b,m.nbIndices);m.cgmId&&(T.cgmId=m.cgmId),m.decoration&&(T.decoration=m.decoration),m.boundingSphere&&(T.boundingSphere=m.boundingSphere),N.tEi.push(T);for(p=0;p<m.nbIndices;p++)P[b++]=E.IB[_++]}break;case r.ConnectivityTypeEnum.TRIANGLE_FAN:(B=O.gas)&&!B.set&&(B=r.Gtr(O.gas,2)),(N=new r.DrawingGroup(B,F,4,b,O.nbIndices+O.Ens,void 0,void 0,t.GeomTypeEnum[O.geomType],void 0,h))._geomType=O.geomType?t.GeomTypeEnum[O.geomType]:0,M.drawingGroups.push(N);for(g=0;g<O.set.length;g++){m=O.set[g];var C=b,D=_;for(p=0;p<m.nbIndices-2;p++)P[b++]=E.IB[D],P[b++]=E.IB[_+1],P[b++]=E.IB[_+2],_++;_+=2;T=new r.wns(m.identifier,N,C,b-C);m.cgmId&&(T.cgmId=m.cgmId),m.decoration&&(T.decoration=m.decoration),m.boundingSphere&&(T.boundingSphere=m.boundingSphere),N.tEi.push(T)}break;case r.ConnectivityTypeEnum.TRIANGLE_STRIP:(B=O.gas)&&!B.set&&(B=r.Gtr(O.gas,2)),(N=new r.DrawingGroup(B,F,4,b,O.nbIndices+O.Ens,void 0,void 0,t.GeomTypeEnum[O.geomType],void 0,h))._geomType=O.geomType?t.GeomTypeEnum[O.geomType]:0,M.drawingGroups.push(N);for(g=0;g<O.set.length;g++){m=O.set[g],C=b;var R=0;for(p=0;p<m.nbIndices-2;p++)P[b++]=E.IB[_],P[b++]=E.IB[_+1+R],P[b++]=E.IB[_+2-R],_++,R=1-R;_+=2;T=new r.wns(m.identifier,N,C,b-C);m.cgmId&&(T.cgmId=m.cgmId),m.decoration&&(T.decoration=m.decoration),m.boundingSphere&&(T.boundingSphere=m.boundingSphere),N.tEi.push(T)}break;case r.ConnectivityTypeEnum.LINES:F&&(F.shading="Basic"),(B=O.gas)&&!B.set&&(B=r.Gtr(O.gas,1)),(N=new r.DrawingGroup(B,F,1,b,O.nbIndices,void 0,void 0,t.GeomTypeEnum[O.geomType],void 0,h))._geomType=O.geomType?t.GeomTypeEnum[O.geomType]:0,M.drawingGroups.push(N);for(g=0;g<O.set.length;g++){m=O.set[g],T=new r.wns(m.identifier,N,b,m.nbIndices);m.cgmId&&(T.cgmId=m.cgmId),m.decoration&&(T.decoration=m.decoration),m.boundingSphere&&(T.boundingSphere=m.boundingSphere),N.tEi.push(T);for(p=0;p<m.nbIndices;p++)P[b++]=E.IB[_++]}break;case r.ConnectivityTypeEnum.LINE_STRIP:F&&(F.shading="Basic"),(B=O.gas)&&!B.set&&(B=r.Gtr(O.gas,1)),(N=new r.DrawingGroup(B,F,1,b,O.nbIndices+O.Ens,void 0,void 0,t.GeomTypeEnum[O.geomType],void 0,h))._geomType=O.geomType?t.GeomTypeEnum[O.geomType]:0,M.drawingGroups.push(N);for(g=0;g<O.set.length;g++){for(m=O.set[g],C=b,p=0;p<m.nbIndices-1;p++)P[b++]=E.IB[_++],P[b++]=E.IB[_];_++;T=new r.wns(m.identifier,N,C,b-C);m.cgmId&&(T.cgmId=m.cgmId),m.decoration&&(T.decoration=m.decoration),m.boundingSphere&&(T.boundingSphere=m.boundingSphere),N.tEi.push(T)}break;case r.ConnectivityTypeEnum.POINTS:var B;(B=O.gas)&&!B.set&&(B=r.Gtr(O.gas,0)),(N=new r.DrawingGroup(B,F,0,b,O.nbIndices,void 0,void 0,t.GeomTypeEnum[O.geomType],void 0,h))._geomType=O.geomType?t.GeomTypeEnum[O.geomType]:0,M.drawingGroups.push(N);for(g=0;g<O.set.length;g++){m=O.set[g],T=new r.wns(m.identifier,N,b,m.nbIndices);m.cgmId&&(T.cgmId=m.cgmId),m.decoration&&(T.decoration=m.decoration),m.boundingSphere&&(T.boundingSphere=m.boundingSphere),N.tEi.push(T);for(p=0;p<m.nbIndices;p++)P[b++]=E.IB[_++]}}}M.vertexIndexArray=P;var U=new t.Color,G=new t.Color,k=new t.Color;if(i.fillAttr.color&&U.eMi(i.fillAttr.color.r,i.fillAttr.color.g,i.fillAttr.color.b),i.lineAttr.color&&G.eMi(i.lineAttr.color.r,i.lineAttr.color.g,i.lineAttr.color.b),M.gas.fill={color:U,opacity:null==i.fillAttr.color.a?1:i.fillAttr.color.a,solid:i.fillAttr.solid},M.gas.line={color:G,opacity:null==i.lineAttr.color.a?1:i.lineAttr.color.a,lineWidth:i.lineAttr.thickness,pattern:i.lineAttr.pattern||1},i.pointAttr&&(i.pointAttr.color&&k.eMi(i.pointAttr.color.r,i.pointAttr.color.g,i.pointAttr.color.b),M.gas.point={color:k,opacity:null==i.pointAttr.color.a?1:i.pointAttr.color.a,ktr:i.pointAttr.size}),!a){var j=[0,0,0],x=[0,0,0];if(M.vertexPositionArray){var L=M.vertexPositionArray.length;if(L>=3){j=[M.vertexPositionArray[0],M.vertexPositionArray[1],M.vertexPositionArray[2]],x=[M.vertexPositionArray[0],M.vertexPositionArray[1],M.vertexPositionArray[2]];for(var H=0;H<L;H+=3)M.vertexPositionArray[H]<j[0]&&(j[0]=M.vertexPositionArray[H]),M.vertexPositionArray[H+1]<j[1]&&(j[1]=M.vertexPositionArray[H+1]),M.vertexPositionArray[H+2]<j[2]&&(j[2]=M.vertexPositionArray[H+2]),M.vertexPositionArray[H]>x[0]&&(x[0]=M.vertexPositionArray[H]),M.vertexPositionArray[H+1]>x[1]&&(x[1]=M.vertexPositionArray[H+1]),M.vertexPositionArray[H+2]>x[2]&&(x[2]=M.vertexPositionArray[H+2])}}M.AABB={min:j,max:x}}return M},r.xtr=function(i,n,e,s){for(var o=0,u=0;u<i.length;u++)o+=i[u].nbIndices;var h=[];for(u=0;u<r.Ltr;u++)h[u]=[];var a=0;for(u=0;u<n.length;u++){if(null!=(m=n[u])&&(!(m.component>=r.Ltr)&&!m.indexBuffer&&m.data.length&&(void 0===m.Htr||!m.Htr))){var f=0;if(w=h[m.component].length){var l=h[m.component][w-1];f=l.offset+l.buffer.data.length/3}h[m.component].push({buffer:m,offset:f}),m.Xtr=f,f+m.data.length/3>a&&(a=f+m.data.length/3)}}for(u=0;u<n.length;u++){if(null!=(m=n[u])&&(!(m.component>=r.Ltr)&&!m.indexBuffer&&m.data.length&&null!=m.Htr&&m.Htr)){f=a;h[m.component].push({buffer:m,offset:f}),m.Xtr=f}}var c=new Uint32Array(o),v=[];for(u=0;u<r.Ltr;u++){var w;if(w=h[u].length){var d=h[u][w-1];v[u]=new Float32Array(3*d.offset+d.buffer.data.length);f=0;for(var g=0;g<w;g++){var m,p=(m=h[u][g]).buffer.data.length,A=m.buffer.data;if(f<3*m.offset){for(var I=f;I<3*m.offset;I++)v[u][I]=0;f=3*m.offset}if(null==e)v[u].set(A,f);else for(I=0;I<p;I+=3){var y=new t.Vector3(A[I],A[I+1],A[I+2]);1==u?y.Fm(s):0==u&&y.Fm(e),v[u][f+I]=y.x,v[u][f+I+1]=y.y,v[u][f+I+2]=y.z}f+=p}}else v[u]=null}var O=0;for(u=0;u<i.length;u++){var E=i[u],M=E.vertexComponents[0],P=n[M.bufferId];if(null!=P){var _=P.Xtr;if(null!=M.indices){var b=n[M.indices.bufferId];for(I=0;I<E.nbIndices;I++)c[O+I]=b.data[M.indices.offset+I]+_}else for(I=0;I<E.nbIndices;I++)c[O+I]=_+M.offset+I;O+=E.nbIndices}}return{IB:c,VB:v}},r.jtr=function(i,n,e,s){null!=e&&null!=s||(e=null),void 0!==s&&s instanceof t.Matrix4&&((s=(new t.Matrix4).copy(s)).elements[12]=0,s.elements[13]=0,s.elements[14]=0);for(var o=0,u=0;u<i.length;u++)o+=i[u].nbIndices;var h=[],a=[],f=0;for(u=0;u<r.Ltr;u++)h[u]=null;for(u=0;u<i.length;u++){for(var l=i[u],c=0;c<l.wtr;c++){var v=l.vertexComponents[c];if(null==h[v.component]){h[v.component]=[],a[v.component]=v.bufferId;for(var w=0;w<o;w++)h[v.component][w]=null}n[v.bufferId];var d=null;if(null!=v.indices&&(d=n[v.indices.bufferId]),null!=d)for(w=0;w<l.nbIndices;w++)h[v.component][f+w]={bufferId:v.bufferId,index:v.offset+d.data[v.indices.offset+w]};else for(w=0;w<l.nbIndices;w++)h[v.component][f+w]={bufferId:v.bufferId,index:v.offset+w}}f+=l.nbIndices}var g=[];for(c=0;c<o;c++){(O=new r.Wtr).old_index=c;for(u=0;u<r.Ltr;u++)null!==h[u]&&(O.que[u]=h[u][c]);g.push(O)}g.sort((function(t,i){for(var n=0,e=0,s=0;s<r.Ltr;s++)if(null!=t.que[s]&&null!=i.que[s]){if(t.que[s].index<i.que[s].index)return-1;if(t.que[s].index>i.que[s].index)return 1;if(t.que[s].bufferId<i.que[s].bufferId)return-1;if(t.que[s].bufferId>i.que[s].bufferId)return 1}else null==t.que[s]&&n++,null==i.que[s]&&e++;return n<e?-1:n>e?1:0}));var m=new Uint32Array(o),p=[];for(u=0;u<r.Ltr;u++)if(null!==h[u]){var A=n[a[u]].dimension;p[u]=new Float32Array(A*o)}else p[u]=null;var I=-1,y=null;for(u=0;u<g.length;u++){var O,E=(O=g[u]).old_index;if(!u||!O.qtr(y)){I++,y=O;for(c=0;c<r.Ltr;c++)if(null!=O.que[c]){var M=n[O.que[c].bufferId].data,P=n[O.que[c].bufferId].dimension;if(null==e)for(w=0;w<P;w++)p[c][P*I+w]=M[P*h[c][O.old_index].index+w];else{var _=new t.Vector3(M[3*h[c][O.old_index].index],M[3*h[c][O.old_index].index+1],M[3*h[c][O.old_index].index+2]);1==c?(_.Fm(s),p[c][3*I]=_.x,p[c][3*I+1]=_.y,p[c][3*I+2]=_.z):0==c?(_.Fm(e),p[c][3*I]=_.x,p[c][3*I+1]=_.y,p[c][3*I+2]=_.z):(p[c][3*I]=_.x,p[c][3*I+1]=_.y,p[c][3*I+2]=_.z)}}}m[E]=I}var b=[];for(u=0;u<r.Ltr;u++){var S=p[u];if(null!==S){var N=n[a[u]].dimension*(I+1),F=new Float32Array(N);for(c=0;c<N;c++)F[c]=S[c];b[u]=F}else b[u]=null}return{IB:m,VB:b}},r.Vtr={UNKNOWN:0,DATA:1,ztr:2,Ytr:3,Jtr:4,Ktr:5,Qtr:6,Ztr:7,$tr:8,tir:9,iir:10,rir:11},r.Ltr=7,r.nir=function(){this.old_index=0,this.que=[],this.que[0]=-1,this.que[1]=-1,this.que[2]=-1,this.que[3]=-1,this.que[4]=-1,this.que[5]=-1,this.que[6]=-1},r.nir.prototype={constructor:r.nir,qtr:function(t){for(var i=0;i<r.Ltr;i++)if(-1!=this.que[i]&&-1!=t.que[i]&&this.que[i]!=t.que[i])return!1;return!0}},r.Wtr=function(){this.old_index=0,this.que=[];for(var t=0;t<r.Ltr;t++)this.que[t]=null},r.Wtr.prototype={constructor:r.Wtr,qtr:function(t){for(var i=0;i<r.Ltr;i++)if(null!=this.que[i]&&null!=t.que[i]){if(this.que[i].bufferId!=t.que[i].bufferId)return!1;if(this.que[i].index!=t.que[i].index)return!1}return!0}},r.Node=function(t,i,r,n,e,s,o){this.id=void 0!==t?t:"",this.type=void 0!==i?i:"Bag",this.childNodes=void 0!==r?r:[],this.matrix=void 0!==n?n:null,this.position=void 0!==e?e:{},this.rotation=void 0!==s?s:{},this.scale=void 0!==o?o:{}},r.Node.prototype={constructor:r.Node,add:function(t){null!=t&&this.childNodes.push(t)},gns:function(){var t=new Array;for(var i in this.childNodes)t[i]="object"==typeof this.childNodes[i]?this.childNodes[i].clone():this.childNodes[i];return t},eir:function(){if(this.matrix){var i=new t.Matrix4;return i.copy(this.matrix),i}},clone:function(){return new r.Node(this.id,this.type,this.gns(),this.eir(),this.position,this.rotation,this.scale)}},r.Mesh=function(t,i,n,e,s,o,u,h,a,f,l,c){this.id=void 0!==t?t:"",this.type=void 0!==i?i:"Mesh",this.vertexPositionArray=void 0!==n?n:null,this.vertexNormalArray=void 0!==e?e:null,this.vertexIndexArray=void 0!==s?s:null,this.vertexUvArray=void 0!==o?o:null,this.drawingGroups=void 0!==u?u:[],this.gas=void 0!==h?h:{fill:{},line:{}},this.AABB=void 0!==a?a:{},this.Xhi=0,this.material=void 0!==f?f:null,this.matrix=void 0!==c?c:null,this.rep=void 0!==l?new r.SGRep({cgmId:l.cgmId}):new r.SGRep},r.Mesh.prototype={constructor:r.Mesh,setMatrix:function(t){this.matrix=t},sir:function(){if(this.vertexIndexArray instanceof Uint32Array)return new Uint32Array(this.vertexIndexArray)},oir:function(t){if(t instanceof Float32Array)return new Float32Array(t)},uir:function(){var t;return this.gas&&(t={fill:this.gas.fill,line:this.gas.line}),t},hir:function(){return this.AABB.min&&this.AABB.max?{min:[this.AABB.min[0],this.AABB.min[1],this.AABB.min[2]],max:[this.AABB.max[0],this.AABB.max[1],this.AABB.max[2]]}:{}},air:function(){var t=new Array;for(var i in this.drawingGroups)t[i]="object"==typeof this.drawingGroups[i]?this.drawingGroups[i].clone():this.drawingGroups[i];return t},clone:function(){var t=new r.Mesh(this.id,this.type,this.oir(this.vertexPositionArray),this.oir(this.vertexNormalArray),this.sir(),this.oir(this.vertexUvArray),this.air(),this.uir(),this.hir(),this.material,this.rep);return this.vertexBinormalArray&&(t.vertexBinormalArray=this.oir(this.vertexBinormalArray)),this.vertexTangentArray&&(t.vertexTangentArray=this.oir(this.vertexTangentArray)),t}},r.wns=function(t,i,r,n,e){this.cgmId=t||0,this.fir=i||0,this.start=r||0,this.count=n||0,this.boundingSphere=void 0,this.rep=0,this.decoration=e||0},r.wns.prototype={constructor:r.wns,clone:function(){if(this.boundingSphere){var t=new r.wns(this.cgmId,this.fir,this.start,this.count,this.decoration);return t.boundingSphere={center:this.boundingSphere.center,radius:this.boundingSphere.radius},t}return this}},r.DrawingGroup=function(t,i,n,e,s,o,u,h,a,f){this.gas=t||null,this.material=i||null,this.glType=n,this._geomType=h||0,this.gasIndex=a,this.start=e||0,this.count=s||0,this.tEi=void 0!==o?o:[],this.geometry=null,this.lir=-1,this.ZUi=void 0!==f?f:-1,this.ib=null,this.nonIndexed=!1,this.cullingData=null,this._nonBinary=!(this.tEi instanceof r.BinarySGPrimitiveArray),this.Man=-1,this.Ib=null,this._dependentDGs=null,this._updateLineWithShapes=null},r.DrawingGroup.prototype={constructor:r.DrawingGroup,clone:function(){var t=new r.DrawingGroup(this.gas,this.material,this.glType,this.start,this.count,void 0,void 0,this._geomType,this.gasIndex,this.ZUi);if(t.copyPrimitives(this.tEi),t.geometry=this.geometry,t.Man=this.Man,t.Ib=this.Ib,t.Ib){const i=t.Ib.instanceAttribArrays;for(let t in i)"id"!==t&&(i[t].buffer=null)}return t._updateLineWithShapes=this._updateLineWithShapes,t},Nb:function(r,n,e){let s={};if(null!==this.Ib){let t=this.Ib.instanceAttribArrays;for(let i in t)"id"!==i&&null!==t[i].buffer&&void 0!==t[i].buffer&&(s[i]=t[i].buffer)}i--,this.Ib={nbInstances:r,instancingSelectionMode:e||"instance",instanceAttribArrays:{id:i},pickedInstanceId:-1,staleGLBuffers:[]};let o=this.Ib.instanceAttribArrays,u=new Float32Array(r);for(var h=0;h<r;h++)u[h]=5+5*h;o.instanceId={},o.instanceId.array=u,o.instanceId.buffer=null,o.instanceId.itemSize=1,this.material.lxi=!0,this.material.attributes={instanceId:{type:"f"}};for(let t=0;t<n.length;t++){const i=n[t];switch(this.material.attributes[i.attribName]={type:i.type},o[i.attribName]={isMat4:!1,itemSize:0,array:i.isFlattened?new Float32Array(i.data):null,buffer:null},i.type){case"f":o[i.attribName].itemSize=1;break;case"v2":o[i.attribName].itemSize=2;break;case"v3":o[i.attribName].itemSize=3;break;case"v4":o[i.attribName].itemSize=4;break;case"m4":o[i.attribName].itemSize=4,o[i.attribName].isMat4=!0}if(!i.isFlattened)switch(i.type){case"v2":o[i.attribName].array=new Float32Array(2*r);for(var a=0;a<r;a++)o[i.attribName].array[2*a+0]=i.data[a].x,o[i.attribName].array[2*a+1]=i.data[a].y;break;case"v3":o[i.attribName].array=new Float32Array(3*r);for(a=0;a<r;a++)o[i.attribName].array[3*a+0]=i.data[a].x,o[i.attribName].array[3*a+1]=i.data[a].y,o[i.attribName].array[3*a+2]=i.data[a].z;break;case"v4":o[i.attribName].array=new Float32Array(4*r);for(a=0;a<r;a++)o[i.attribName].array[4*a+0]=i.data[a].x,o[i.attribName].array[4*a+1]=i.data[a].y,o[i.attribName].array[4*a+2]=i.data[a].z,o[i.attribName].array[4*a+3]=i.data[a].w;break;case"m4":o[i.attribName].array=new Float32Array(16*i.data.length);for(var f=0;f<i.data.length;f++){var l=new Float32Array(16);l=i.data[f].elements;for(h=0;h<16;h++)o[i.attribName].array[16*f+h]=l[h]}}}for(let t in s)void 0!==o[t]?(o[t].buffer=s[t],o[t].isDynamic=!0):this.Ib.staleGLBuffers.push(s[t]);if(this.material.NEi&&this.material.NEi.PDSFX){let i="";for(let r=0;r<n.length;r++)i+="attribute "+t.ToGLSLTypes[n[r].type].t+" "+n[r].attribName+";\n";this.material.NEi._Mi=i}},INi:function(){if(this._nonBinary){var t=this.tEi;this.tEi=new Array(t.length);for(var i=0;i<t.length;i++)this.tEi[i]=t[i]}else this.tEi.INi()},_getDimension:function(t,i){var r=2,n=this;if(n._geomType)r=t[n._geomType];else switch(n.glType){case 0:r=0;break;case 1:r=1;break;default:r=2}return 2===r&&(r=i&&i.tNi>0?3===i.tNi?5:2:n.gas&&0===n.gas.side?5:2),this.Man=r,r},copyPrimitives:function(t){var i=null;if(t instanceof r.BinarySGPrimitiveArray)return this.tEi=t.clone(),void(this._nonBinary=!1);this._nonBinary=!0,this.tEi=new Array(t.length);for(var n=0;n<t.length;n++)if((i=t[n])instanceof r.SGPrimitive)this.tEi[n]=i.clone();else{var e=new r.SGPrimitive;e.cgmId=i.cgmId,e.rep=i.rep,e.group=this,e.start=i.start,e.count=i.count,this.tEi[n]=e}},KQe:function(i,r,n,e,s,o,u){if(!i||this.disabled(n,r)||s&&e===t.FixedSizeFiltering.Exclude)return null;if(s&&e===t.FixedSizeFiltering.CenterOnly)return new t.Box3(new t.Vector3(0,0,0),new t.Vector3(0,0,0)).Fm(i);var h=new t.Vector3,a=new t.Vector3,f=new t.Vector3,l=new t.Vector3,c=null!==o?o:this.start,v=null!==u?u:this.count,w=this.geometry.vertexIndexArray;if(this.geometry.PRi()){var d=w[c];this.geometry.Awi(d,l),a.set(l.x,l.y,l.z).Fm(i),f.set(l.x,l.y,l.z).Fm(i);for(var g=c+1;g<c+v;g++)d=w[g],this.geometry.Awi(d,l),h.set(l.x,l.y,l.z).Fm(i),h.x<a.x&&(a.x=h.x),h.y<a.y&&(a.y=h.y),h.z<a.z&&(a.z=h.z),h.x>f.x&&(f.x=h.x),h.y>f.y&&(f.y=h.y),h.z>f.z&&(f.z=h.z)}return new t.Box3(a,f)},Ftr:function(t,i,r,n,e,s){return this._nonBinary?this.tEi[t].KQe(i,r,n,e,s):this.tEi.Ftr(t,i,r,n,e,s)},disabled:function(t,i){return!!((i=i||0)>0&&this._geomType&i>0)||-1!==t&&!((this._geomType&t)>0||0===this._geomType)},getPrimitiveCgmId:function(t){return this._nonBinary?this.tEi[t].cgmId:this.tEi.getPrimitiveCgmId(t)},Itr:function(t,i){this._nonBinary?this.tEi[i].cgmId=t:this.tEi.Itr(t,i)},getPrimitiveType:function(t){return this._nonBinary?this.tEi[t].type:this.tEi.getPrimitiveType(t)},getPrimitiveRep:function(t){return this._nonBinary?this.tEi[t].rep:this.tEi.getPrimitiveRep(t)},ytr:function(t){return this._nonBinary?this.tEi[t].clone():this.tEi.ytr(t)},Otr:function(t){return this._nonBinary?this.tEi[t].internalNode:this.tEi.Otr(t)},Etr:function(t,i){this._nonBinary?this.tEi[i].internalNode=t:this.tEi.Etr(t,i)},_setPrimitiveStart:function(t,i){this._nonBinary?this.tEi[i].start=t:this.tEi._setPrimitiveStart(t,i)},_setPrimitiveCount:function(t,i){this._nonBinary?this.tEi[i].count=t:this.tEi._setPrimitiveCount(t,i)},getPrimitiveStart:function(t){return this._nonBinary?this.tEi[t].start:this.tEi.getPrimitiveStart(t)},getPrimitiveCount:function(t){return this._nonBinary?this.tEi[t].count:this.tEi.getPrimitiveCount(t)},getPrimitiveGroup:function(t){return this._nonBinary?this.tEi[t].group:this.tEi.getPrimitiveGroup(t)},getPrimitiveDecoration:function(t){return this._nonBinary?this.tEi[t].decoration:this.tEi.getPrimitiveDecoration(t)},Mtr:function(t){return this._nonBinary?this.tEi[t].boundingSphere:this.tEi.Mtr(t)},Ptr:function(t,i){this._nonBinary?this.tEi[t].boundingSphere=i:this.tEi.Ptr(t,i)},getPrimitivesCount:function(){return this._nonBinary?this.tEi.length:this.tEi.getPrimitivesCount()},_tr:function(t){return this._nonBinary?this.tEi[t].btr:this.tEi._tr(t)},Str:function(t,i){this._nonBinary?this.tEi[i].btr=t:this.tEi.Str(t,i)},Ntr:function(t,i){return this._nonBinary?this.tEi[t].computeBoundingSphere(i):this.tEi.Ntr(t,i)},qQe:function(){return!0},JQe:function(){return!0}},Object.defineProperty(r.DrawingGroup.prototype,"geomType",{get:function(){return r.GeomTypeString[this._geomType]},set:function(i){this._geomType=t.GeomTypeEnum[i]}});var c=0;Object.defineProperty(r.DrawingGroup.prototype,"primitives",{get:function(){if(c<10){var t=new Error,i="#PrimApi - DG.GetPrimitives - "+(t.stack?t.stack.split("\n")[1]+" - "+t.stack.split("\n")[2]:"");n.has(i.hashCode())||n.add(i.hashCode()),c++}return this.tEi},set:function(){throw"NO"}}),r.SelectionGroup=function(){this.geometries={}},r.SelectionGroup.prototype={constructor:r.SelectionGroup,contains:function(t){for(var i in this.geometries)for(var r=this.geometries[i],n=0;n<r.length;n++)for(var e=r[n].primitives,s=0;s<e.length;s++)if(e[s].isEqual(t))return!0;return!1},getFirstPrimitive:function(){for(var t in this.geometries){var i=this.geometries[t];if(i.length&&i[0].primitives.length)return i[0].primitives[0]}return null},Q4e:function(){var t=[];for(var i in this.geometries)for(var r=this.geometries[i],n=0;n<r.length;n++)for(var e=r[n].primitives,s=0;s<e.length;s++)t.push(e[s]);return t},Shi:function(t){var i=0,r=t.getGroup(),n=r.geometry.id,e=this.geometries[n];for(e||(e=[],this.geometries[n]=e),i=0;i<e.length;i++)if(e[i].drawingGroup===r){e[i].primitives.push(t);break}i===e.length&&e.push({drawingGroup:r,primitives:[t]})},clone:function(){var t=new r.SelectionGroup;for(var i in this.geometries){var n=this.geometries[i];t.geometries[i]=[];for(var e=0;e<n.length;e++)t.geometries[i][e]={drawingGroup:n[e].drawingGroup,primitives:n[e].primitives.slice()}}return t},V5t:function(){var t,i=this.getFirstPrimitive();return i&&i.V5t&&(t=i.V5t()),t},computeBoundingSphere:function(){for(var i=null,r=new t.Sphere,n=this.Q4e(),e=0;e<n.length;e++){n[e].computeBoundingSphere(r),i?r._k(i,i):i=r.clone()}return i},KQe:function(i,r,n,e,s){for(var o,u=new t.Box3,h=this.Q4e(),a=0;a<h.length;a++){(o=h[a].KQe(i,r,n,e,s))&&(u=u.union(o))}return u}},r.ves=function(i,n,e,s,o){for(var u=0,h=0,a=!n,f=[],l=s||{},c=!1,v=!1,w=!1,d=!1,g=!1,m=!1,p=0;p<i.length;p++)u+=i[p].vertexPositionArray?i[p].vertexPositionArray.length:0,h+=i[p].vertexIndexArray.length,c||null===i[p].vertexNormalArray||(c=!0),v||null===i[p].vertexUvArray||(v=!0),!w&&i[p].vertexUv2Array&&(w=!0),!d&&i[p].vertexTangentArray&&(d=!0),!g&&i[p].vertexBinormalArray&&(g=!0),!m&&i[p].vertexColorArray&&(m=!0);var A,I=new Float32Array(u);A=u/3<65535?new Uint16Array(h):new Uint32Array(h);var y=c?new Float32Array(u):null,O=v?new Float32Array(u):null,E=w?new Float32Array(u):null,M=d?new Float32Array(u):null,P=g?new Float32Array(u):null,_=m?new Float32Array(4*u/3):null,b=0;for(p=0;p<i.length;p++){var S=i[p],N=S.vertexPositionArray;N&&(I.set(N,b),null!==y&&S.vertexNormalArray&&y.set(S.vertexNormalArray,b),null!==O&&S.vertexUvArray&&O.set(S.vertexUvArray,b),null!==E&&S.vertexUv2Array&&E.set(S.vertexUv2Array,b),null!==M&&S.vertexTangentArray&&M.set(S.vertexTangentArray,b),null!==P&&S.vertexBinormalArray&&P.set(S.vertexBinormalArray,b),null!==_&&S.vertexColorArray&&_.set(S.vertexColorArray,b));for(var F=0;F<S.drawingGroups.length;F++){(et=S.drawingGroups[F]).lir=b/3,et.ib=S.vertexIndexArray,et.geometry=i[p],null==et.gas&&(4==et.glType||5==et.glType?et.gas=i[p].gas.fill:1==et.glType?et.gas=i[p].gas.line:0==et.glType&&(et.gas=i[p].gas.point));for(var T=0;T<et.tEi.length;T++){if((nt=et.tEi[T]).rep=S.rep,nt.boundingSphere){var C=new t.Vector3(nt.boundingSphere.center[0],nt.boundingSphere.center[1],nt.boundingSphere.center[2]);!!S.globalMatrix&&!S.globalMatrix.isIdentity()&&(C.Fm(i[p].globalMatrix),nt.boundingSphere.center=[C.x,C.y,C.z],nt.boundingSphere.radius*=i[p].globalMatrix.getMaxScaleOnAxis())}}f.push(et)}b+=N?N.length:0}f.sort((function(t,i){if(t.glType<i.glType)return-1;if(t.glType>i.glType)return 1;if(null==t.material&&null!=i.material)return-1;if(null!=t.material&&null==i.material)return 1;if(null!=t.material&&null!=i.material){if(t.material.id<i.material.id)return-1;if(t.material.id>i.material.id)return 1;if(t.material.file<i.material.file)return-1;if(t.material.file>i.material.file)return 1}if(null==t.gas&&null!=i.gas)return-1;if(null!=t.gas&&null==i.gas)return-1;if(null!=t.gas&&null!=i.gas){if(t.gas.set<i.gas.set)return 1;if(i.gas.set<t.gas.set)return-1;if(t.gas.rgba<i.gas.rgba)return 1;if(i.gas.rgba<t.gas.rgba)return-1}if(t._geomType&&i._geomType){if(t._geomType<i._geomType)return-1;if(t._geomType>i._geomType)return 1;if(e){if(t.geometry.Xhi<i.geometry.Xhi)return 1;if(t.geometry.Xhi>i.geometry.Xhi)return-1}}if(e){if(t.geometry.Xhi<i.geometry.Xhi)return 1;if(t.geometry.Xhi>i.geometry.Xhi)return-1}return 0}));var D=[],R=f.length>0?f[0].gas:null,B=f.length>0?f[0].material:null,U=f.length>0?f[0].glType:0,G=f.length>0?f[0]._geomType:0,k=0,j=0,x=0,L=0,H=R,X=[],W=[],q=l.ces;for(p=0;p<f.length;p++){if((et=f[p]).glType==U&&et._geomType===G&&R.isEqual(et.gas)&&(null==B&&null==et.material||null!=B&&null!=et.material&&B.id==et.material.id&&B.file==et.material.file)){e&&X.push({start:k,count:et.count,radius:et.geometry.Xhi,rep:et.geometry.rep}),x+=et.count,W.push(et);for(F=0;F<et.count;F++)A[k++]=et.lir+et.ib[et.start+F]}else{var V=null;if(x>0){V=new r.DrawingGroup(R,f[p-1].material,U,j,x,void 0,void 0,G,L),e&&(V.cullingData=X);for(var z=0,Y=0;Y<W.length;++Y)z+=W[Y].tEi.length;var J=new Uint32Array(5*z),K=null;q&&V.glType>0&&(K=new Float32Array(4*z));for(var Q=0,Z=j,$=[],tt=0;tt<W.length;++tt){var it=W[tt],rt=5*Q;if(it.geometry.noShow&&l.ues)for(Y=0;Y<it.tEi.length;Y++){var nt=it.tEi[Y];if($.push(Q),J[rt++]=nt.cgmId+1,J[rt++]=nt.rep,J[rt++]=Z,J[rt++]=nt.count,J[rt++]=nt.decoration,K&&nt.boundingSphere)K[st=4*Q]=nt.boundingSphere.center[0],K[st+1]=nt.boundingSphere.center[1],K[st+2]=nt.boundingSphere.center[2],K[st+3]=nt.boundingSphere.radius;Q++,Z+=nt.count}else for(Y=0;Y<it.tEi.length;Y++){nt=it.tEi[Y];if(J[rt++]=nt.cgmId+1,J[rt++]=nt.rep,J[rt++]=Z,J[rt++]=nt.count,J[rt++]=nt.decoration,K&&nt.boundingSphere)K[st=4*Q]=nt.boundingSphere.center[0],K[st+1]=nt.boundingSphere.center[1],K[st+2]=nt.boundingSphere.center[2],K[st+3]=nt.boundingSphere.radius;Q++,Z+=nt.count}}V.tEi=K?{prims:J,bs:K}:J,$.length&&(V.noShowPrim=$),D.push(V)}W=[],X=[],H.isEqual(et.gas)||(H=et.gas,L++),U=et.glType,G=et._geomType,R=et.gas,B=et.material,j=k,x=et.count,W.push(et),e&&X.push({start:k,count:et.count,radius:et.geometry.Xhi,rep:et.geometry.rep});for(F=0;F<et.count;F++)A[k++]=et.lir+et.ib[et.start+F]}}if(x>0){V=new r.DrawingGroup(R,f[f.length-1].material,U,j,x,void 0,void 0,G,L);e&&(V.cullingData=X);for(z=0,Y=0;Y<W.length;++Y)z+=W[Y].tEi.length;J=new Uint32Array(5*z),K=null;q&&V.glType>0&&(K=new Float32Array(4*z));for(Z=j,Q=0,$=[],tt=0;tt<W.length;++tt){var et;rt=5*Q;if((et=W[tt]).geometry.noShow&&l.ues)for(Y=0;Y<et.tEi.length;Y++){nt=et.tEi[Y];if($.push(Q),J[rt++]=nt.cgmId+1,J[rt++]=nt.rep,J[rt++]=Z,J[rt++]=nt.count,J[rt++]=nt.decoration,K&&nt.boundingSphere)K[st=4*Q]=nt.boundingSphere.center[0],K[st+1]=nt.boundingSphere.center[1],K[st+2]=nt.boundingSphere.center[2],K[st+3]=nt.boundingSphere.radius;Q++,Z+=nt.count}else for(Y=0;Y<et.tEi.length;Y++){var st;nt=et.tEi[Y];if(J[rt++]=nt.cgmId+1,J[rt++]=nt.rep,J[rt++]=Z,J[rt++]=nt.count,J[rt++]=nt.decoration,K&&nt.boundingSphere)K[st=4*Q]=nt.boundingSphere.center[0],K[st+1]=nt.boundingSphere.center[1],K[st+2]=nt.boundingSphere.center[2],K[st+3]=nt.boundingSphere.radius;Q++,Z+=nt.count}}V.tEi=K?{prims:J,bs:K}:J,$.length&&(V.noShowPrim=$),D.push(V)}var ot=new r.Mesh;if(ot.vertexPositionArray=I,ot.vertexNormalArray=y,ot.vertexUvArray=O,ot.vertexUv2Array=E,ot.vertexTangentArray=M,ot.vertexBinormalArray=P,ot.vertexIndexArray=A,ot.vertexColorArray=_,ot.drawingGroups=D,void 0===i[0]){var ut=new t.Color;ut.eMi(.5,.5,.5),ot.gas.fill={color:ut,opacity:1,solid:0},ot.gas.line={color:ut,opacity:1,lineWidth:1},ot.gas.point={color:ut,opacity:1,ktr:1}}else ot.gas=i[0].gas;if(a){var ht=[0,0,0],at=[0,0,0];if(u>=3){ht=[I[0],I[1],I[2]],at=[I[0],I[1],I[2]];for(p=0;p<u;p+=3)I[p]<ht[0]&&(ht[0]=I[p]),I[p+1]<ht[1]&&(ht[1]=I[p+1]),I[p+2]<ht[2]&&(ht[2]=I[p+2]),I[p]>at[0]&&(at[0]=I[p]),I[p+1]>at[1]&&(at[1]=I[p+1]),I[p+2]>at[2]&&(at[2]=I[p+2])}ot.AABB={min:ht,max:at}}return ot},r.cir=function(i,n,e){for(var s=0,o=0,u=!n,h=[],a=!1,f=!1,l=!1,c=!1,v=!1,w=0;w<i.length;w++)s+=i[w].vertexPositionArray?i[w].vertexPositionArray.length:0,o+=i[w].vertexIndexArray.length,a||null===i[w].vertexNormalArray||(a=!0),f||null===i[w].vertexUvArray||(f=!0),!l&&i[w].vertexUv2Array&&(l=!0),!c&&i[w].vertexTangentArray&&(c=!0),!v&&i[w].vertexBinormalArray&&(v=!0);var d,g=new Float32Array(s);d=s/3<65535?new Uint16Array(o):new Uint32Array(o);var m=a?new Float32Array(s):null,p=f?new Float32Array(s):null,A=l?new Float32Array(s):null,I=c?new Float32Array(s):null,y=v?new Float32Array(s):null,O=0;for(w=0;w<i.length;w++){if(i[w].vertexPositionArray)for(var E=0;E<i[w].vertexPositionArray.length;E++)g[O+E]=i[w].vertexPositionArray[E],null!==m&&(m[O+E]=null!==i[w].vertexNormalArray?i[w].vertexNormalArray[E]:0),null!==p&&(p[O+E]=null!==i[w].vertexUvArray?i[w].vertexUvArray[E]:0),null!==A&&(A[O+E]=i[w].vertexUv2Array?i[w].vertexUv2Array[E]:0),null!==I&&(I[O+E]=i[w].vertexTangentArray?i[w].vertexTangentArray[E]:0),null!==y&&(y[O+E]=i[w].vertexBinormalArray?i[w].vertexBinormalArray[E]:0);for(E=0;E<i[w].drawingGroups.length;E++){(k=i[w].drawingGroups[E]).lir=O/3,k.ib=i[w].vertexIndexArray,k.geometry=i[w],null==k.gas&&(4==k.glType||5==k.glType?k.gas=i[w].gas.fill:1==k.glType?k.gas=i[w].gas.line:0==k.glType&&(k.gas=i[w].gas.point));for(var M=0;M<k.tEi.length;M++){if((L=k.tEi[M]).rep=i[w].rep,L.boundingSphere){var P=new t.Vector3(L.boundingSphere.center[0],L.boundingSphere.center[1],L.boundingSphere.center[2]);!!i[w].globalMatrix&&!i[w].globalMatrix.isIdentity()&&(P.Fm(i[w].globalMatrix),L.boundingSphere.center=[P.x,P.y,P.z],L.boundingSphere.radius*=i[w].globalMatrix.getMaxScaleOnAxis())}}h.push(k)}O+=i[w].vertexPositionArray?i[w].vertexPositionArray.length:0}h.sort((function(t,i){if(t.glType<i.glType)return-1;if(t.glType>i.glType)return 1;if(null==t.material&&null!=i.material)return-1;if(null!=t.material&&null==i.material)return 1;if(null!=t.material&&null!=i.material){if(t.material.id<i.material.id)return-1;if(t.material.id>i.material.id)return 1;if(t.material.file<i.material.file)return-1;if(t.material.file>i.material.file)return 1}if(null==t.gas&&null!=i.gas)return-1;if(null!=t.gas&&null==i.gas)return-1;if(null!=t.gas&&null!=i.gas){var n=r.vir(t.gas,i.gas);if(n)return n}if(t._geomType&&i._geomType){if(t._geomType<i._geomType)return-1;if(t._geomType>i._geomType)return 1;if(t.geometry.Xhi<i.geometry.Xhi)return 1;if(t.geometry.Xhi>i.geometry.Xhi)return-1}return t.geometry.Xhi<i.geometry.Xhi?1:t.geometry.Xhi>i.geometry.Xhi?-1:0}));var _=[],b=[],S=h.length>0?h[0].gas:null,N=h.length>0?h[0].material:null,F=h.length>0?h[0].glType:0,T=h.length>0?h[0]._geomType:0,C=0,D=0,R=0,B=0,U=S,G=[];for(w=0;w<h.length;w++){var k;if((k=h[w]).glType==F&&k._geomType===T&&!r.vir(S,k.gas)&&(null==N&&null==k.material||null!=N&&null!=k.material&&N.id==k.material.id&&N.file==k.material.file)){e&&G.push({start:C,count:k.count,radius:k.geometry.Xhi,rep:k.geometry.rep}),R+=k.count;for(var j=C,x=0;x<k.tEi.length;x++){var L=k.tEi[x],H=new r.SGPrimitive({cgmId:L.cgmId,rep:L.rep,start:j,count:L.count});L.decoration&&(H.decoration=L.decoration),L.boundingSphere&&(H.boundingSphere=L.boundingSphere),b.push(H),L.rep.tEi.push(H),j+=L.count}for(E=0;E<k.count;E++)d[C++]=k.lir+k.ib[k.start+E]}else{var X=null;if(R>0){(X=new r.DrawingGroup(S,N,F,D,R,void 0,void 0,T,B)).tEi=b,e&&(X.cullingData=G);for(var W=0;W<b.length;W++)b[W].group=X;_.push(X)}b=[],G=[],0!==r.vir(U,k.gas)&&(U=k.gas,B++),F=k.glType,T=k._geomType,S=k.gas,N=k.material,D=C,R=k.count,e&&G.push({start:C,count:k.count,radius:k.geometry.Xhi,rep:k.geometry.rep});for(j=C,x=0;x<k.tEi.length;x++){L=k.tEi[x],H=new r.SGPrimitive({cgmId:L.cgmId,rep:L.rep,start:j,count:L.count});L.decoration&&(H.decoration=L.decoration),L.boundingSphere&&(H.boundingSphere=L.boundingSphere),b.push(H),L.rep.tEi.push(H),j+=L.count}for(E=0;E<k.count;E++)d[C++]=k.lir+k.ib[k.start+E]}}if(R>0){(X=new r.DrawingGroup(S,N,F,D,R,void 0,void 0,T,B)).tEi=b,e&&(X.cullingData=G);for(W=0;W<b.length;W++)b[W].group=X;_.push(X)}var q=new r.Mesh;if(q.vertexPositionArray=g,q.vertexNormalArray=m,q.vertexUvArray=p,q.vertexUv2Array=A,q.vertexTangentArray=I,q.vertexBinormalArray=y,q.vertexIndexArray=d,q.drawingGroups=_,void 0===i[0]){var V=new t.Color;V.eMi(.5,.5,.5),q.gas.fill={color:V,opacity:1,solid:0},q.gas.line={color:V,opacity:1,lineWidth:1},q.gas.point={color:V,opacity:1,ktr:1}}else q.gas=i[0].gas;if(u){var z=[0,0,0],Y=[0,0,0];if(s>=3){z=[g[0],g[1],g[2]],Y=[g[0],g[1],g[2]];for(w=0;w<s;w+=3)g[w]<z[0]&&(z[0]=g[w]),g[w+1]<z[1]&&(z[1]=g[w+1]),g[w+2]<z[2]&&(z[2]=g[w+2]),g[w]>Y[0]&&(Y[0]=g[w]),g[w+1]>Y[1]&&(Y[1]=g[w+1]),g[w+2]>Y[2]&&(Y[2]=g[w+2])}q.AABB={min:z,max:Y}}return q},r.divideRep=function(t,i,n){var e=t.vertexPositionArray?t.vertexPositionArray.length:0,s=(t.vertexIndexArray.length,[]),o=n||{};if(i)for(var u=0,h=(o=n||{}).ces,a=0;a<t.drawingGroups.length;a++){null==(p=t.drawingGroups[a]).gas&&(4==p.glType||5==p.glType?p.gas=t.gas.fill:1==p.glType?p.gas=t.gas.line:0==p.glType&&(p.gas=t.gas.point)),u=p.tEi.length;var f=new Uint32Array(5*u),l=null;h&&p.glType>0&&(l=new Float32Array(4*u));var c=0,v=0;if(t.noShow&&o.ues)for(var w=0;w<p.tEi.length;w++){var d=p.tEi[w];noShowPrim.push(w),f[c++]=d.cgmId+1,f[c++]=t.rep,f[c++]=d.start,f[c++]=d.count,f[c++]=d.decoration,l&&d.boundingSphere&&(l[v++]=d.boundingSphere.center[0],l[v++]=d.boundingSphere.center[1],l[v++]=d.boundingSphere.center[2],l[v++]=d.boundingSphere.radius)}else for(w=0;w<p.tEi.length;w++){d=p.tEi[w];f[c++]=d.cgmId+1,f[c++]=t.rep,f[c++]=d.start,f[c++]=d.count,f[c++]=d.decoration,l&&d.boundingSphere&&(l[v++]=d.boundingSphere.center[0],l[v++]=d.boundingSphere.center[1],l[v++]=d.boundingSphere.center[2],l[v++]=d.boundingSphere.radius)}p.tEi=l?{prims:f,bs:l}:f}else for(w=0;w<t.drawingGroups.length;w++){null==(p=t.drawingGroups[w]).gas&&(4==p.glType||5==p.glType?p.gas=t.gas.fill:1==p.glType?p.gas=t.gas.line:0==p.glType&&(p.gas=t.gas.point));for(a=0;a<p.tEi.length;a++){d=p.tEi[a];var g=new r.SGPrimitive({cgmId:d.cgmId,rep:t.rep,group:p,start:d.start,count:d.count});d.decoration&&(g.decoration=d.decoration),d.boundingSphere&&(g.boundingSphere=d.boundingSphere),p.tEi[a]=g,t.rep.tEi.push(g)}}var m,p,A=t.vertexIndexArray;m=e/3<65535?new Uint16Array(A.length):new Uint32Array(A.length);for(var w=0;w<A.length;w++)m[w]=A[w];return t.vertexIndexArray=m,r.unindexPoints(t),s.push(t),s},r.unindexPoints=function(t){if(!e&&!s)return!1;if(!t.vertexPositionArray)return!1;var i,r,n=!1,o=t.vertexPositionArray.length/3,u=new Int32Array(o);for(i=0;i<o;i++)u[i]=-1;var h=0;for(i=0;i<t.drawingGroups.length;i++){if(!((f=t.drawingGroups[i]).glType>0)){for(n=!0,r=f.start;r<f.start+f.count;r++){-1===u[l=t.vertexIndexArray[r]]?(t.vertexIndexArray[r]=h,u[l]=h,h++):t.vertexIndexArray[r]=u[l]}f.nonIndexed=!0,f.start=t.vertexIndexArray[f.start]}}if(!n)return!1;var a=h;for(i=0;i<h;i++)if(-1===u[i])for(;a<o;){if(-1!==u[a]){u[i]=a,a++;break}u[a]=a,a++}for(;a<o;)-1===u[a]&&(u[a]=a),a++;for(i=0;i<t.drawingGroups.length;i++){var f;if(0!==(f=t.drawingGroups[i]).glType)for(r=f.start;r<f.start+f.count;r++){var l=t.vertexIndexArray[r];t.vertexIndexArray[r]=u[l]}}var c=[];t.vertexPositionArray&&c.push(t.vertexPositionArray),t.vertexNormalArray&&c.push(t.vertexNormalArray),t.vertexUvArray&&c.push(t.vertexUvArray),t.vertexUv2Array&&c.push(t.vertexUv2Array),t.vertexTangentArray&&c.push(t.vertexTangentArray),t.vertexBinormalArray&&c.push(t.vertexBinormalArray);var v=new Float32Array(3*c.length),w=new Float32Array(3*c.length);for(i=0;i<o;i++){var d=i,g=u[d];if(g!==d&&-1!==g){for(r=0;r<c.length;r++){var m=c[r];v[3*r]=m[3*d],v[3*r+1]=m[3*d+1],v[3*r+2]=m[3*d+2]}for(;-1!==g;){for(r=0;r<c.length;r++){m=c[r];w[3*r]=m[3*g],w[3*r+1]=m[3*g+1],w[3*r+2]=m[3*g+2],m[3*g]=v[3*r],m[3*g+1]=v[3*r+1],m[3*g+2]=v[3*r+2],v[3*r]=w[3*r],v[3*r+1]=w[3*r+1],v[3*r+2]=w[3*r+2]}u[d]=-1,g=u[d=g]}}}return!0},r.vir=function(t,i){if(t.opacity<i.opacity)return-1;if(t.opacity>i.opacity)return 1;if(t.color.r<i.color.r)return-1;if(t.color.r>i.color.r)return 1;if(t.color.g<i.color.g)return-1;if(t.color.g>i.color.g)return 1;if(t.color.b<i.color.b)return-1;if(t.color.b>i.color.b)return 1;if(t.thickness&&i.thickness){if(t.thickness<i.thickness)return-1;if(t.thickness>i.thickness)return 1}if(t.lineWidth&&i.lineWidth){if(t.pattern<i.pattern)return-1;if(t.pattern>i.pattern)return 1;if(t.lineWidth<i.lineWidth)return-1;if(t.lineWidth>i.lineWidth)return 1;if((t.forceMaterial||i.forceMaterial)&&(!t.forceMaterial||!i.forceMaterial))return t.forceMaterial?-1:1}if(t.ktr&&i.ktr){if(t.ktr<i.ktr)return-1;if(t.ktr>i.ktr)return 1;if((t.forceMaterial||i.forceMaterial)&&(!t.forceMaterial||!i.forceMaterial))return t.forceMaterial?-1:1}if(t.symbol&&i.symbol){if(t.symbol<i.symbol)return-1;if(t.symbol>i.symbol)return 1;if(t.symbol.id<i.symbol.id)return-1;if(t.symbol.id>i.symbol.id)return 1}if(null!=t.solid&&null!=i.solid){if(t.solid<i.solid)return-1;if(t.solid>i.solid)return 1}return 0},r.tes=function(i,r,n,e){if(null!=r){if(i.vertexNormalArray)for(var s=0;s<i.vertexNormalArray.length;s+=3){(o=new t.Vector3(i.vertexNormalArray[s],i.vertexNormalArray[s+1],i.vertexNormalArray[s+2])).Fm(e),i.vertexNormalArray[s]=o.x,i.vertexNormalArray[s+1]=o.y,i.vertexNormalArray[s+2]=o.z}if(i.vertexPositionArray){for(s=0;s<i.vertexPositionArray.length;s+=3){var o;(o=new t.Vector3(i.vertexPositionArray[s],i.vertexPositionArray[s+1],i.vertexPositionArray[s+2])).Fm(r),i.vertexPositionArray[s]=o.x,i.vertexPositionArray[s+1]=o.y,i.vertexPositionArray[s+2]=o.z}var u=i.drawingGroups;for(s=0;s<u.length;++s){var h=(v=u[s]).material;if(!(!h||h.id<0||!n[h.id].physicalMaterial||!n[h.id].physicalMaterial.PhysicalMaterial.MappingOperator&&!n[h.id].mapping||n[h.id].physicalMaterial.PhysicalMaterial.MappingOperator&&"None"==n[h.id].physicalMaterial.PhysicalMaterial.MappingOperator.Type||n[h.id].mapping&&n[h.id].mapping.type<0)){var a=(new t.Matrix4).getInverse(r),f=JSON.parse(JSON.stringify(n[h.id])),l=f.physicalMaterial.PhysicalMaterial.MappingOperator;l||(l=f.mapping),l&&l.UvTransformation&&(l.UvTransformation=l.UvTransformation.slice(0));var c=new t.Matrix4;l&&l.ObjectTransformation&&(c.elements=l.ObjectTransformation.slice(0)),c.multiply(a),l.ObjectTransformation=c.elements,v.material.id=n.length,n.push(f)}}if(r.determinant()<0)for(s=0;s<u.length;++s){var v;if(4==(v=u[s]).glType)for(var w=v.count/3,d=0;d<w;d++){var g=i.vertexIndexArray[v.start+3*d],m=i.vertexIndexArray[v.start+3*d+1];i.vertexIndexArray[v.start+3*d]=m,i.vertexIndexArray[v.start+3*d+1]=g}}}}},r.ses=function(t){var i=[0,0,0],r=[0,0,0];if(t.vertexPositionArray){var n=t.vertexPositionArray.length;if(n>=3){i=[t.vertexPositionArray[0],t.vertexPositionArray[1],t.vertexPositionArray[2]],r=[t.vertexPositionArray[0],t.vertexPositionArray[1],t.vertexPositionArray[2]];for(var e=0;e<n;e+=3)t.vertexPositionArray[e]<i[0]&&(i[0]=t.vertexPositionArray[e]),t.vertexPositionArray[e+1]<i[1]&&(i[1]=t.vertexPositionArray[e+1]),t.vertexPositionArray[e+2]<i[2]&&(i[2]=t.vertexPositionArray[e+2]),t.vertexPositionArray[e]>r[0]&&(r[0]=t.vertexPositionArray[e]),t.vertexPositionArray[e+1]>r[1]&&(r[1]=t.vertexPositionArray[e+1]),t.vertexPositionArray[e+2]>r[2]&&(r[2]=t.vertexPositionArray[e+2])}}t.AABB={min:i,max:r}},r.wir=function(t,i){if(!t)return.2;let r=.2,n=t.scale?t.scale:1;switch(t.shs){case 0:i>0&&(r=.01*i*t.sag);break;case 1:r=t.sag*n;break;case 2:r=.2*n;break;case 3:r=.4*n}return r<.01&&(r=.01),i>0&&r>.1*i&&(r=.1*i),r},r.gir=function(t,i){let r=2*Math.acos(1-t/i);return r<.001&&(r=.001),r},r.mir=function(t,i){return t/i},r.pir=function(t,i){let r=Math.PI/4;i>r&&(i=r);let n=Math.ceil(t/i);return n<3&&(n=3),[n,i=this.mir(t,n)]},r.rhs=function(i,n,e,s,o,u,h,a,f){var l=s>0,c=e>0,v=new t.Vector3(n[0],n[1],n[2]),w=new t.Vector3(i[0],i[1],i[2]),p=new t.Vector4;p.subVectors(v,w),p.w=0,p.normalize();var A=new t.Matrix4;0===p.x&&0===p.y?A.identity():A.set(p.x/Math.sqrt(p.x*p.x+p.y*p.y),p.y/Math.sqrt(p.x*p.x+p.y*p.y),0,0,-p.y/Math.sqrt(p.x*p.x+p.y*p.y),p.x/Math.sqrt(p.x*p.x+p.y*p.y),0,0,0,0,1,0,0,0,0,1);var I=new t.Matrix4;0===p.x&&0===p.y&&0===p.z?I.identity():I.set(p.z/Math.sqrt(p.x*p.x+p.y*p.y+p.z*p.z),0,-Math.sqrt(p.x*p.x+p.y*p.y)/Math.sqrt(p.x*p.x+p.y*p.y+p.z*p.z),0,0,1,0,0,Math.sqrt(p.x*p.x+p.y*p.y)/Math.sqrt(p.x*p.x+p.y*p.y+p.z*p.z),0,p.z/Math.sqrt(p.x*p.x+p.y*p.y+p.z*p.z),0,0,0,0,1);var y=new t.Matrix4;y.multiplyMatrices(I,A),y.transpose();var O=new t.Vector3(w.x,w.y,w.z),E=y.clone();y.elements[12]=O.x,y.elements[13]=O.y,y.elements[14]=O.z;var M=Math.sqrt((w.x-v.x)*(w.x-v.x)+(w.y-v.y)*(w.y-v.y)+(w.z-v.z)*(w.z-v.z));let P=Math.max(e,s),_=this.wir(h,P),b=this.gir(_,P),S=0;[S,b]=this.pir(2*Math.PI,b);var N=(e-s)/M,F=6*S,T=2*S,C=2*S;l&&(F+=3*(S-2)+2*S,S,C+=S,T+=S),c&&(F+=3*(S-2)+2*S,S,C+=S,T+=S);for(var D=6*S+(l?3*(S-2):0)+(c?3*(S-2):0),R=(l?2*S:0)+(c?2*S:0),B=new Uint16Array(F),U=B,G=0,k=0;k<S-1;++k){var j=k+1;U[G++]=k,U[G++]=j,U[G++]=S+j,U[G++]=k,U[G++]=S+j,U[G++]=S+k}j=0;if(U[G++]=S-1,U[G++]=j,U[G++]=S+j,U[G++]=S-1,U[G++]=S+j,U[G++]=S+S-1,l)for(k=0;k<S-2;k++)U[G++]=2*S,U[G++]=2*S+k+1,U[G++]=2*S+k+2;if(c)if(l)for(k=0;k<S-2;k++)U[G++]=3*S,U[G++]=3*S+k+2,U[G++]=3*S+k+1;else for(k=0;k<S-2;k++)U[G++]=2*S,U[G++]=2*S+k+2,U[G++]=2*S+k+1;if(l){for(k=0;k<S-1;++k)U[G++]=S+k,U[G++]=S+k+1;U[G++]=S+S-1,U[G++]=S}if(c){for(k=0;k<S-1;++k)U[G++]=k,U[G++]=k+1;U[G++]=S-1,U[G++]=0}var x=new Float32Array(3*T),L=new Float32Array(3*T),H=x,X=L,W=0;for(k=0;k<S;k++,W+=3){var q=k/S*2*Math.PI;H[W]=e*Math.cos(q),H[W+1]=e*Math.sin(q),H[W+2]=0,X[W]=k/S,X[W+1]=1,X[W+2]=0}W=3*S;for(k=0;k<S;k++,W+=3){q=k/S*2*Math.PI;H[W]=s*Math.cos(q),H[W+1]=s*Math.sin(q),H[W+2]=M,X[W]=k/S,X[W+1]=0,X[W+2]=0}if(l){q=0;for(var V=0;V<S;V++)q=V/S*2*Math.PI,H[W]=H[3*(S+V)],X[W++]=(Math.cos(q)+1)/2,H[W]=H[3*(S+V)+1],X[W++]=1-(Math.sin(q)+1)/2,H[W]=H[3*(S+V)+2],X[W++]=0}if(c)for(q=0,V=0;V<S;V++)q=V/S*2*Math.PI,H[W]=H[3*V],X[W++]=(Math.cos(q)+1)/2,H[W]=H[3*V+1],X[W++]=1-(Math.sin(q)+1)/2,H[W]=H[3*V+2],X[W++]=0;var z=new Float32Array(3*C);H=z;W=0;for(var Y=0;Y<2;Y++)for(k=0;k<S;k++){q=k/S*2*Math.PI;(J=new t.Vector3).x=x[3*k],J.y=x[3*k+1],J.z=x[3*k+2],J.z=Math.sqrt(J.x*J.x+J.y*J.y)*N,J.normalize(),H[W++]=J.x,H[W++]=J.y,H[W++]=J.z}if(l)for(Y=0;Y<S;Y++)H[W++]=0,H[W++]=0,H[W++]=1;if(c)for(Y=0;Y<S;Y++)H[W++]=0,H[W++]=0,H[W++]=-1;for(V=0;V<T;V++){(J=new t.Vector3).x=x[3*V],J.y=x[3*V+1],J.z=x[3*V+2],J.Fm(y),x[3*V]=J.x,x[3*V+1]=J.y,x[3*V+2]=J.z}for(V=0;V<C;V++){var J;(J=new t.Vector3).x=z[3*V],J.y=z[3*V+1],J.z=z[3*V+2],J.Fm(E),z[3*V]=J.x,z[3*V+1]=J.y,z[3*V+2]=J.z}var K,Q=new r.Mesh;Q.vertexPositionArray=x,Q.vertexNormalArray=z,Q.Air=L,Q.vertexIndexArray=B,Q.gas=o,Q.matId=u,a?(o.setConnectivity(0),(K=o.clone()).setConnectivity(3)):K=o.line?o.line:o;var Z=new r.DrawingGroup(o,u,4,0,D),$=new r.DrawingGroup(K,u,1,D,R);D=6*S+(l?3*(S-2):0)+(c?3*(S-2):0),R=(l?2*S:0)+(c?2*S:0);let tt=0,it=[n[0]-i[0],n[1]-i[1],n[2]-i[2]];if(l||c){let t=new r.SGPrimitive({cgmId:tt++,group:$,start:D,count:2*S});if($.tEi.push(t),f){let r;r=l?m(n,it,s):m(i,it,e),t.decoration=f.Brs(r)}}if(l&&c){let t=new r.SGPrimitive({cgmId:tt++,group:$,start:D+2*S,count:2*S});if($.tEi.push(t),f){let r=m(i,it,e);t.decoration=f.Brs(r)}}var rt=new r.SGPrimitive({cgmId:tt++,group:Z,start:0,count:6*S});if(Z.tEi.push(rt),f)if(s==e){let t=d(i,it,s);rt.decoration=f.Brs(t)}else{if(s>e){let t=i;i=n,n=t,t=e,e=s,s=t}let r=[i[0]-n[0],i[1]-n[1],i[2]-n[2]],o=new t.Vector3(r[0],r[1],r[2]).length(),u=o/(1-s/e);r[0]*=u/o,r[1]*=u/o,r[2]*=u/o;let h=[i[0]-r[0],i[1]-r[1],i[2]-r[2]],a=180*Math.atan(e/u)/Math.PI,l=g(h,r,a);rt.decoration=f.Brs(l)}return(l||c)&&(rt=new r.SGPrimitive({cgmId:tt++,group:Z,start:6*S,count:3*(S-2)}),Z.tEi.push(rt)),l&&c&&(rt=new r.SGPrimitive({cgmId:tt++,group:Z,start:6*S+3*(S-2),count:3*(S-2)}),Z.tEi.push(rt)),Q.drawingGroups.push(Z),Q.drawingGroups.push($),r.ses(Q),Q},r.whs=function(i,n,e,s,o,u,h,a,f,l,c,w){var d=new t.Vector3(u[0],u[1],u[2]),g=new t.Vector3(h[0],h[1],h[2]),m=d.length();i<-Math.PI/2&&(i=-Math.PI/2),i>Math.PI/2&&(i=Math.PI/2),n<-Math.PI/2&&(n=-Math.PI/2),n>Math.PI/2&&(n=Math.PI/2);var p=n-i;p<0&&(p=0),e<0&&(e=0),e>2*Math.PI&&(e=2*Math.PI),s<0&&(s=0),s>2*Math.PI&&(s=2*Math.PI);var A=s-e;A<0&&(A=0);let I=this.wir(l,m),y=this.gir(I,m),O=0,E=0,M=0,P=0;[O,M]=this.pir(A,y),[E,P]=this.pir(2*p,y),O+=1,E+=1;this.mir(A,O-1),this.mir(p,E-1);for(var _=3*(O+1)*E,b=6*O*(E-1),S=new Float32Array(_),N=new Float32Array(_),F=new Float32Array(_),T=new Uint16Array(b),C=S,D=N,R=F,B=d.normalize(),U=g.normalize(),G=(new t.Vector3).crossVectors(B,U),k=T,j=0,x=0;x<E-1;x++)for(Y=0;Y<O;Y++)k[j++]=x*(O+1)+Y,k[j++]=(x+1)*(O+1)+Y+1,k[j++]=(x+1)*(O+1)+Y,k[j++]=x*(O+1)+Y,k[j++]=x*(O+1)+Y+1,k[j++]=(x+1)*(O+1)+Y+1;j=0;var L=1/(E-1),H=(new t.Vector3,new t.Vector3),X=new t.Vector3,W=new t.Vector3;for(x=0;x<E;x++)for(var q=x*L,V=Math.sin(i+q*p),z=Math.cos(i+q*p),Y=0;Y<=O;Y++,j+=3){var J=Y/O,K=Math.sin(e+J*A),Q=Math.cos(e+J*A);H.copy(B),H.multiplyScalar(Q),X.copy(U),X.multiplyScalar(K),W.copy(G),W.multiplyScalar(V),H.add(X),H.multiplyScalar(z),H.add(W);var Z=H;D[j]=Z.x,C[j]=o[0]+Z.x*m,R[j]=J,D[j+1]=Z.y,C[j+1]=o[1]+Z.y*m,R[j+1]=x/E,D[j+2]=Z.z,C[j+2]=o[2]+Z.z*m,R[j+2]=0}var $=new r.Mesh;$.vertexPositionArray=S,$.vertexNormalArray=N,$.Air=F,$.vertexIndexArray=T,$.gas=a,$.matId=f,c&&a.setConnectivity(0);var tt=new r.DrawingGroup(a,f,4,0,b),it=new r.SGPrimitive({cgmId:0,group:tt,start:0,count:b});if(w){let t=v(o,m);it.decoration=w.Brs(t)}return tt.tEi.push(it),$.drawingGroups.push(tt),r.ses($),$},r.dhs=function(i,r,n,e,s,o){var u=[],h=(new t.Vector3).copy(r),a=(new t.Vector3).copy(n);let f=h.length();o&&(f+=o);let l=this.wir(s,f),c=this.gir(l,f),v=0;[v,c]=this.pir(e,c);for(var w=0,d=0;d<v+1;d++){var g=Math.cos(w),m=Math.sin(w);h.copy(r).multiplyScalar(g),a.copy(n).multiplyScalar(m),h.add(a).add(i),u.push(h.x),u.push(h.y),u.push(h.z),w+=c}if(r.normalize(),n.normalize(),e==2*Math.PI){u.push(u[0]),u.push(u[1]),u.push(u[2]);var p=[-n.x,-n.y,-n.z],A=[n.x,n.y,n.z]}else{p=[-n.x,-n.y,-n.z];h.crossVectors(r,n);var I=u.length;a.set(u[I-3],u[I-2],u[I-1]).sub(i).normalize(),h.cross(a).normalize();A=[h.x,h.y,h.z]}return{ehs:u,startNormal:p,endNormal:A}},r.Ahs=function(i,n,e,s,o,u,h,a,f){var l=new t.Vector3,c=new t.Vector3;l.subVectors(n[0],i);let v=l.length();c.crossVectors(l,s).normalize();let d=this.wir(h,e[0]),g=this.gir(d,e[0]),m=0;[m,g]=this.pir(2*Math.PI,g);for(var p=3*n.length*m,A=6*m*(n.length-1),I=new Float32Array(p),y=new Float32Array(p),O=new Float32Array(p),E=new Uint16Array(A),M=I,P=y,_=O,b=E,S=new t.Vector3,N=new t.Vector3,F=new t.Vector3,T=new t.Vector3,C=0,D=0;D<n.length;D++){0==D||D==n.length-1?S.copy(s).negate():(F.subVectors(n[D],n[D-1]),S.subVectors(n[D+1],n[D]),S.add(F)),S.normalize(),N.crossVectors(S,c),N.normalize();for(var R=0,B=0;B<m;B++)F.copy(N).multiplyScalar(Math.cos(R)),T.copy(c).multiplyScalar(Math.sin(R)),F.add(T),P[C]=F.x,P[C+1]=F.y,P[C+2]=F.z,F.multiplyScalar(e[D]),F.add(n[D]),M[C]=F.x,M[C+1]=F.y,M[C+2]=F.z,_[C++]=B/m,_[C++]=D/n.length,_[C++]=0,R+=g}C=0;for(D=0;D<n.length-1;D++)for(B=0;B<m;B++){var U=(B+1)%m;b[C++]=D*m+B,b[C++]=(D+1)*m+B,b[C++]=(D+1)*m+U,b[C++]=D*m+B,b[C++]=(D+1)*m+U,b[C++]=D*m+U}var G=new r.Mesh;G.vertexPositionArray=I,G.vertexNormalArray=y,G.Air=O,G.vertexIndexArray=E,G.gas=o,G.matId=u,a&&o.setConnectivity(0);var k=new r.DrawingGroup(o,u,4,0,A),j=new r.SGPrimitive({cgmId:0,group:k,start:0,count:6*m*(n.length-1)});if(k.tEi.push(j),f){let t=w(i,c,e[0],v);j.decoration=f.Brs(t)}return G.drawingGroups.push(k),r.ses(G),G},r.ohs=function(i,n,e,s,o,u,h,a,f,l,c){let v=n[0];for(let t=1;t<n.length;t++)n[t]>v&&(v=n[t]);let d=this.wir(a,v),g=this.gir(d,v),m=0;[m,g]=this.pir(2*Math.PI,g);var p=3*i.length*m,A=6*m*(i.length-1),I=0;o&&(p+=6*m,A+=6*(m-2),I=4*m);var y=new Float32Array(p),O=new Float32Array(p),E=new Float32Array(p),M=new Uint16Array(A+I),P=y,_=O,b=E,S=M,N=new t.Vector3,F=new t.Vector3,T=new t.Vector3,C=new t.Vector3,D=new t.Vector3;if(i.length>=3)C.subVectors(i[1],i[0]),T.subVectors(i[2],i[1]),N.crossVectors(C,T).normalize(),C.copy(e).negate(),T.crossVectors(C,N);else{C.copy(e).negate();var R=C.x,B=C.y,U=C.z,G=.001;R>B?B>U||R>U?T.set(0,B+G,U+G):T.set(R+G,B+G,0):R>U||B>U?T.set(R+G,0,U+G):T.set(R+G,B+G,0),T.crossVectors(C,T)}for(var k=0,j=0;j<i.length;j++){T.normalize(),0==j?F.copy(e).negate():j==i.length-1?F.copy(s):(C.subVectors(i[j],i[j-1]),F.subVectors(i[j+1],i[j]),F.add(C)),F.normalize(),N.crossVectors(T,F),N.normalize(),j>0&&T.crossVectors(F,N);for(var x=0,L=0;L<m;L++)C.copy(T).multiplyScalar(Math.cos(x)),D.copy(N).multiplyScalar(Math.sin(x)),C.add(D),_[k]=C.x,_[k+1]=C.y,_[k+2]=C.z,C.multiplyScalar(n[j]),C.add(i[j]),P[k]=C.x,P[k+1]=C.y,P[k+2]=C.z,b[k++]=L/m,b[k++]=j/i.length,b[k++]=0,x+=g}if(o){for(L=0;L<m;L++)_[k]=e.x,_[k+1]=e.y,_[k+2]=e.z,P[k++]=P[3*L],P[k++]=P[3*L+1],P[k++]=P[3*L+2];var H=m*(i.length-1)*3;for(L=0;L<m;L++)_[k]=s.x,_[k+1]=s.y,_[k+2]=s.z,P[k++]=P[H+3*L],P[k++]=P[H+3*L+1],P[k++]=P[H+3*L+2]}k=0;for(j=0;j<i.length-1;j++)for(L=0;L<m;L++){var X=(L+1)%m;S[k++]=j*m+L,S[k++]=(j+1)*m+L,S[k++]=(j+1)*m+X,S[k++]=j*m+L,S[k++]=(j+1)*m+X,S[k++]=j*m+X}if(o){for(j=0;j<m-2;j++)S[k++]=i.length*m,S[k++]=i.length*m+j+1,S[k++]=i.length*m+j+2;for(j=0;j<m-2;j++)S[k++]=(i.length+1)*m,S[k++]=(i.length+1)*m+j+2,S[k++]=(i.length+1)*m+j+1;for(j=0;j<m;j++)S[k++]=i.length*m+j,S[k++]=i.length*m+(j+1)%m;for(j=0;j<m;j++)S[k++]=(i.length+1)*m+j,S[k++]=(i.length+1)*m+(j+1)%m}var W=new r.Mesh;W.vertexPositionArray=y,W.vertexNormalArray=O,W.Air=E,W.vertexIndexArray=M,W.gas=u,W.matId=h,f&&u.setConnectivity(0);var q=new r.DrawingGroup(u,h,4,0,A);let V=0;var z=new r.SGPrimitive({cgmId:V++,group:q,start:0,count:6*m*(i.length-1)});if(q.tEi.push(z),l&&c){let i=new t.Vector3(c.center[0],c.center[1],c.center[2]),r=new t.Vector3(c.qP[0],c.qP[1],c.qP[2]),e=r.length(),s=new t.Vector3(c.JP[0],c.JP[1],c.JP[2]),o=(new t.Vector3).crossVectors(r.normalize(),s.normalize()),u=w(i,o,n[0],e);z.decoration=l.Brs(u)}if(z=new r.SGPrimitive({cgmId:V++,group:q,start:6*m*(i.length-1),count:3*(m-2)}),q.tEi.push(z),z=new r.SGPrimitive({cgmId:V++,group:q,start:6*m*(i.length-1)+3*(m-2),count:3*(m-2)}),q.tEi.push(z),W.drawingGroups.push(q),I){var Y;f?(Y=u.clone()).setConnectivity(3):Y=u.line?u.line:u;var J=new r.DrawingGroup(Y,h,1,A,I);z=new r.SGPrimitive({cgmId:V++,group:J,start:A,count:I/2}),J.tEi.push(z),z=new r.SGPrimitive({cgmId:V++,group:J,start:A+I/2,count:I/2}),J.tEi.push(z),W.drawingGroups.push(J)}return r.ses(W),W},r.hhs=function(i,n,e,s,o,u,h,a){var f=new r.Mesh;f.gas=o,f.matId=u;var l=new t.Vector3(i[0],i[1],i[2]),c=new t.Vector3(n[0],n[1],n[2]),v=new t.Vector3(e[0],e[1],e[2]),w=(new t.Vector3).crossVectors(c,v).normalize().multiplyScalar(s);f.vertexPositionArray=new Float32Array(72),f.vertexNormalArray=new Float32Array(72),f.Air=new Float32Array(72);var d=f.vertexPositionArray,g=f.vertexNormalArray,m=f.Air,p=new t.Vector3,A=new t.Vector3;A.copy(w).normalize();var I=new t.Vector3;I.copy(A).negate();var y=new t.Vector3;y.copy(v).normalize();var O=new t.Vector3;O.copy(y).negate();var E=new t.Vector3;E.copy(c).normalize();var M=new t.Vector3;M.copy(E).negate();var P=new t.Vector3(l.x,l.y,l.z),_=new t.Vector3(l.x,l.y,l.z),b=new t.Vector3(0,0,0),S=new t.Vector3(1,0,0),N=new t.Vector3(1,1,0),F=new t.Vector3(0,1,0);p.addVectors(l,w),P.min(p),_.max(p),d[9]=p.x,d[10]=p.y,d[11]=p.z,d[24]=p.x,d[25]=p.y,d[26]=p.z,d[48]=p.x,d[49]=p.y,d[50]=p.z,g[9]=A.x,g[10]=A.y,g[11]=A.z,g[24]=O.x,g[25]=O.y,g[26]=O.z,g[48]=M.x,g[49]=M.y,g[50]=M.z,m[9]=F.x,m[10]=F.y,m[11]=F.z,m[24]=b.x,m[25]=b.y,m[26]=b.z,m[48]=b.x,m[49]=b.y,m[50]=b.z,p.add(c),P.min(p),_.max(p),d[6]=p.x,d[7]=p.y,d[8]=p.z,d[27]=p.x,d[28]=p.y,d[29]=p.z,d[60]=p.x,d[61]=p.y,d[62]=p.z,g[6]=A.x,g[7]=A.y,g[8]=A.z,g[27]=O.x,g[28]=O.y,g[29]=O.z,g[60]=E.x,g[61]=E.y,g[62]=E.z,m[6]=N.x,m[7]=N.y,m[8]=N.z,m[27]=S.x,m[28]=S.y,m[29]=S.z,m[60]=b.x,m[61]=b.y,m[62]=b.z,p.add(v),P.min(p),_.max(p),d[3]=p.x,d[4]=p.y,d[5]=p.z,d[36]=p.x,d[37]=p.y,d[38]=p.z,d[63]=p.x,d[64]=p.y,d[65]=p.z,g[3]=A.x,g[4]=A.y,g[5]=A.z,g[36]=y.x,g[37]=y.y,g[38]=y.z,g[63]=E.x,g[64]=E.y,g[65]=E.z,m[3]=S.x,m[4]=S.y,m[5]=S.z,m[36]=b.x,m[37]=b.y,m[38]=b.z,m[63]=S.x,m[64]=S.y,m[65]=S.z,p.addVectors(l,w),p.add(v),P.min(p),_.max(p),d[0]=p.x,d[1]=p.y,d[2]=p.z,d[39]=p.x,d[40]=p.y,d[41]=p.z,d[57]=p.x,d[58]=p.y,d[59]=p.z,g[0]=A.x,g[1]=A.y,g[2]=A.z,g[39]=y.x,g[40]=y.y,g[41]=y.z,g[57]=M.x,g[58]=M.y,g[59]=M.z,m[0]=b.x,m[1]=b.y,m[2]=b.z,m[39]=S.x,m[40]=S.y,m[41]=S.z,m[57]=F.x,m[58]=F.y,m[59]=F.z,p.addVectors(l,v),P.min(p),_.max(p),d[21]=p.x,d[22]=p.y,d[23]=p.z,d[42]=p.x,d[43]=p.y,d[44]=p.z,d[54]=p.x,d[55]=p.y,d[56]=p.z,g[21]=I.x,g[22]=I.y,g[23]=I.z,g[42]=y.x,g[43]=y.y,g[44]=y.z,g[54]=M.x,g[55]=M.y,g[56]=M.z,m[21]=F.x,m[22]=F.y,m[23]=F.z,m[42]=N.x,m[43]=N.y,m[44]=N.z,m[54]=N.x,m[55]=N.y,m[56]=N.z,p.add(c),P.min(p),_.max(p),d[18]=p.x,d[19]=p.y,d[20]=p.z,d[45]=p.x,d[46]=p.y,d[47]=p.z,d[66]=p.x,d[67]=p.y,d[68]=p.z,g[18]=I.x,g[19]=I.y,g[20]=I.z,g[45]=y.x,g[46]=y.y,g[47]=y.z,g[66]=E.x,g[67]=E.y,g[68]=E.z,m[18]=N.x,m[19]=N.y,m[20]=N.z,m[45]=F.x,m[46]=F.y,m[47]=F.z,m[66]=N.x,m[67]=N.y,m[68]=N.z,p.addVectors(l,c),P.min(p),_.max(p),d[15]=p.x,d[16]=p.y,d[17]=p.z,d[30]=p.x,d[31]=p.y,d[32]=p.z,d[69]=p.x,d[70]=p.y,d[71]=p.z,g[15]=I.x,g[16]=I.y,g[17]=I.z,g[30]=O.x,g[31]=O.y,g[32]=O.z,g[69]=E.x,g[70]=E.y,g[71]=E.z,m[15]=S.x,m[16]=S.y,m[17]=S.z,m[30]=N.x,m[31]=N.y,m[32]=N.z,m[69]=F.x,m[70]=F.y,m[71]=F.z,d[12]=l.x,d[13]=l.y,d[14]=l.z,d[33]=l.x,d[34]=l.y,d[35]=l.z,d[51]=l.x,d[52]=l.y,d[53]=l.z,g[12]=I.x,g[13]=I.y,g[14]=I.z,g[33]=O.x,g[34]=O.y,g[35]=O.z,g[51]=M.x,g[52]=M.y,g[53]=M.z,m[12]=b.x,m[13]=b.y,m[14]=b.z,m[33]=F.x,m[34]=F.y,m[35]=F.z,m[51]=S.x,m[52]=S.y,m[53]=S.z,f.vertexIndexArray=new Uint16Array(60);for(var T=f.vertexIndexArray,C=0,D=0;D<6;D++)T[C++]=4*D,T[C++]=4*D+2,T[C++]=4*D+1,T[C++]=4*D,T[C++]=4*D+3,T[C++]=4*D+2;for(D=0;D<2;D++)T[C++]=4*D,T[C++]=4*D+1,T[C++]=4*D+1,T[C++]=4*D+2,T[C++]=4*D+2,T[C++]=4*D+3,T[C++]=4*D+3,T[C++]=4*D;T[C++]=0,T[C++]=7,T[C++]=1,T[C++]=6,T[C++]=2,T[C++]=5,T[C++]=3,T[C++]=4,h&&o.setConnectivity(0);var R,B=new r.DrawingGroup(o,u,4,0,36);h?(R=o.clone()).setConnectivity(3):R=o.line?o.line:o;var U=new r.DrawingGroup(R,u,1,36,24);let G=0;for(D=0;D<6;D++){var k=new r.SGPrimitive({cgmId:G++,cgmId:D,group:B,start:6*D,count:6});B.tEi.push(k)}for(D=0;D<12;D++){k=new r.SGPrimitive({cgmId:G++,cgmId:D,group:U,start:36+2*D,count:2});U.tEi.push(k)}f.drawingGroups.push(B),f.drawingGroups.push(U);var j=[P.x,P.y,P.z],x=[_.x,_.y,_.z];return f.AABB={min:j,max:x},f};let v=function(t,i){let r=[0,52,53];return I(r,t[0]),I(r,t[1]),I(r,t[2]),I(r,i),r[0]=r.length,r},w=function(t,i,r,n){let e=[0,52,56];return I(e,t.x),I(e,t.y),I(e,t.z),I(e,i.x),I(e,i.y),I(e,i.z),I(e,n),I(e,r),e[0]=e.length,e},d=function(t,i,r){let n=[0,52,51];return I(n,t[0]),I(n,t[1]),I(n,t[2]),I(n,i[0]),I(n,i[1]),I(n,i[2]),I(n,r),n[0]=n.length,n},g=function(t,i,r){let n=[0,52,52];return I(n,t[0]),I(n,t[1]),I(n,t[2]),I(n,i[0]),I(n,i[1]),I(n,i[2]),I(n,r),n[0]=n.length,n},m=function(t,i,r){let n=[0,52,55];return I(n,t[0]),I(n,t[1]),I(n,t[2]),I(n,i[0]),I(n,i[1]),I(n,i[2]),I(n,r),n[0]=n.length,n},p=new Uint8Array(8),A=new DataView(p.buffer,0,8),I=function(t,i){A.setFloat64(0,i),t.push(p[0]),t.push(p[1]),t.push(p[2]),t.push(p[3]),t.push(p[4]),t.push(p[5]),t.push(p[6]),t.push(p[7])},y=new Uint8Array(4);new DataView(y.buffer,0,4);return r})),define("Mesh/Mesh",["DS/Mesh/Mesh","DS/DSMigration/DSMigration"],(function(t,i){return i.mH("Mesh/Mesh"),t}));